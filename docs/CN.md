---
hide:
  - toc
---

<p align="center"><img src="../images/logo.png" alt=""></p>
<h1 align="center">What the f*ck Python! ğŸ</h1>
<p align="center">ä¸€äº›æœ‰è¶£ä¸”é²œä¸ºäººçŸ¥çš„ Python ç‰¹æ€§.</p>

ç¿»è¯‘ç‰ˆæœ¬: [English](https://github.com/satwikkansal/wtfpython) | [Vietnamese Tiáº¿ng Viá»‡t](https://github.com/vuduclyunitn/wtfptyhon-vi) | [Spanish EspaÃ±ol](https://web.archive.org/web/20220511161045/https://github.com/JoseDeFreitas/wtfpython-es) | [Korean í•œêµ­ì–´](https://github.com/buttercrab/wtfpython-ko) | [Russian Ğ ÑƒÑÑĞºĞ¸Ğ¹](https://github.com/frontdevops/wtfpython) | [German Deutsch](https://github.com/BenSt099/wtfpython) | [Add translation](https://github.com/satwikkansal/wtfpython/issues/new?title=Add%20translation%20for%20[LANGUAGE]&body=Expected%20time%20to%20finish:%20[X]%20weeks.%20I%27ll%20start%20working%20on%20it%20from%20[Y].)


å…¶ä»–æ¨¡å¼: [Interactive](https://mybinder.org/v2/gh/robertparley/wtfpython-cn/master?labpath=irrelevant%2Fwtf.ipynb) 

[![WTFPL 2.0][license-image]][license-url]   [![Commit id][commit-image]][commit-url] 


Python, æ˜¯ä¸€ä¸ªè®¾è®¡ä¼˜ç¾çš„è§£é‡Šå‹é«˜çº§è¯­è¨€, å®ƒæä¾›äº†å¾ˆå¤šèƒ½è®©ç¨‹åºå‘˜æ„Ÿåˆ°èˆ’é€‚çš„åŠŸèƒ½ç‰¹æ€§. ä½†æœ‰çš„æ—¶å€™, Python çš„ä¸€äº›è¾“å‡ºç»“æœå¯¹äºåˆå­¦è€…æ¥è¯´ä¼¼ä¹å¹¶ä¸æ˜¯é‚£ä¹ˆä¸€ç›®äº†ç„¶.

è¿™ä¸ªæœ‰è¶£çš„é¡¹ç›®æ„åœ¨æ”¶é›† Python ä¸­é‚£äº›éš¾ä»¥ç†è§£å’Œåäººç±»ç›´è§‰çš„ä¾‹å­ä»¥åŠé²œä¸ºäººçŸ¥çš„åŠŸèƒ½ç‰¹æ€§, å¹¶å°è¯•è®¨è®ºè¿™äº›ç°è±¡èƒŒåçœŸæ­£çš„åŸç†!

è™½ç„¶ä¸‹é¢çš„æœ‰äº›ä¾‹å­å¹¶ä¸ä¸€å®šä¼šè®©ä½ è§‰å¾— WTFs, ä½†å®ƒä»¬ä¾ç„¶æœ‰å¯èƒ½ä¼šå‘Šè¯‰ä½ ä¸€äº›ä½ æ‰€ä¸çŸ¥é“çš„ Python æœ‰è¶£ç‰¹æ€§.  æˆ‘è§‰å¾—è¿™æ˜¯ä¸€ç§å­¦ä¹ ç¼–ç¨‹è¯­è¨€å†…éƒ¨åŸç†çš„å¥½åŠæ³•, è€Œä¸”æˆ‘ç›¸ä¿¡ä½ ä¹Ÿä¼šä»ä¸­è·å¾—ä¹è¶£!

å¦‚æœæ‚¨æ˜¯ä¸€ä½ç»éªŒæ¯”è¾ƒä¸°å¯Œçš„ Python ç¨‹åºå‘˜, ä½ å¯ä»¥å°è¯•æŒ‘æˆ˜çœ‹æ˜¯å¦èƒ½ä¸€æ¬¡å°±æ‰¾åˆ°ä¾‹å­çš„æ­£ç¡®ç­”æ¡ˆ. ä½ å¯èƒ½å¯¹å…¶ä¸­çš„ä¸€äº›ä¾‹å­å·²ç»æ¯”è¾ƒç†Ÿæ‚‰äº†, é‚£è¿™ä¹Ÿè®¸èƒ½å”¤èµ·ä½ å½“å¹´è¸©è¿™äº›å‘æ—¶çš„ç”œèœœå›å¿† :sweat_smile:

PS: å¦‚æœä½ ä¸æ˜¯ç¬¬ä¸€æ¬¡è¯»äº†, ä½ å¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/satwikkansal/wtfpython/releases/)è·å–å˜åŠ¨å†…å®¹.

é‚£ä¹ˆ, è®©æˆ‘ä»¬å¼€å§‹å§...

# Table of Contents/ç›®å½•
<!-- TOC -->

- [Table of Contents/ç›®å½•](#table-of-contentsç›®å½•)
- [Structure of the Examples/ç¤ºä¾‹ç»“æ„](#structure-of-the-examplesç¤ºä¾‹ç»“æ„)
- [Usage/ç”¨æ³•](#usageç”¨æ³•)
- [ğŸ‘€ Examples/ç¤ºä¾‹](#-examplesç¤ºä¾‹)
    - [Section: Strain your brain!/å¤§è„‘è¿åŠ¨!](#section-strain-your-brainå¤§è„‘è¿åŠ¨)
        - [> First things first!/è¦äº‹ä¼˜å…ˆ *](#-First-things-first!/è¦äº‹ä¼˜å…ˆ-*)
        - [> Strings can be tricky sometimes/å¾®å¦™çš„å­—ç¬¦ä¸² *](#-strings-can-be-tricky-sometimeså¾®å¦™çš„å­—ç¬¦ä¸²-)
        - [> Be careful with chained operations/å°å¿ƒé“¾å¼æ“ä½œ](#-be-careful-with-chained-operationså°å¿ƒé“¾å¼æ“ä½œ)
        - [> How not to use `is` operator/ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ `is` æ“ä½œç¬¦](#-How-not-to-use-is-operator/ä¸ºä»€ä¹ˆä¸ä½¿ç”¨-is-æ“ä½œç¬¦-)
        - [> Hash brownies/æ˜¯æ—¶å€™æ¥ç‚¹è›‹ç³•äº†!](#-Hash-browniesæ˜¯æ—¶å€™æ¥ç‚¹è›‹ç³•äº†)
        - [> Deep down, we're all the same./æœ¬è´¨ä¸Š,æˆ‘ä»¬éƒ½ä¸€æ ·. *](#-deep-down-were-all-the-sameæœ¬è´¨ä¸Šæˆ‘ä»¬éƒ½ä¸€æ ·-)
        - [> Disorder within order/æœ‰åºä¸­æ½œè—ç€æ— åº *](#-disorder-within-order/æœ‰åºä¸­æ½œè—ç€æ— åº-*)
        - [> Keep trying.../ä¸åœçš„try *](#-Keep-tryingä¸åœçš„try-)
        - [> For what?/ä¸ºä»€ä¹ˆ?](#-for-whatä¸ºä»€ä¹ˆ)
        - [> Evaluation time discrepancy/æ‰§è¡Œæ—¶æœºå·®å¼‚](#-evaluation-time-discrepancyæ‰§è¡Œæ—¶æœºå·®å¼‚)
        - [> `is not ...` is not `is (not ...)` / `is not ...` ä¸æ˜¯ `is (not ...)`](#-is-not--is-not-is-not-is-not--ä¸æ˜¯-is-not-)
        - [> A tic-tac-toe where X wins in the first attempt!/ä¸€è¹´å³è‡³!](#-a-tic-tac-toe-where-x-wins-in-the-first-attemptä¸€è¹´å³è‡³)
        - [> SchrÃ¶dinger's variable/è–›å®šè°”çš„å˜é‡ *](#-SchrÃ¶dingers-variableè–›å®šè°”çš„å˜é‡-)
        - [> The chicken-egg problem/å…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹ *](#-the-chicken-egg-problem/å…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹-*)
        - [> Subclass relationships/å­ç±»å…³ç³» *](#-subclass-relationshipså­ç±»å…³ç³»-)
        - [> Methods equality and identity/æ–¹æ³•çš„ç›¸ç­‰æ€§å’Œå”¯ä¸€æ€§ *](#-Methods-equality-and-identity/æ–¹æ³•çš„ç›¸ç­‰æ€§å’Œå”¯ä¸€æ€§-)
        - [> All-true-ation/è¿”å›Trueçš„allå‡½æ•° *](#-All-true-ation/è¿”å›Trueçš„allå‡½æ•°-)
        - [> The surprising comma/æ„å¤–çš„é€—å·](#-the-surprising-commaæ„å¤–çš„é€—å·)
        - [> Strings and the backslashes/å­—ç¬¦ä¸²ä¸åæ–œæ ](#-strings-and-the-backslasheså­—ç¬¦ä¸²ä¸åæ–œæ )
        - [> not knot!/åˆ«çº ç»“!](#-not-knotåˆ«çº ç»“)
        - [> Half triple-quoted strings/ä¸‰ä¸ªå¼•å·](#-half-triple-quoted-stringsä¸‰ä¸ªå¼•å·)
        - [> What's wrong with booleans?/å¸ƒå°”ä½ å’‹äº†?](#-whats-wrong-with-booleanså¸ƒå°”ä½ å’‹äº†)
        - [> Class attributes and instance attributes/ç±»å±æ€§å’Œå®ä¾‹å±æ€§](#-class-attributes-and-instance-attributesç±»å±æ€§å’Œå®ä¾‹å±æ€§)
        - [> yielding None/ç”Ÿæˆ None](#-yielding-noneç”Ÿæˆ-none)
        - [> Yielding from... return!/ç”Ÿæˆå™¨é‡Œçš„return *](#-Yielding-from-return/ç”Ÿæˆå™¨é‡Œçš„return-)
        - [> Nan-reflexivity/Nançš„è‡ªåæ€§](#-Nan-reflexivityNançš„è‡ªåæ€§)
        - [> Mutating the immutable!/å¼ºäººæ‰€éš¾](#-mutating-the-immutableå¼ºäººæ‰€éš¾)
        - [> The disappearing variable from outer scope/æ¶ˆå¤±çš„å¤–éƒ¨å˜é‡](#-the-disappearing-variable-from-outer-scopeæ¶ˆå¤±çš„å¤–éƒ¨å˜é‡)
        - [> The mysterious key type conversion/ç¥ç§˜çš„é”®å‹è½¬æ¢ *](#-the-mysterious-key-type-conversionç¥ç§˜çš„é”®å‹è½¬æ¢-)
        - [> Let's see if you can guess this?/çœ‹çœ‹ä½ èƒ½å¦çŒœåˆ°è¿™ä¸€ç‚¹?](#-lets-see-if-you-can-guess-thisçœ‹çœ‹ä½ èƒ½å¦çŒœåˆ°è¿™ä¸€ç‚¹)
        - [> Exceeds the limit for integer string conversion/æ•´å‹è½¬å­—ç¬¦ä¸²è¶Šç•Œ](#-exceeds-the-limit-for-integer-string-conversionæ•´å‹è½¬å­—ç¬¦ä¸²è¶Šç•Œ)
    - [Section: Slippery Slopes/æ»‘å¡è°¬è¯¯](#section-slippery-slopesæ»‘å¡è°¬è¯¯)
        - [> Modifying a dictionary while iterating over it/è¿­ä»£å­—å…¸æ—¶çš„ä¿®æ”¹](#-modifying-a-dictionary-while-iterating-over-itè¿­ä»£å­—å…¸æ—¶çš„ä¿®æ”¹)
        - [> Stubborn `del` operator/åšå¼ºçš„ `del` *](#-stubborn-del-operatoråšå¼ºçš„-del-)
        - [> The out of scope variable/å¤–éƒ¨ä½œç”¨åŸŸå˜é‡](#-the-out-of-scope-variableå¤–éƒ¨ä½œç”¨åŸŸå˜é‡)
        - [> Deleting a list item while iterating/è¿­ä»£åˆ—è¡¨æ—¶åˆ é™¤å…ƒç´ ](#-deleting-a-list-item-while-iteratingè¿­ä»£åˆ—è¡¨æ—¶åˆ é™¤å…ƒç´ )
        - [> Lossy zip of iterators/ä¸¢ä¸‰è½å››çš„zip *](#->-Lossy-zip-of-iterators/ä¸¢ä¸‰è½å››çš„zip-)
        - [> Loop variables leaking out!/å¾ªç¯å˜é‡æ³„æ¼!](#-loop-variables-leaking-outå¾ªç¯å˜é‡æ³„æ¼)
        - [> Beware of default mutable arguments!/å½“å¿ƒé»˜è®¤çš„å¯å˜å‚æ•°!](#-beware-of-default-mutable-argumentså½“å¿ƒé»˜è®¤çš„å¯å˜å‚æ•°)
        - [> Catching the Exceptions/æ•è·å¼‚å¸¸](#-catching-the-exceptionsæ•è·å¼‚å¸¸)
        - [> Same operands, different story!/åŒäººä¸åŒå‘½!](#-same-operands-different-storyåŒäººä¸åŒå‘½)
        - [> Name resolution ignoring class scope/å¿½ç•¥ç±»ä½œç”¨åŸŸçš„åç§°è§£æ](#-name-resolution-ignoring-class-scopeå¿½ç•¥ç±»ä½œç”¨åŸŸçš„åç§°è§£æ)
        - [> Rounding like a banker/åƒé“¶è¡Œå®¶ä¸€æ ·èˆå…¥ *](#-rounding-like-a-banker/åƒé“¶è¡Œå®¶ä¸€æ ·èˆå…¥-)
        - [> Needles in a Haystack/å¤§æµ·æé’ˆ](#-needles-in-a-haystackå¤§æµ·æé’ˆ)
        - [> Splitsies/åˆ†å‰²å‡½æ•°](#-Splitsiesåˆ†å‰²å‡½æ•°-)
        - [> Wild imports/é€šé…ç¬¦å¯¼å…¥æ–¹å¼ *](#-Wild-importsé€šé…ç¬¦å¯¼å…¥æ–¹å¼-)
        - [> All sorted?/éƒ½æ’åºäº†å—ï¼Ÿ *](#-All-sortedéƒ½æ’åºäº†å—-)
        - [> Midnight time doesn't exist?/ä¸å­˜åœ¨çš„åˆå¤œ?](#-midnight-time-doesnt-existä¸å­˜åœ¨çš„åˆå¤œ)
    - [Section: The Hidden treasures!/éšè—çš„å®è—!](#section-the-hidden-treasureséšè—çš„å®è—)
        - [> Okay Python, Can you make me fly?/Python, å¯å¦å¸¦æˆ‘é£? *](#-okay-python-can-you-make-me-flypython-å¯å¦å¸¦æˆ‘é£-)
        - [> `goto`, but why?/`goto`, ä½†ä¸ºä»€ä¹ˆ? *](#-goto-but-whygoto-ä½†ä¸ºä»€ä¹ˆ-)
        - [> Brace yourself!/åšå¥½æ€æƒ³å‡†å¤‡ *](#-brace-yourselfåšå¥½æ€æƒ³å‡†å¤‡-)
        - [> Let's meet Friendly Language Uncle For Life/è®©ç”Ÿæ´»æ›´å‹å¥½ *](#-lets-meet-friendly-language-uncle-for-lifeè®©ç”Ÿæ´»æ›´å‹å¥½-)
        - [> Even Python understands that love is complicated/è¿Pythonä¹ŸçŸ¥é“çˆ±æ˜¯éš¾è¨€çš„ *](#-even-python-understands-that-love-is-complicatedè¿Pythonä¹ŸçŸ¥é“çˆ±æ˜¯éš¾è¨€çš„-)
        - [> Yes, it exists!/æ˜¯çš„, å®ƒå­˜åœ¨!](#-yes-it-existsæ˜¯çš„-å®ƒå­˜åœ¨)
        - [> Ellipsis/çœç•¥ *](#-Ellipsisçœç•¥-)
        - [> Inpinity/æ— é™ *](#-inpinityæ— é™-)
        - [> Let's mangle/ä¿®é¥°æ—¶é—´! *](#-Lets-mangleä¿®é¥°æ—¶é—´-)
    - [Section: Appearances are deceptive!/å¤–è¡¨æ˜¯é ä¸ä½çš„!](#section-appearances-are-deceptiveå¤–è¡¨æ˜¯é ä¸ä½çš„)
        - [> Skipping lines?/è·³è¿‡ä¸€è¡Œ?](#-skipping-linesè·³è¿‡ä¸€è¡Œ)
        - [> Teleportation/ç©ºé—´ç§»åŠ¨ *](#-teleportationç©ºé—´ç§»åŠ¨-)
        - [> Well, something is fishy.../å—¯, æœ‰äº›å¯ç–‘...](#-well-something-is-fishyå—¯æœ‰äº›å¯ç–‘)
    - [Section: Miscellaneous/æ‚é¡¹](#section-miscellaneousæ‚é¡¹)
        - [> `+=` is faster/æ›´å¿«çš„ `+=` ](#--is-fasteræ›´å¿«çš„-)
        - [> Let's make a giant string!/æ¥åšä¸ªå·¨å¤§çš„å­—ç¬¦ä¸²å§!](#-lets-make-a-giant-stringæ¥åšä¸ªå·¨å¤§çš„å­—ç¬¦ä¸²å§)
        - [> Slowing down `dict` lookups/è®©å­—å…¸çš„æŸ¥æ‰¾æ…¢ä¸‹æ¥ *](#-Slowing-down-dict-lookupsè®©å­—å…¸çš„æŸ¥æ‰¾æ…¢ä¸‹æ¥-)
        - [> Bloating instance `dict`s/å˜è‡ƒè‚¿çš„`dict`å®ä¾‹ä»¬ *](#-Bloating-instance-dicts/å˜è‡ƒè‚¿çš„dictå®ä¾‹ä»¬-)
        - [> Minor Ones/å°çŸ¥è¯†ç‚¹](#-minor-oneså°çŸ¥è¯†ç‚¹)
- [Contributing/è´¡çŒ®](#contributingè´¡çŒ®)
- [Acknowledgements/è‡´è°¢](#acknowledgementsè‡´è°¢)
- [ğŸ“ License/è®¸å¯](#-licenseè®¸å¯)
    - [Help/å¸®åŠ©](#helpå¸®åŠ©)
    - [Surprise your geeky pythonist friends?/æƒ³ç»™ä½ çš„æå®¢æœ‹å‹ä¸€ä¸ªæƒŠå–œ?](#surprise-your-geeky-pythonist-friendsæƒ³ç»™ä½ çš„æå®¢æœ‹å‹ä¸€ä¸ªæƒŠå–œ)
    - [Need a pdf version?/éœ€è¦æ¥ä¸€ä»½pdfç‰ˆçš„?](#need-a-pdf-versionéœ€è¦æ¥ä¸€ä»½pdfç‰ˆçš„)
    - [Follow Commit/è¿½è¸ªCommit](#follow-commitè¿½è¸ªCommit)
    - [996.icu](#996icu)

<!-- /TOC -->

# Structure of the Examples/ç¤ºä¾‹ç»“æ„

æ‰€æœ‰ç¤ºä¾‹çš„ç»“æ„éƒ½å¦‚ä¸‹æ‰€ç¤º:

> ### > ä¸€ä¸ªç²¾é€‰çš„æ ‡é¢˜ *
> æ ‡é¢˜æœ«å°¾çš„æ˜Ÿå·è¡¨ç¤ºè¯¥ç¤ºä¾‹åœ¨ç¬¬ä¸€ç‰ˆä¸­ä¸å­˜åœ¨ï¼Œæ˜¯æœ€è¿‘æ·»åŠ çš„.
>
> ```py
> # å‡†å¤‡ä»£ç .
> # é‡Šæ”¾é­”æ³•...
> ```
>
> **Output (Python version):**
> ```py
> >>> è§¦å‘è¯­å¥
> å‡ºä¹æ„æ–™çš„è¾“å‡ºç»“æœ
> ```
> (å¯é€‰): å¯¹æ„å¤–è¾“å‡ºç»“æœçš„ç®€çŸ­æè¿°.
>
>
> #### ğŸ’¡ è¯´æ˜:
>
> * ç®€è¦è¯´æ˜å‘ç”Ÿäº†ä»€ä¹ˆä»¥åŠä¸ºä»€ä¹ˆä¼šå‘ç”Ÿ.
>   ```py
>   å¦‚æœ‰å¿…è¦, ä¸¾ä¾‹è¯´æ˜
>   ```
>   **Output:**
>   ```py
>   >>> è§¦å‘è¯­å¥ # ä¸€äº›è®©é­”æ³•å˜å¾—å®¹æ˜“ç†è§£çš„ä¾‹å­
>   # ä¸€äº›æ­£å¸¸çš„è¾“å…¥
>   ```

**æ³¨æ„:** æ‰€æœ‰çš„ç¤ºä¾‹éƒ½åœ¨ Python 3.5.2 ç‰ˆæœ¬çš„äº¤äº’è§£é‡Šå™¨ä¸Šæµ‹è¯•è¿‡, å¦‚æœä¸ç‰¹åˆ«è¯´æ˜åº”è¯¥é€‚ç”¨äºæ‰€æœ‰ Python ç‰ˆæœ¬.

# Usage/ç”¨æ³•

æˆ‘ä¸ªäººå»ºè®®, æœ€å¥½ä¾æ¬¡é˜…è¯»ä¸‹é¢çš„ç¤ºä¾‹, å¹¶å¯¹æ¯ä¸ªç¤ºä¾‹:
- ä»”ç»†é˜…è¯»è®¾ç½®ä¾‹å­æœ€å¼€å§‹çš„ä»£ç .  å¦‚æœæ‚¨æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„ Python ç¨‹åºå‘˜, é‚£ä¹ˆå¤§å¤šæ•°æ—¶å€™æ‚¨éƒ½èƒ½æˆåŠŸé¢„æœŸåˆ°åé¢çš„ç»“æœ.
- é˜…è¯»è¾“å‡ºç»“æœ,
  + ç¡®è®¤ç»“æœæ˜¯å¦å¦‚ä½ æ‰€æ–™.
  + ç¡®è®¤ä½ æ˜¯å¦çŸ¥é“è¿™èƒŒåçš„åŸç†.
    - å¦‚æœä¸çŸ¥é“, æ·±å‘¼å¸ç„¶åé˜…è¯»è¯´æ˜ (å¦‚æœä½ è¿˜æ˜¯çœ‹ä¸æ˜ç™½, åˆ«æ²‰é»˜! å¯ä»¥åœ¨[è¿™](https://github.com/satwikkansal/wtfPython)æä¸ª issue).
    - å¦‚æœçŸ¥é“, ç»™è‡ªå·±ç‚¹å¥–åŠ±, ç„¶åå»çœ‹ä¸‹ä¸€ä¸ªä¾‹å­.

PS: ä½ ä¹Ÿå¯ä»¥åœ¨å‘½ä»¤è¡Œé˜…è¯» WTFpython. æˆ‘ä»¬æœ‰ pypi åŒ… å’Œ npm åŒ…(æ”¯æŒä»£ç é«˜äº®).(è¯‘: è¿™ä¸¤ä¸ªéƒ½æ˜¯è‹±æ–‡ç‰ˆçš„)

å®‰è£… npm åŒ… [`wtfpython`](https://www.npmjs.com/package/wtfpython)
```sh
$ npm install -g wtfpython
```

æˆ–è€…, å®‰è£… pypi åŒ… [`wtfpython`](https://pypi.python.org/pypi/wtfpython)
```sh
$ pip install wtfpython -U
```

ç°åœ¨, åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ `wtfpython`, ä½ å°±å¯ä»¥å¼€å§‹æµè§ˆäº†.

---

# ğŸ‘€ Examples/ç¤ºä¾‹


## Section: Strain your brain!/å¤§è„‘è¿åŠ¨!

### > First things first!/è¦äº‹ä¼˜å…ˆ *

<!-- Example ID: d3d73936-3cf1-4632-b5ab-817981338863 -->
<!-- read-only -->

ä¼—æ‰€å‘¨çŸ¥ï¼ŒPython 3.8 æ¨å‡º"æµ·è±¡"è¿ç®—ç¬¦ (`:=`) æ–¹ä¾¿æ˜“ç”¨ï¼Œè®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹ã€‚

1\.

```py
# Python ç‰ˆæœ¬ 3.8+

>>> a = "wtf_walrus"
>>> a
'wtf_walrus'

>>> a := "wtf_walrus"
File "<stdin>", line 1
    a := "wtf_walrus"
      ^
SyntaxError: invalid syntax

>>> (a := "wtf_walrus") # è¯¥è¯­å¥æœ‰æ•ˆ
'wtf_walrus'
>>> a
'wtf_walrus'
```

2 \.

```py
# Python ç‰ˆæœ¬ 3.8+

>>> a = 6, 9
>>> a
(6, 9)

>>> (a := 6, 9)
(6, 9)
>>> a
6

>>> a, b = 6, 9 # å…¸å‹æ‹†åŒ…æ“ä½œ
>>> a, b
(6, 9)
>>> (a, b = 16, 19) # å‡ºé”™å•¦
  File "<stdin>", line 1
    (a, b = 16, 19)
          ^
SyntaxError: invalid syntax

>>> (a, b := 16, 19) # è¿™é‡Œçš„ç»“æœæ˜¯ä¸€ä¸ªå¥‡æ€ªçš„ä¸‰å…ƒç»„
(6, 16, 19)

>>> a # aå€¼ä»ç„¶æ²¡å˜?
6

>>> b
16
```



#### ğŸ’¡ è¯´æ˜

**â€œæµ·è±¡â€è¿ç®—ç¬¦ç®€ä»‹**

æµ·è±¡è¿ç®—ç¬¦ (`:=`) åœ¨Python 3.8ä¸­è¢«å¼•å…¥ï¼Œç”¨æ¥åœ¨è¡¨è¾¾å¼ä¸­ä¸ºå˜é‡èµ‹å€¼ã€‚

```py
def some_func():
        # å‡è®¾è¿™å„¿æœ‰ä¸€äº›è€—æ—¶çš„è®¡ç®—
        # time.sleep(1000)
        return 5

# å¼•å…¥â€œæµ·è±¡â€è¿ç®—ç¬¦å‰çš„ä¾‹å­
if some_func():
        print(some_func()) # ç³Ÿç³•çš„æ¡ˆä¾‹â€”â€”å‡½æ•°è¿ç®—äº†ä¸¤æ¬¡

# æˆ–è€…ï¼ŒåŠ ä»¥æ”¹è¿›ï¼š
a = some_func()
if a:
    print(a)

# æœ‰äº†â€œæµ·è±¡â€è¿ç®—ç¬¦ï¼Œä½ å¯ä»¥å†™çš„æ›´ç®€æ´ï¼š
if a := some_func():
        print(a)
```

**è¾“å‡º (> Python 3.8):**

```py
5
5
5
```
è¿™æ ·æ—¢å‡å°‘äº†ä¸€è¡Œä»£ç ï¼Œåˆé¿å…äº†ä¸¤æ¬¡è°ƒç”¨ `some_func` å‡½æ•°ã€‚

- åœ¨é¡¶å±‚çš„æ— æ‹¬å·èµ‹å€¼æ“ä½œï¼ˆä½¿ç”¨â€œæµ·è±¡â€è¿ç®—ç¬¦ï¼‰è¢«é™åˆ¶ï¼Œå› æ­¤ä¾‹1ä¸­çš„ `a := "wtf_walrus"` å‡ºç°äº† `SyntaxError` ã€‚ç”¨æ‹¬å·æ‹¬èµ·æ¥ã€‚å®ƒå°±èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚

- ä¸€èˆ¬çš„ï¼ŒåŒ…å« `=` æ“ä½œçš„è¡¨è¾¾å¼æ˜¯ä¸èƒ½ç”¨æ‹¬å·æ‹¬èµ·æ¥çš„ï¼Œå› æ­¤ `(a, b = 6, 9)` ä¸­å‡ºç°äº†è¯­æ³•é”™è¯¯ã€‚

- â€œæµ·è±¡â€è¿ç®—ç¬¦çš„è¯­æ³•å½¢å¼ä¸ºï¼š`NAME:= expr`ï¼Œ`NAME` æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ ‡è¯†ç¬¦ï¼Œè€Œ `expr` æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„è¡¨è¾¾å¼ã€‚ å› æ­¤ï¼Œè¿™æ„å‘³ç€å®ƒä¸æ”¯æŒå¯è¿­ä»£çš„æ‰“åŒ…å’Œæ‹†åŒ…ã€‚

  - `(a := 6, 9)` ç­‰ä»·äº `((a := 6), 9)` ï¼Œæœ€ç»ˆå¾—åˆ° `(a, 9) ` (å…¶ä¸­ `a` çš„å€¼ä¸º6)

    ```py
    >>> (a := 6, 9) == ((a := 6), 9)
    True
    >>> x = (a := 696, 9)
    >>> x
    (696, 9)
    >>> x[0] is a # ä¸¤ä¸ªå˜é‡æŒ‡å‘åŒä¸€å†…å­˜ç©ºé—´
    True
    ```

  - ç±»ä¼¼çš„ï¼Œ `(a, b := 16, 19)` ç­‰ä»·äº `(a, (b := 16), 19)` ï¼Œåªæ˜¯ä¸€ä¸ªä¸‰å…ƒç»„ã€‚ 


---

### > Strings can be tricky sometimes/å¾®å¦™çš„å­—ç¬¦ä¸² *

1\.
```py
>>> a = "some_string"
>>> id(a)
140420665652016
>>> id("some" + "_" + "string") # æ³¨æ„ä¸¤ä¸ªçš„idå€¼æ˜¯ç›¸åŒçš„.
140420665652016
```

2\.
```py
>>> a = "wtf"
>>> b = "wtf"
>>> a is b
True

>>> a = "wtf!"
>>> b = "wtf!"
>>> a is b
False

>>> a, b = "wtf!", "wtf!"
>>> a is b 
True # 3.7 ç‰ˆæœ¬è¿”å›ç»“æœä¸º False.
```

3\.
```py
>>> 'a' * 20 is 'aaaaaaaaaaaaaaaaaaaa'
True
>>> 'a' * 21 is 'aaaaaaaaaaaaaaaaaaaaa'
False # 3.7 ç‰ˆæœ¬è¿”å›ç»“æœä¸º True
```

å¾ˆå¥½ç†è§£, å¯¹å§?

#### ğŸ’¡ è¯´æ˜:
- è¿™äº›è¡Œä¸ºæ˜¯ç”±äº Cpython åœ¨ç¼–è¯‘ä¼˜åŒ–æ—¶, æŸäº›æƒ…å†µä¸‹ä¼šå°è¯•ä½¿ç”¨å·²ç»å­˜åœ¨çš„ä¸å¯å˜å¯¹è±¡è€Œä¸æ˜¯æ¯æ¬¡éƒ½åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡. (è¿™ç§è¡Œä¸ºè¢«ç§°ä½œå­—ç¬¦ä¸²çš„é©»ç•™[string interning])
- å‘ç”Ÿé©»ç•™ä¹‹å, è®¸å¤šå˜é‡å¯èƒ½æŒ‡å‘å†…å­˜ä¸­çš„ç›¸åŒå­—ç¬¦ä¸²å¯¹è±¡. (ä»è€ŒèŠ‚çœå†…å­˜)
- åœ¨ä¸Šé¢çš„ä»£ç ä¸­, å­—ç¬¦ä¸²æ˜¯éšå¼é©»ç•™çš„. ä½•æ—¶å‘ç”Ÿéšå¼é©»ç•™åˆ™å–å†³äºå…·ä½“çš„å®ç°. è¿™é‡Œæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥ç”¨æ¥çŒœæµ‹å­—ç¬¦ä¸²æ˜¯å¦ä¼šè¢«é©»ç•™:
  - æ‰€æœ‰é•¿åº¦ä¸º 0 å’Œé•¿åº¦ä¸º 1 çš„å­—ç¬¦ä¸²éƒ½è¢«é©»ç•™.
  - å­—ç¬¦ä¸²åœ¨ç¼–è¯‘æ—¶è¢«å®ç° (`'wtf'` å°†è¢«é©»ç•™, ä½†æ˜¯ `''.join(['w', 't', 'f'])` å°†ä¸ä¼šè¢«é©»ç•™)
  - å­—ç¬¦ä¸²ä¸­åªåŒ…å«å­—æ¯ï¼Œæ•°å­—æˆ–ä¸‹åˆ’çº¿æ—¶å°†ä¼šé©»ç•™. æ‰€ä»¥ `'wtf!'` ç”±äºåŒ…å« `!` è€Œæœªè¢«é©»ç•™. å¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/python/cpython/blob/3.6/Objects/codeobject.c#L19)æ‰¾åˆ° CPython å¯¹æ­¤è§„åˆ™çš„å®ç°.

    <img src="../images/string-intern/string_intern.png" alt="">

- å½“åœ¨åŒä¸€è¡Œå°† `a` å’Œ `b` çš„å€¼è®¾ç½®ä¸º `"wtf!"` çš„æ—¶å€™, Python è§£é‡Šå™¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡, ç„¶ååŒæ—¶å¼•ç”¨ç¬¬äºŒä¸ªå˜é‡(è¯‘: ä»…é€‚ç”¨äº3.7ä»¥ä¸‹, è¯¦ç»†æƒ…å†µè¯·çœ‹[è¿™é‡Œ](https://github.com/leisurelicht/wtfpython-cn/issues/13)). å¦‚æœä½ åœ¨ä¸åŒçš„è¡Œä¸Šè¿›è¡Œèµ‹å€¼æ“ä½œ, å®ƒå°±ä¸ä¼šâ€œçŸ¥é“â€å·²ç»æœ‰ä¸€ä¸ª `wtfï¼` å¯¹è±¡ (å› ä¸º `"wtf!"` ä¸æ˜¯æŒ‰ç…§ä¸Šé¢æåˆ°çš„æ–¹å¼è¢«éšå¼é©»ç•™çš„). å®ƒæ˜¯ä¸€ç§ç¼–è¯‘å™¨ä¼˜åŒ–, ç‰¹åˆ«é€‚ç”¨äºäº¤äº’å¼ç¯å¢ƒ.
- å¸¸é‡æŠ˜å (constant folding) æ˜¯ Python ä¸­çš„ä¸€ç§ [çª¥å­”ä¼˜åŒ–(peephole optimization)](https://en.wikipedia.org/wiki/Peephole_optimization) æŠ€æœ¯. è¿™æ„å‘³ç€åœ¨ç¼–è¯‘æ—¶è¡¨è¾¾å¼ `'a'*20` ä¼šè¢«æ›¿æ¢ä¸º `'aaaaaaaaaaaaaaaaaaaa'` ä»¥å‡å°‘è¿è¡Œæ—¶çš„æ—¶é’Ÿå‘¨æœŸ. åªæœ‰é•¿åº¦å°äº 20 çš„å­—ç¬¦ä¸²æ‰ä¼šå‘ç”Ÿå¸¸é‡æŠ˜å . (ä¸ºå•¥? æƒ³è±¡ä¸€ä¸‹ç”±äºè¡¨è¾¾å¼ `'a'*10**10` è€Œç”Ÿæˆçš„ `.pyc` æ–‡ä»¶çš„å¤§å°). ç›¸å…³çš„æºç å®ç°åœ¨[è¿™é‡Œ](https://github.com/python/cpython/blob/3.6/Python/peephole.c#L288).
- å¦‚æœä½ æ˜¯ä½¿ç”¨ 3.7 ç‰ˆæœ¬ä¸­è¿è¡Œä¸Šè¿°ç¤ºä¾‹ä»£ç , ä¼šå‘ç°éƒ¨åˆ†ä»£ç çš„è¿è¡Œç»“æœä¸æ³¨é‡Šè¯´æ˜ç›¸åŒ. è¿™æ˜¯å› ä¸ºåœ¨ 3.7 ç‰ˆæœ¬ä¸­, å¸¸é‡æŠ˜å å·²ç»ä»çª¥å­”ä¼˜åŒ–å™¨è¿ç§»è‡³æ–°çš„ AST ä¼˜åŒ–å™¨, åè€…å¯ä»¥ä»¥æ›´é«˜çš„ä¸€è‡´æ€§æ¥æ‰§è¡Œä¼˜åŒ–. (ç”± Eugene Toder å’Œ INADA Naoki åœ¨ [bpo-29469](https://bugs.python.org/issue29469) å’Œ [bpo-11549](https://bugs.python.org/issue11549) ä¸­è´¡çŒ®.) 
- (è¯‘: ä½†æ˜¯åœ¨æœ€æ–°çš„ 3.8 ç‰ˆæœ¬ä¸­, ç»“æœåˆå˜å›å»äº†. è™½ç„¶ 3.8 ç‰ˆæœ¬å’Œ 3.7 ç‰ˆæœ¬ä¸€æ ·, éƒ½æ˜¯ä½¿ç”¨ AST ä¼˜åŒ–å™¨. ç›®å‰ä¸ç¡®å®šå®˜æ–¹å¯¹ 3.8 ç‰ˆæœ¬çš„ AST åšäº†ä»€ä¹ˆè°ƒæ•´.)


---

### > Be careful with chained operations/å°å¿ƒé“¾å¼æ“ä½œ

```py
>>> (False == False) in [False] # å¯ä»¥ç†è§£
False
>>> False == (False in [False]) # å¯ä»¥ç†è§£
False
>>> False == False in [False] # ä¸ºæ¯›?
True

>>> True is False == False
False
>>> False is False is False
True

>>> 1 > 0 < 1
True
>>> (1 > 0) < 1
False
>>> 1 > (0 < 1)
False
```

#### ğŸ’¡ è¯´æ˜:

æ ¹æ® https://docs.python.org/3/reference/expressions.html#comparisons

> å½¢å¼ä¸Š, å¦‚æœ a, b, c, ..., y, z æ˜¯è¡¨è¾¾å¼, è€Œ op1, op2, ..., opN æ˜¯æ¯”è¾ƒè¿ç®—ç¬¦, é‚£ä¹ˆé™¤äº†æ¯ä¸ªè¡¨è¾¾å¼æœ€å¤šåªå‡ºç°ä¸€æ¬¡ä»¥å¤– a op1 b op2 c ... y opN z å°±ç­‰äº a op1 b and b op2 c and ... y opN z.

è™½ç„¶ä¸Šé¢çš„ä¾‹å­ä¼¼ä¹å¾ˆæ„šè ¢, ä½†æ˜¯åƒ `a == b == c` æˆ– `0 <= x <= 100` å°±å¾ˆæ£’äº†.

* `False is False is False` ç›¸å½“äº `(False is False) and (False is False)`
* `True is False == False` ç›¸å½“äº `(True is False) and (False == False)`, ç”±äºè¯­å¥çš„ç¬¬ä¸€éƒ¨åˆ† (`True is False`) ç­‰äº `False`, å› æ­¤æ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœä¸º `False`.
* `1 > 0 < 1` ç›¸å½“äº `(1 > 0) and (0 < 1)`, æ‰€ä»¥æœ€ç»ˆç»“æœä¸º `True`.
* è¡¨è¾¾å¼ `(1 > 0) < 1` ç›¸å½“äº `True < 1` ä¸”
  ```py
  >>> int(True)
  1
  >>> True + 1 # ä¸è¿™ä¸ªä¾‹å­æ— å…³ï¼Œåªæ˜¯å¨±ä¹ä¸€ä¸‹
  2
  ```
  æ‰€ä»¥, `1 < 1` ç­‰äº `False`


---

### > How not to use `is` operator/ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ `is` æ“ä½œç¬¦
<!-- Example ID: 230fa2ac-ab36-4ad1-b675-5f5a1c1a6217 --->

ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨äº’è”ç½‘ä¸Šéå¸¸æœ‰åçš„ä¾‹å­.

1\.

```py
>>> a = 256
>>> b = 256
>>> a is b
True

>>> a = 257
>>> b = 257
>>> a is b
False
```

2\.

```py
>>> a = []
>>> b = []
>>> a is b
False

>>> a = tuple()
>>> b = tuple()
>>> a is b
True
```

3\.
**Output**

```py
>>> a, b = 257, 257
>>> a is b
True
```

**Output (Python 3.7.x specifically)**

```py
>>> a, b = 257, 257
>>> a is b
False
```

#### ğŸ’¡ è¯´æ˜:

**`is` å’Œ `==` çš„åŒºåˆ«**

* `is` è¿ç®—ç¬¦æ£€æŸ¥ä¸¤ä¸ªè¿ç®—å¯¹è±¡æ˜¯å¦å¼•ç”¨è‡ªåŒä¸€å¯¹è±¡ (å³, å®ƒæ£€æŸ¥ä¸¤ä¸ªè¿ç®—å¯¹è±¡æ˜¯å¦ç›¸åŒ).
* `==` è¿ç®—ç¬¦æ¯”è¾ƒä¸¤ä¸ªè¿ç®—å¯¹è±¡çš„å€¼æ˜¯å¦ç›¸ç­‰.
* å› æ­¤ `is` ä»£è¡¨å¼•ç”¨ç›¸åŒ, `==` ä»£è¡¨å€¼ç›¸ç­‰. ä¸‹é¢çš„ä¾‹å­å¯ä»¥å¾ˆå¥½çš„è¯´æ˜è¿™ç‚¹,
  ```py
  >>> [] == []
  True
  >>> [] is [] # è¿™ä¸¤ä¸ªç©ºåˆ—è¡¨ä½äºä¸åŒçš„å†…å­˜åœ°å€.
  False
  ```

**`256` æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡, è€Œ `257` ä¸æ˜¯**

å½“ä½ å¯åŠ¨Python çš„æ—¶å€™, æ•°å€¼ä¸º `-5` åˆ° `256` çš„å¯¹è±¡å°±å·²ç»è¢«åˆ†é…å¥½äº†. è¿™äº›æ•°å­—å› ä¸ºç»å¸¸è¢«ä½¿ç”¨, æ‰€ä»¥ä¼šè¢«æå‰å‡†å¤‡å¥½.

Python é€šè¿‡è¿™ç§åˆ›å»ºå°æ•´æ•°æ± çš„æ–¹å¼æ¥é¿å…å°æ•´æ•°é¢‘ç¹çš„ç”³è¯·å’Œé”€æ¯å†…å­˜ç©ºé—´.

å¼•ç”¨è‡ª https://docs.python.org/3/c-api/long.html
> å½“å‰çš„å®ç°ä¸º-5åˆ°256ä¹‹é—´çš„æ‰€æœ‰æ•´æ•°ä¿ç•™ä¸€ä¸ªæ•´æ•°å¯¹è±¡æ•°ç»„, å½“ä½ åˆ›å»ºäº†ä¸€ä¸ªè¯¥èŒƒå›´å†…çš„æ•´æ•°æ—¶, ä½ åªéœ€è¦è¿”å›ç°æœ‰å¯¹è±¡çš„å¼•ç”¨. æ‰€ä»¥æ”¹å˜1çš„å€¼æ˜¯æœ‰å¯èƒ½çš„. æˆ‘æ€€ç–‘è¿™ç§è¡Œä¸ºåœ¨Pythonä¸­æ˜¯æœªå®šä¹‰è¡Œä¸º. :-)

```py
>>> id(256)
10922528
>>> a = 256
>>> b = 256
>>> id(a)
10922528
>>> id(b)
10922528
>>> id(257)
140084850247312
>>> x = 257
>>> y = 257
>>> id(x)
140084850247440
>>> id(y)
140084850247344
```

è¿™é‡Œè§£é‡Šå™¨å¹¶æ²¡æœ‰æ™ºèƒ½åˆ°èƒ½åœ¨æ‰§è¡Œ `y = 257` æ—¶æ„è¯†åˆ°æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ•´æ•° `257`, æ‰€ä»¥å®ƒåœ¨å†…å­˜ä¸­åˆæ–°å»ºäº†å¦ä¸€ä¸ªå¯¹è±¡.

ç±»ä¼¼çš„ä¼˜åŒ–ä¹Ÿé€‚ç”¨äºå…¶ä»–**ä¸å¯å˜**å¯¹è±¡ï¼Œä¾‹å¦‚ç©ºå…ƒç»„ã€‚ç”±äºåˆ—è¡¨æ˜¯å¯å˜çš„ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ `[] is []` å°†è¿”å› `False` è€Œ `() is ()` å°†è¿”å› `True`ã€‚ è¿™è§£é‡Šäº†æˆ‘ä»¬çš„ç¬¬äºŒä¸ªä»£ç æ®µã€‚è€Œç¬¬ä¸‰ä¸ªå‘¢ï¼š

**å½“ `a` å’Œ `b` åœ¨åŒä¸€è¡Œä¸­ä½¿ç”¨ç›¸åŒçš„å€¼åˆå§‹åŒ–æ—¶ï¼Œä¼šæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡.**

```py
>>> a, b = 257, 257
>>> id(a)
140640774013296
>>> id(b)
140640774013296
>>> a = 257
>>> b = 257
>>> id(a)
140640774013392
>>> id(b)
140640774013488
```

* å½“ a å’Œ b åœ¨åŒä¸€è¡Œä¸­è¢«è®¾ç½®ä¸º `257` æ—¶, Python è§£é‡Šå™¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡, ç„¶ååŒæ—¶å¼•ç”¨ç¬¬äºŒä¸ªå˜é‡. å¦‚æœä½ åœ¨ä¸åŒçš„è¡Œä¸Šè¿›è¡Œ, å®ƒå°±ä¸ä¼š "çŸ¥é“" å·²ç»å­˜åœ¨ä¸€ä¸ª `257` å¯¹è±¡äº†.
* è¿™æ˜¯ä¸€ç§ç‰¹åˆ«ä¸ºäº¤äº’å¼ç¯å¢ƒåšçš„ç¼–è¯‘å™¨ä¼˜åŒ–. å½“ä½ åœ¨å®æ—¶è§£é‡Šå™¨ä¸­è¾“å…¥ä¸¤è¡Œçš„æ—¶å€™, ä»–ä»¬ä¼šå•ç‹¬ç¼–è¯‘, å› æ­¤ä¹Ÿä¼šå•ç‹¬è¿›è¡Œä¼˜åŒ–. å¦‚æœä½ åœ¨ `.py` æ–‡ä»¶ä¸­å°è¯•è¿™ä¸ªä¾‹å­, åˆ™ä¸ä¼šçœ‹åˆ°ç›¸åŒçš„è¡Œä¸º, å› ä¸ºæ–‡ä»¶æ˜¯ä¸€æ¬¡æ€§ç¼–è¯‘çš„ã€‚è¿™ç§ä¼˜åŒ–ä¸ä»…é™äºæ•´æ•°ï¼Œå®ƒä¹Ÿé€‚ç”¨äºå…¶ä»–ä¸å¯å˜æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ï¼ˆæŸ¥çœ‹ç¤ºä¾‹â€œå¾®å¦™çš„å­—ç¬¦ä¸²â€ï¼‰å’Œæµ®ç‚¹æ•°ï¼Œ

  ```py
  >>> a, b = 257.0, 257.0
  >>> a is b
  True
  ```

* ä¸ºä»€ä¹ˆè¿™ä¸é€‚ç”¨äº Python 3.7ï¼Ÿ å¤§æ¦‚æ˜¯å› ä¸ºæ­¤ç±»ç¼–è¯‘å™¨ä¼˜åŒ–æ˜¯ç‰¹å®šäºå®ç°çš„ï¼ˆå³å¯èƒ½éšç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿç­‰è€Œå˜åŒ–ï¼‰ã€‚æˆ‘ä»åœ¨è¯•å›¾å¼„æ¸…æ¥šå¯¼è‡´é—®é¢˜çš„å…·ä½“å®ç°æ›´æ”¹ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹æ­¤ [é—®é¢˜](https://github.com/satwikkansal/wtfpython/issues/100) ä»¥è·å–æ›´æ–°ã€‚


---

### > Hash brownies/æ˜¯æ—¶å€™æ¥ç‚¹è›‹ç³•äº†!
* hash brownieæŒ‡ä¸€ç§å«æœ‰å¤§éº»æˆåˆ†çš„è›‹ç³•, æ‰€ä»¥è¿™é‡Œæ˜¯å¥åŒå…³
* è¿™é‡Œä¿ç•™åŸä½œè€…å¯¹äºæ ‡é¢˜çš„ç¿»è¯‘
<!-- Example ID: eb17db53-49fd-4b61-85d6-345c5ca213ff --->


1\.
```py
some_dict = {}
some_dict[5.5] = "JavaScript"
some_dict[5.0] = "Ruby"
some_dict[5] = "Python"
```

**Output:**

```py
>>> some_dict[5.5]
"JavaScript"
>>> some_dict[5.0] # "Python" æ¶ˆé™¤äº† "Ruby" çš„å­˜åœ¨?
"Python"
>>> some_dict[5] 
"Python"

>>> complex_five = 5 + 0j
>>> type(complex_five)
complex
>>> some_dict[complex_five]
"Python"
```

ä¸ºä»€ä¹ˆåˆ°å¤„éƒ½æ˜¯Python?


#### ğŸ’¡ è¯´æ˜


* è¿™ä¸ª StackOverflowçš„ [å›ç­”](https://stackoverflow.com/a/32211042/4354153) æ¼‚äº®åœ°è§£é‡Šäº†è¿™èƒŒåçš„åŸºæœ¬åŸç†.

* Python å­—å…¸ä¸­é”®çš„å”¯ä¸€æ€§æ˜¯æ ¹æ® *ç­‰ä»·æ€§*ï¼Œè€Œä¸æ˜¯åŒä¸€æ€§ã€‚ å› æ­¤ï¼Œå³ä½¿ `5`ã€`5.0` å’Œ `5 + 0j` æ˜¯ä¸åŒç±»å‹çš„ä¸åŒå¯¹è±¡ï¼Œç”±äºå®ƒä»¬æ˜¯ç›¸ç­‰çš„ï¼Œå®ƒä»¬ä¸èƒ½éƒ½åœ¨åŒä¸€ä¸ª `dict`ï¼ˆæˆ– `set`ï¼‰ä¸­ã€‚ åªè¦æ‚¨æ’å…¥å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œå°è¯•æŸ¥æ‰¾ä»»ä½•ä¸åŒä½†ç­‰ä»·çš„é”®éƒ½å°†ä½¿ç”¨åŸå§‹æ˜ å°„å€¼æˆåŠŸï¼ˆè€Œä¸æ˜¯å› â€œKeyErrorâ€è€Œå¤±è´¥ï¼‰ï¼š

  ```py
  >>> 5 == 5.0 == 5 + 0j
  True
  >>> 5 is not 5.0 is not 5 + 0j
  True
  >>> some_dict = {}
  >>> some_dict[5.0] = "Ruby"
  >>> 5.0 in some_dict
  True
  >>> (5 in some_dict) and (5 + 0j in some_dict)
  True
  ```

* è¿™åœ¨èµ‹å€¼çš„æ—¶å€™ä¹Ÿä¼šç”Ÿæ•ˆã€‚å› æ­¤ï¼Œå½“æ‚¨æ‰§è¡Œ `some_dict[5] = "Python"` æ—¶ï¼ŒPython ä¼šæ‰¾åˆ°å…·æœ‰ç­‰ä»·é”®å€¼ `5.0 -> "Ruby"` çš„ç°æœ‰é¡¹ï¼Œè¦†ç›–å…¶å€¼ï¼Œå¹¶ä¿ç•™åŸå§‹é”®å€¼ã€‚

  ```py
  >>> some_dict
  {5.0: 'Ruby'}
  >>> some_dict[5] = "Python"
  >>> some_dict
  {5.0: 'Python'}
  ```
* é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å°†é”®å€¼æ›´æ–°ä¸º`5`ï¼ˆè€Œä¸æ˜¯`5.0`ï¼‰ï¼Ÿ æˆ‘ä»¬å®é™…ä¸Šä¸èƒ½åŸåœ°æ›´æ–°ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å…ˆåˆ é™¤é”®ï¼ˆ`del some_dict[5.0]`ï¼‰ï¼Œç„¶åé‡æ–°èµ‹å€¼ï¼ˆ`some_dict[5]`ï¼‰å¾—åˆ°æ•´æ•°`5` ä½œä¸ºé”®è€Œä¸æ˜¯æµ®ç‚¹æ•° `5.0`ï¼Œå°½ç®¡è¿™å±äºæå°‘æ•°æƒ…å†µã€‚

* Python æ˜¯å¦‚ä½•åœ¨åŒ…å« `5.0` çš„å­—å…¸ä¸­æ‰¾åˆ° `5` çš„ï¼Ÿ Python åªéœ€è¦èŠ±è´¹å¸¸æ•°æ—¶é—´ï¼Œè€Œæ— éœ€ä½¿ç”¨å“ˆå¸Œå‡½æ•°éå†æ¯ä¸€é¡¹ã€‚å½“ Python åœ¨ dict ä¸­æŸ¥æ‰¾é”® `foo` æ—¶ï¼Œå®ƒé¦–å…ˆè®¡ç®— `hash(foo)`ï¼ˆä»¥å¸¸æ•°æ—¶é—´è¿è¡Œï¼‰ã€‚å› ä¸ºåœ¨ Python ä¸­ï¼Œè¦æ±‚ç›¸ç­‰çš„å¯¹è±¡å…·æœ‰ç›¸åŒçš„å“ˆå¸Œå€¼ï¼ˆæ­¤å¤„ä¸º[æ–‡æ¡£](https://docs.python.org/3/reference/datamodel.html#object.__hash__)ï¼‰ï¼Œ`5` ã€`5.0` å’Œ `5 + 0j` å…·æœ‰ç›¸åŒçš„å“ˆå¸Œå€¼ã€‚

  ```py
  >>> 5 == 5.0 == 5 + 0j
  True
  >>> hash(5) == hash(5.0) == hash(5 + 0j)
  True
  ```

  **æ³¨æ„ï¼š** åä¹‹ä¸ä¸€å®šæ­£ç¡®ï¼šå…·æœ‰ç›¸ç­‰å“ˆå¸Œå€¼çš„å¯¹è±¡æœ¬èº«å¯èƒ½ä¸ç›¸ç­‰ã€‚ï¼ˆè¿™æ˜¯[å“ˆå¸Œå†²çª](https://en.wikipedia.org/wiki/Collision_(computer_science)ï¼‰é€ æˆçš„ï¼Œè¿™ä¹Ÿä¼šé™ä½å“ˆå¸Œè¿ç®—çš„æ€§èƒ½ã€‚ï¼‰


---

### > Deep down, we're all the same./æœ¬è´¨ä¸Š,æˆ‘ä»¬éƒ½ä¸€æ ·. *

```py
class WTF:
  pass
```

**Output:**
```py
>>> WTF() == WTF() # ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡åº”è¯¥ä¸ç›¸ç­‰
False
>>> WTF() is WTF() # ä¹Ÿä¸ç›¸åŒ
False
>>> hash(WTF()) == hash(WTF()) # å“ˆå¸Œå€¼ä¹Ÿåº”è¯¥ä¸åŒ
True
>>> id(WTF()) == id(WTF())
True
```

#### ğŸ’¡ è¯´æ˜:

* å½“è°ƒç”¨ `id` å‡½æ•°æ—¶, Python åˆ›å»ºäº†ä¸€ä¸ª `WTF` ç±»çš„å¯¹è±¡å¹¶ä¼ ç»™ `id` å‡½æ•°. ç„¶å `id` å‡½æ•°è·å–å…¶idå€¼ (ä¹Ÿå°±æ˜¯å†…å­˜åœ°å€), ç„¶åä¸¢å¼ƒè¯¥å¯¹è±¡. è¯¥å¯¹è±¡å°±è¢«é”€æ¯äº†.
* å½“æˆ‘ä»¬è¿ç»­ä¸¤æ¬¡è¿›è¡Œè¿™ä¸ªæ“ä½œæ—¶, Pythonä¼šå°†ç›¸åŒçš„å†…å­˜åœ°å€åˆ†é…ç»™ç¬¬äºŒä¸ªå¯¹è±¡. å› ä¸º (åœ¨CPythonä¸­) `id` å‡½æ•°ä½¿ç”¨å¯¹è±¡çš„å†…å­˜åœ°å€ä½œä¸ºå¯¹è±¡çš„idå€¼, æ‰€ä»¥ä¸¤ä¸ªå¯¹è±¡çš„idå€¼æ˜¯ç›¸åŒçš„.
* ç»¼ä¸Š, å¯¹è±¡çš„idå€¼ä»…ä»…åœ¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå†…å”¯ä¸€. åœ¨å¯¹è±¡è¢«é”€æ¯ä¹‹å, æˆ–è¢«åˆ›å»ºä¹‹å‰, å…¶ä»–å¯¹è±¡å¯ä»¥å…·æœ‰ç›¸åŒçš„idå€¼.
* é‚£ä¸ºä»€ä¹ˆ `is` æ“ä½œçš„ç»“æœä¸º `False` å‘¢? è®©æˆ‘ä»¬çœ‹çœ‹è¿™æ®µä»£ç .
  ```py
  class WTF(object):
    def __init__(self): print("I")
    def __del__(self): print("D")
  ```

  **Output:**
  ```py
  >>> WTF() is WTF()
  I
  I
  D
  D
  False
  >>> id(WTF()) == id(WTF())
  I
  D
  I
  D
  True
  ```
  æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„, å¯¹è±¡é”€æ¯çš„é¡ºåºæ˜¯é€ æˆæ‰€æœ‰ä¸åŒä¹‹å¤„çš„åŸå› .


---

### > Disorder within order/æœ‰åºä¸­æ½œè—ç€æ— åº *
<!-- Example ID: 91bff1f8-541d-455a-9de4-6cd8ff00ea66 --->

```py
from collections import OrderedDict

dictionary = dict()
dictionary[1] = 'a'; dictionary[2] = 'b';

ordered_dict = OrderedDict()
ordered_dict[1] = 'a'; ordered_dict[2] = 'b';

another_ordered_dict = OrderedDict()
another_ordered_dict[2] = 'b'; another_ordered_dict[1] = 'a';

class DictWithHash(dict):
    """
    å®ç°äº† __hash__ é­”æ³•æ–¹æ³•çš„dictç±»
    """
    __hash__ = lambda self: 0

class OrderedDictWithHash(OrderedDict):
    """
    å®ç°äº† __hash__ é­”æ³•æ–¹æ³•çš„OrderedDictç±»
    """
    __hash__ = lambda self: 0
```

**Output**
```py
>>> dictionary == ordered_dict # å¦‚æœ a == b
True
>>> dictionary == another_ordered_dict # ä¸” b == c
True
>>> ordered_dict == another_ordered_dict # é‚£ä¹ˆä¸ºä»€ä¹ˆ c == a ä¸æˆç«‹??
False

# ä¼—æ‰€å‘¨çŸ¥ï¼Œsetæ•°æ®ç»“æ„å‚¨å­˜ä¸é‡å¤å…ƒç´ ï¼Œ
# è®©æˆ‘ä»¬ç”Ÿæˆä»¥ä¸Šå­—å…¸çš„ set æ•°æ®ç±»å‹ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆâ€¦â€¦

>>> len({dictionary, ordered_dict, another_ordered_dict})
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unhashable type: 'dict'

# dictç±»æ²¡æœ‰å®ç° __hash__ ï¼Œå‡ºé”™å¯ä»¥ç†è§£ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨æˆ‘ä»¬æ´¾ç”Ÿçš„ç±»ã€‚

>>> dictionary = DictWithHash()
>>> dictionary[1] = 'a'; dictionary[2] = 'b';
>>> ordered_dict = OrderedDictWithHash()
>>> ordered_dict[1] = 'a'; ordered_dict[2] = 'b';
>>> another_ordered_dict = OrderedDictWithHash()
>>> another_ordered_dict[2] = 'b'; another_ordered_dict[1] = 'a';
>>> len({dictionary, ordered_dict, another_ordered_dict})
1
>>> len({ordered_dict, another_ordered_dict, dictionary}) # äº¤æ¢é¡ºåº
2
```

åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ?

#### ğŸ’¡ è¯´æ˜:

- ç­‰å·çš„ä¼ é€’æ€§æ²¡æœ‰åœ¨ `dictionary`, `ordered_dict` å’Œ `another_ordered_dict` ä¹‹é—´ç”Ÿæ•ˆæ˜¯ `OrderedDict` ç±»ä¸­ `__eq__` æ–¹æ³•çš„å®ç°æ–¹å¼é€ æˆçš„ã€‚æ ¹æ®[æ–‡æ¡£](https://docs.python.org/3/library/collections.html#ordereddict-objects)ä»¥ä¸‹éƒ¨åˆ†:
  
    > å¯¹äº `OrderedDict` ç±»ä¹‹é—´ï¼Œç›¸ç­‰æ€§çš„åˆ¤å®šæ˜¯ä½ç½®æ•æ„Ÿçš„ï¼Œå®ç°ç±»ä¼¼äº `list(od1.items())==list(od2.items())`ã€‚å¯¹äº `OrderedDict` ç±»ä¸å…¶ä»– `Mapping` å¯¹è±¡ï¼ˆä¾‹å¦‚`dict` ç±»ï¼‰ï¼Œç›¸ç­‰æ€§çš„åˆ¤å®šæ˜¯éä½ç½®æ•æ„Ÿçš„ã€‚
- è¿™æ˜¯ä¸ºäº†ä»»ä½•ä½¿ç”¨å¸¸è§„ `dict` ç±»çš„åœ°æ–¹èƒ½å¤Ÿç›´æ¥ä½¿ç”¨ `OrderedDict` å¯¹è±¡ä»£æ›¿ã€‚
- å¥½å•¦ï¼Œé‚£ä¸ºä»€ä¹ˆæ”¹å˜é¡ºåºä¼šå½±å“ `set` å¯¹è±¡ç”Ÿæˆçš„é•¿åº¦å‘¢? ç­”æ¡ˆå°±æ˜¯ä¸Šé¢è¯´çš„ç¼ºä¹ç­‰å·çš„ä¼ é€’æ€§ã€‚å› ä¸º `set` ç±»æ˜¯å”¯ä¸€å…ƒç´ çš„æ— åºé›†åˆï¼Œå…ƒç´ æ’å…¥çš„é¡ºåºä¸åº”è¯¥æœ‰å½±å“ã€‚ä½†åœ¨æ­¤ä¾‹ä¸­ï¼Œç¡®æœ‰ä¸åŒã€‚è®©æˆ‘ä»¬è¿›ä¸€æ­¥æ·±å…¥ã€‚

    ```py
    >>> some_set = set()
    >>> some_set.add(dictionary) # æ¶‰åŠçš„å˜é‡æ˜¯å‰åºç‰‡æ®µå®šä¹‰çš„ mapping å¯¹è±¡
    >>> ordered_dict in some_set
    True
    >>> some_set.add(ordered_dict)
    >>> len(some_set)
    1
    >>> another_ordered_dict in some_set
    True
    >>> some_set.add(another_ordered_dict)
    >>> len(some_set)
    1

    >>> another_set = set()
    >>> another_set.add(ordered_dict)
    >>> another_ordered_dict in another_set
    False
    >>> another_set.add(another_ordered_dict)
    >>> len(another_set)
    2
    >>> dictionary in another_set
    True
    >>> another_set.add(another_ordered_dict)
    >>> len(another_set)
    2
    ```
    å› æ­¤ï¼Œä¸ä¸€è‡´æ€§æ˜¯ç”±äº `another_ordered_dict in another_set` ç»“æœä¸º `False`ã€‚ å› ä¸º `ordered_dict` å·²ç»åœ¨ `another_set` ä¸­ï¼Œä½†å¦‚å‰æ‰€è¿°ï¼Œ `ordered_dict == another_ordered_dict` çš„ç»“æœä¸º `False`ï¼Œä¼šåœ¨åç»­å†åŠ å…¥ `another_ordered_dict` åˆ° `another_set` ä¸­ã€‚


---

### > Keep trying.../ä¸åœçš„try *
<!-- Example ID: b4349443-e89f-4d25-a109-8616be9d41a --->

```py
def some_func():
    try:
        return 'from_try'
    finally:
        return 'from_finally'

def another_func(): 
    for _ in range(3):
        try:
            continue
        finally:
            print("Finally!")

def one_more_func(): # A gotcha!
    try:
        for i in range(3):
            try:
                1 / i
            except ZeroDivisionError:
                # Let's throw it here and handle it outside for loop
                raise ZeroDivisionError("A trivial divide by zero error")
            finally:
                print("Iteration", i)
                break
    except ZeroDivisionError as e:
        print("Zero division error occurred", e)
```

**Output:**

```py
>>> some_func()
'from_finally'

>>> another_func()
Finally!
Finally!
Finally!

>>> 1 / 0
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ZeroDivisionError: division by zero

>>> one_more_func()
Iteration 0

```

#### ğŸ’¡ è¯´æ˜:

- å½“åœ¨ "try...finally" è¯­å¥çš„ `try` ä¸­æ‰§è¡Œ `return`, `break` æˆ– `continue` å, `finally` å­å¥ä¾ç„¶ä¼šæ‰§è¡Œ.
- å‡½æ•°çš„è¿”å›å€¼ç”±æœ€åæ‰§è¡Œçš„ `return` è¯­å¥å†³å®š. ç”±äº `finally` å­å¥ä¸€å®šä¼šæ‰§è¡Œ, æ‰€ä»¥ `finally` å­å¥ä¸­çš„ `return` å°†å§‹ç»ˆæ˜¯æœ€åæ‰§è¡Œçš„è¯­å¥.
- è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœ finally å­å¥æ‰§è¡Œ `return` æˆ– `break` è¯­å¥ï¼Œä¸´æ—¶ä¿å­˜çš„å¼‚å¸¸å°†è¢«ä¸¢å¼ƒã€‚


---

### > For what?/ä¸ºä»€ä¹ˆ?

```py
some_string = "wtf"
some_dict = {}
for i, some_dict[i] in enumerate(some_string):
    pass
```

**Output:**
```py
>>> some_dict # åˆ›å»ºäº†ç´¢å¼•å­—å…¸.
{0: 'w', 1: 't', 2: 'f'}
```

####  ğŸ’¡ è¯´æ˜:

* [Python è¯­æ³•](https://docs.python.org/3/reference/grammar.html) ä¸­å¯¹ `for` çš„å®šä¹‰æ˜¯:
  ```
  for_stmt: 'for' exprlist 'in' testlist ':' suite ['else' ':' suite]
  ```
  å…¶ä¸­ `exprlist` æŒ‡åˆ†é…ç›®æ ‡. è¿™æ„å‘³ç€å¯¹å¯è¿­ä»£å¯¹è±¡ä¸­çš„**æ¯ä¸€é¡¹éƒ½ä¼šæ‰§è¡Œ**ç±»ä¼¼ `{exprlist} = {next_value}` çš„æ“ä½œ.

  ä¸€ä¸ªæœ‰è¶£çš„ä¾‹å­è¯´æ˜äº†è¿™ä¸€ç‚¹:
  ```py
  for i in range(4):
      print(i)
      i = 10
  ```

  **Output:**
  ```
  0
  1
  2
  3
  ```

  ä½ å¯æ›¾è§‰å¾—è¿™ä¸ªå¾ªç¯åªä¼šè¿è¡Œä¸€æ¬¡?

  **ğŸ’¡ è¯´æ˜:**

  - ç”±äºå¾ªç¯åœ¨Pythonä¸­å·¥ä½œæ–¹å¼, èµ‹å€¼è¯­å¥ `i = 10` å¹¶ä¸ä¼šå½±å“è¿­ä»£å¾ªç¯, åœ¨æ¯æ¬¡è¿­ä»£å¼€å§‹ä¹‹å‰, è¿­ä»£å™¨(è¿™é‡ŒæŒ‡ `range(4)`) ç”Ÿæˆçš„ä¸‹ä¸€ä¸ªå…ƒç´ å°±è¢«è§£åŒ…å¹¶èµ‹å€¼ç»™ç›®æ ‡åˆ—è¡¨çš„å˜é‡(è¿™é‡ŒæŒ‡ `i`)äº†.

* åœ¨æ¯ä¸€æ¬¡çš„è¿­ä»£ä¸­, `enumerate(some_string)` å‡½æ•°å°±ç”Ÿæˆä¸€ä¸ªæ–°å€¼ `i` (è®¡æ•°å™¨å¢åŠ ) å¹¶ä» `some_string` ä¸­è·å–ä¸€ä¸ªå­—ç¬¦. ç„¶åå°†å­—å…¸ `some_dict` é”® `i` (åˆšåˆšåˆ†é…çš„) çš„å€¼è®¾ä¸ºè¯¥å­—ç¬¦. æœ¬ä¾‹ä¸­å¾ªç¯çš„å±•å¼€å¯ä»¥ç®€åŒ–ä¸º:
  ```py
  >>> i, some_dict[i] = (0, 'w')
  >>> i, some_dict[i] = (1, 't')
  >>> i, some_dict[i] = (2, 'f')
  >>> some_dict
  ```

---

### > Evaluation time discrepancy/æ‰§è¡Œæ—¶æœºå·®å¼‚

1\.
```py
array = [1, 8, 15]
# ä¸€ä¸ªå…¸å‹çš„ç”Ÿæˆå™¨è¡¨è¾¾å¼
g = (x for x in array if array.count(x) > 0)
array = [2, 8, 22]
```

**Output:**
```py
>>> print(list(g)) #å…¶ä»–çš„å€¼å»å“ªå„¿äº†ï¼Ÿ
[8]
```

2\.

```py
array_1 = [1,2,3,4]
g1 = (x for x in array_1)
array_1 = [1,2,3,4,5]

array_2 = [1,2,3,4]
g2 = (x for x in array_2)
array_2[:] = [1,2,3,4,5]
```

**Output:**
```py
>>> print(list(g1))
[1,2,3,4]

>>> print(list(g2))
[1,2,3,4,5]
```

3\.

```py
array_3 = [1, 2, 3]
array_4 = [10, 20, 30]
gen = (i + j for i in array_3 for j in array_4)

array_3 = [4, 5, 6]
array_4 = [400, 500, 600]
```

**Output:**
```py
>>> print(list(gen))
[401, 501, 601, 402, 502, 602, 403, 503, 603]
```

#### ğŸ’¡ è¯´æ˜

- åœ¨[ç”Ÿæˆå™¨](https://wiki.python.org/moin/Generators)è¡¨è¾¾å¼ä¸­, `in` å­å¥åœ¨å£°æ˜æ—¶æ‰§è¡Œ, è€Œæ¡ä»¶å­å¥åˆ™æ˜¯åœ¨è¿è¡Œæ—¶æ‰§è¡Œ.
- æ‰€ä»¥åœ¨è¿è¡Œå‰, `array` å·²ç»è¢«é‡æ–°èµ‹å€¼ä¸º `[2, 8, 22]`, å› æ­¤å¯¹äºä¹‹å‰çš„ `1`, `8` å’Œ `15`, åªæœ‰ `count(8)` çš„ç»“æœæ˜¯å¤§äº `0` çš„, æ‰€ä»¥ç”Ÿæˆå™¨åªä¼šç”Ÿæˆ `8`.
- ç¬¬äºŒéƒ¨åˆ†ä¸­ `g1` å’Œ `g2` çš„è¾“å‡ºå·®å¼‚åˆ™æ˜¯ç”±äºå˜é‡ `array_1` å’Œ `array_2` è¢«é‡æ–°èµ‹å€¼çš„æ–¹å¼å¯¼è‡´çš„.
- åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹, `array_1` è¢«ç»‘å®šåˆ°æ–°å¯¹è±¡ `[1,2,3,4,5]`, å› ä¸º `in` å­å¥æ˜¯åœ¨å£°æ˜æ—¶è¢«æ‰§è¡Œçš„ï¼Œ æ‰€ä»¥å®ƒä»ç„¶å¼•ç”¨æ—§å¯¹è±¡ `[1,2,3,4]`(å¹¶æ²¡æœ‰è¢«é”€æ¯).
- åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹, å¯¹ `array_2` çš„åˆ‡ç‰‡èµ‹å€¼å°†ç›¸åŒçš„æ—§å¯¹è±¡ `[1,2,3,4]` åŸåœ°æ›´æ–°ä¸º `[1,2,3,4,5]`. å› æ­¤ `g2` å’Œ `array_2` ä»ç„¶å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡(è¿™ä¸ªå¯¹è±¡ç°åœ¨å·²ç»æ›´æ–°ä¸º `[1,2,3,4,5]`).
- å¥½å•¦ï¼ŒæŒ‰ç…§ç›®å‰è®¨è®ºçš„é€»è¾‘ï¼Œç¬¬ä¸‰ä¸ªä»£ç æ®µä¸­çš„ `list(gen)` çš„å€¼ä¸åº”è¯¥æ˜¯ `[11, 21, 31, 12, 22, 32, 13, 23, 33]` å—? ï¼ˆæ¯•ç«Ÿ `array_3` å’Œ `array_4` çš„è¡Œä¸ºä¸ `array_1` ä¸€æ ·ï¼‰ã€‚ [PEP-289](https://www.python.org/dev/peps/pep-0289/#the-details) ä¸­è§£é‡Šäº†ï¼ˆåªæœ‰ï¼‰`array_4` å€¼æ›´æ–°çš„åŸå› 
     > åªæœ‰æœ€å¤–å±‚çš„ for è¡¨è¾¾å¼ä¼šç«‹å³è®¡ç®—ï¼Œå…¶ä»–è¡¨è¾¾å¼ä¼šå»¶è¿Ÿåˆ°ç”Ÿæˆå™¨è¿è¡Œã€‚


---

### > `is not ...` is not `is (not ...)`/`is not ...` ä¸æ˜¯ `is (not ...)`

```py
>>> 'something' is not None
True
>>> 'something' is (not None)
False
```

#### ğŸ’¡ è¯´æ˜:

- `is not` æ˜¯ä¸ªå•ç‹¬çš„äºŒå…ƒè¿ç®—ç¬¦, ä¸åˆ†åˆ«ä½¿ç”¨ `is` å’Œ `not` ä¸åŒ.
-  å¦‚æœæ“ä½œç¬¦ä¸¤ä¾§çš„å˜é‡æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡, åˆ™ `is not` çš„ç»“æœä¸º `False`, å¦åˆ™ç»“æœä¸º `True`.


---

### > A tic-tac-toe where X wins in the first attempt!/ä¸€è¹´å³è‡³!

```py
# æˆ‘ä»¬å…ˆåˆå§‹åŒ–ä¸€ä¸ªå˜é‡row
row = [""]*3 #row i['', '', '']
# å¹¶åˆ›å»ºä¸€ä¸ªå˜é‡board
board = [row]*3
```

**Output:**
```py
>>> board
[['', '', ''], ['', '', ''], ['', '', '']]
>>> board[0]
['', '', '']
>>> board[0][0]
''
>>> board[0][0] = "X"
>>> board
[['X', '', ''], ['X', '', ''], ['X', '', '']]
```

æˆ‘ä»¬æœ‰æ²¡æœ‰èµ‹å€¼è¿‡3ä¸ª "X" å‘¢ï¼Ÿ

#### ğŸ’¡ è¯´æ˜:

å½“æˆ‘ä»¬åˆå§‹åŒ– `row` å˜é‡æ—¶, ä¸‹é¢è¿™å¼ å›¾å±•ç¤ºäº†å†…å­˜ä¸­çš„æƒ…å†µã€‚

![image](../images/tic-tac-toe/after_row_initialized.png)

è€Œå½“é€šè¿‡å¯¹ `row` åšä¹˜æ³•æ¥åˆå§‹åŒ– `board` æ—¶, å†…å­˜ä¸­çš„æƒ…å†µåˆ™å¦‚ä¸‹å›¾æ‰€ç¤º (æ¯ä¸ªå…ƒç´  `board[0]`, `board[1]` å’Œ `board[2]` éƒ½å’Œ `row` ä¸€æ ·å¼•ç”¨äº†åŒä¸€åˆ—è¡¨.)

![image](../images/tic-tac-toe/after_board_initialized.png)

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ä½¿ç”¨å˜é‡ `row` ç”Ÿæˆ `board` æ¥é¿å…è¿™ç§æƒ…å†µ. ([è¿™ä¸ª](https://github.com/satwikkansal/wtfpython/issues/68)issueæå‡ºäº†è¿™ä¸ªéœ€æ±‚.)

```py
>>> board = [['']*3 for _ in range(3)]
>>> board[0][0] = "X"
>>> board
[['X', '', ''], ['', '', ''], ['', '', '']]
```

---

### > SchrÃ¶dinger's variable/è–›å®šè°”çš„å˜é‡ *
<!-- Example ID: 4dc42f77-94cb-4eb5-a120-8203d3ed7604 --->

```py
funcs = []
results = []
for x in range(7):
    def some_func():
        return x
    funcs.append(some_func)
    results.append(some_func()) # æ³¨æ„è¿™é‡Œå‡½æ•°è¢«æ‰§è¡Œäº†

funcs_results = [func() for func in funcs]
```

**Output:**
```py
>>> results
[0, 1, 2, 3, 4, 5, 6]
>>> funcs_results
[6, 6, 6, 6, 6, 6, 6]
```

å³ä½¿æ¯æ¬¡åœ¨è¿­ä»£ä¸­å°† `some_func` åŠ å…¥ `funcs` å‰çš„ `x` å€¼éƒ½ä¸ç›¸åŒ, æ‰€æœ‰çš„å‡½æ•°è¿˜æ˜¯éƒ½è¿”å›6.

// å†æ¢ä¸ªä¾‹å­

```py
>>> powers_of_x = [lambda x: x**i for i in range(10)]
>>> [f(2) for f in powers_of_x]
[512, 512, 512, 512, 512, 512, 512, 512, 512, 512]
```

#### ğŸ’¡ è¯´æ˜:

- å½“åœ¨å¾ªç¯å†…éƒ¨å®šä¹‰ä¸€ä¸ªå‡½æ•°æ—¶, å¦‚æœè¯¥å‡½æ•°åœ¨å…¶ä¸»ä½“ä¸­ä½¿ç”¨äº†å¾ªç¯å˜é‡, åˆ™é—­åŒ…å‡½æ•°å°†ä¸å¾ªç¯å˜é‡ç»‘å®š, è€Œä¸æ˜¯å®ƒçš„å€¼. å› æ­¤, æ‰€æœ‰çš„å‡½æ•°éƒ½æ˜¯ä½¿ç”¨æœ€ååˆ†é…ç»™å˜é‡çš„å€¼æ¥è¿›è¡Œè®¡ç®—çš„.

- å¯ä»¥é€šè¿‡å°†å¾ªç¯å˜é‡ä½œä¸ºå‘½åå˜é‡ä¼ é€’ç»™å‡½æ•°æ¥è·å¾—é¢„æœŸçš„ç»“æœ. **ä¸ºä»€ä¹ˆè¿™æ ·å¯è¡Œ?** å› ä¸ºè¿™ä¼šåœ¨å‡½æ•°å†…å†æ¬¡å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä½¿ç”¨äº†æ¥è‡ªä¸Šä¸‹æ–‡çš„`x`ï¼ˆå³*ä¸æ˜¯*å±€éƒ¨å˜é‡ï¼‰ï¼š
ï¼ˆè¯‘è€…æ³¨: inspectä½äºPythonæ ‡å‡†åº“ä¸­ï¼Œè¯¥æ¨¡å—ç”¨äºæ”¶é›†pythonå¯¹è±¡çš„ä¿¡æ¯ï¼Œå¯ä»¥è·å–ç±»æˆ–å‡½æ•°çš„å‚æ•°çš„ä¿¡æ¯ï¼Œæºç ï¼Œè§£æå †æ ˆï¼Œå¯¹å¯¹è±¡è¿›è¡Œç±»å‹æ£€æŸ¥ç­‰ç­‰ï¼ŒPython3.3+ç‰ˆæœ¬æ”¯æŒgetclosurevarså‡½æ•°ï¼‰
```py
>>> import inspect
>>> inspect.getclosurevars(funcs[0])
ClosureVars(nonlocals={}, globals={'x': 6}, builtins={}, unbound=set())
```

ç”±äº `x` æ˜¯ä¸€ä¸ªå…¨å±€å€¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ›´æ–° `x` æ¥æ›´æ”¹ `funcs` ç”¨æ¥æŸ¥æ‰¾å’Œè¿”å›çš„å€¼ï¼š

```py
>>> x = 42
>>> [func() for func in funcs]
[42, 42, 42, 42, 42, 42, 42]
```

* è¦è·å¾—æƒ³è¦çš„ç»“æœï¼Œæ‚¨å¯ä»¥å°†å¾ªç¯å˜é‡ä½œä¸ºå‘½åå˜é‡ä¼ é€’ç»™å‡½æ•°ã€‚ **ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ** å› ä¸ºè¿™ä¼šåœ¨å‡½æ•°çš„ä½œç”¨åŸŸå†…å®šä¹‰å˜é‡ã€‚ å®ƒå°†ä¸å†è¿›å…¥å‘¨å›´ï¼ˆå…¨å±€ï¼‰èŒƒå›´æ¥æŸ¥æ‰¾å˜é‡å€¼ï¼Œè€Œæ˜¯ä¼šåˆ›å»ºä¸€ä¸ªå±€éƒ¨å˜é‡æ¥å­˜å‚¨è¯¥æ—¶é—´ç‚¹çš„â€œxâ€å€¼ã€‚

```py
funcs = []
for x in range(7):
    def some_func(x=x):
        return x
    funcs.append(some_func)
```

**Output:**
```py
>>> funcs_results = [func() for func in funcs]
>>> funcs_results
[0, 1, 2, 3, 4, 5, 6]
```

æ­¤æ—¶ï¼Œä¸å†ä½¿ç”¨å…¨å±€å˜é‡ `x`ï¼š

```py
>>> inspect.getclosurevars(funcs[0])
ClosureVars(nonlocals={}, globals={}, builtins={}, unbound=set())
```


---

### > The chicken-egg problem/å…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹ *
<!-- Example ID: 60730dc2-0d79-4416-8568-2a63323b3ce8 --->

1\.
```py
>>> isinstance(3, int)
True
>>> isinstance(type, object)
True
>>> isinstance(object, type)
True
```
é‚£ä¹ˆåˆ°åº•è°æ˜¯â€œæœ€ç»ˆâ€çš„åŸºç±»å‘¢ï¼Ÿä¸‹è¾¹é¡ºä¾¿åˆ—å‡ºæ›´å¤šçš„ä»¤äººå›°æƒ‘çš„åœ°æ–¹

2\. 

```py
>>> class A: pass
>>> isinstance(A, A)
False
>>> isinstance(type, type)
True
>>> isinstance(object, object)
True
```

3\.

```py
>>> issubclass(int, object)
True
>>> issubclass(type, object)
True
>>> issubclass(object, type)
False
```


#### ğŸ’¡ è¯´æ˜

- `type` æ˜¯ Python ä¸­çš„[å…ƒç±»](https://realpython.com/python-metaclasses/)ã€‚
- Python ä¸­ï¼Œ**ä¸€åˆ‡**çš†å¯¹è±¡ï¼Œå…¶ä¸­åŒ…æ‹¬ç±»åŠå…¶å¯¹è±¡ï¼ˆå®ä¾‹ï¼‰ã€‚
- `type` ç±»å‹æ˜¯`object`ç±»çš„å…ƒç±»ï¼Œæ¯ä¸ªç±»ï¼ˆåŒ…æ‹¬`type`ï¼‰éƒ½ç›´æ¥æˆ–é—´æ¥åœ°ç»§æ‰¿è‡ª`object`ã€‚
- å¯¹è±¡å’Œç±»å‹ä¹‹é—´æ²¡æœ‰çœŸæ­£çš„åŸºç±»ã€‚ä¸Šè¿°ç‰‡æ®µä¸­çš„ä»¤äººå›°æƒ‘çš„åœ°æ–¹ä¹‹æ‰€ä»¥å‡ºç°ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬ä» Python ç±»çš„è§’åº¦è€ƒè™‘è¿™äº›å…³ç³»ï¼ˆissubclass å’Œ isinstanceï¼‰ã€‚ `object`å’Œ`type`ä¹‹é—´çš„å…³ç³»ä¸èƒ½åœ¨çº¯pythonä¸­é‡ç°ã€‚ æ›´å‡†ç¡®åœ°è¯´ï¼Œä»¥ä¸‹å…³ç³»ä¸èƒ½åœ¨çº¯ Python ä¸­é‡ç°:
    + Aç±»æ˜¯Bç±»çš„ä¸€ä¸ªå®ä¾‹ï¼ŒBç±»æ˜¯Aç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚
    + Aç±»æ˜¯å®ƒè‡ªå·±çš„ä¸€ä¸ªå®ä¾‹ã€‚
- `object`å’Œ`type`ä¹‹é—´çš„å…³ç³»ï¼ˆæ—¢æ˜¯å½¼æ­¤çš„å®ä¾‹ï¼Œä¹Ÿæ˜¯å®ƒä»¬è‡ªå·±çš„å®ä¾‹ï¼‰å­˜åœ¨äº Python ä¸­ï¼Œè¿™æ˜¯æºäºå®ç°å±‚çº§ä¸Šçš„â€œä½œå¼Šâ€è¡Œä¸ºã€‚


---

### > Subclass relationships/å­ç±»å…³ç³» *

**Output:**
```py
>>> from collections.abc import Hashable
>>> issubclass(list, object)
True
>>> issubclass(object, Hashable)
True
>>> issubclass(list, Hashable)
False
```

å­ç±»å…³ç³»åº”è¯¥æ˜¯å¯ä¼ é€’çš„, å¯¹å§? (å³, å¦‚æœ `A` æ˜¯ `B` çš„å­ç±», `B` æ˜¯ `C` çš„å­ç±», é‚£ä¹ˆ `A` _åº”è¯¥_ æ˜¯ `C` çš„å­ç±».)

#### ğŸ’¡ è¯´æ˜:

* Python ä¸­çš„å­ç±»å…³ç³»å¹¶ä¸ä¸€å®šæ˜¯ä¼ é€’çš„. ä»»ä½•äººéƒ½å¯ä»¥åœ¨å…ƒç±»ä¸­éšæ„å®šä¹‰ `__subclasscheck__`.
* å½“ `issubclass(cls, Hashable)` è¢«è°ƒç”¨æ—¶, å®ƒåªæ˜¯åœ¨ `cls` ä¸­å¯»æ‰¾ `__hash__` æ–¹æ³•æˆ–è€…ä»ç»§æ‰¿çš„çˆ¶ç±»ä¸­å¯»æ‰¾ `__hash__` æ–¹æ³•.
* ç”±äº `object` is å¯æ•£åˆ—çš„(hashable), ä½†æ˜¯ `list` æ˜¯ä¸å¯æ•£åˆ—çš„, æ‰€ä»¥å®ƒæ‰“ç ´äº†è¿™ç§ä¼ é€’å…³ç³».
* åœ¨[è¿™é‡Œ](https://www.naftaliharris.com/blog/python-subclass-intransitivity/)å¯ä»¥æ‰¾åˆ°æ›´è¯¦ç»†çš„è§£é‡Š.

---

### > Methods equality and identity/æ–¹æ³•çš„ç›¸ç­‰æ€§å’Œå”¯ä¸€æ€§ *
<!-- Example ID: 94802911-48fe-4242-defa-728ae893fa32 --->

1.
```py
class SomeClass:
    def method(self):
        pass

    @classmethod
    def classm(cls):
        pass

    @staticmethod
    def staticm():
        pass
```

**Output:**
```py
>>> print(SomeClass.method is SomeClass.method)
True
>>> print(SomeClass.classm is SomeClass.classm)
False
>>> print(SomeClass.classm == SomeClass.classm)
True
>>> print(SomeClass.staticm is SomeClass.staticm)
True
```
è®¿é—® `classm` ä¸¤æ¬¡ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªç›¸ç­‰çš„å¯¹è±¡ï¼Œä½†ä¸æ˜¯*åŒä¸€ä¸ª*ï¼Ÿ è®©æˆ‘ä»¬çœ‹çœ‹ `SomeClass` çš„å®ä¾‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

2.
```py
o1 = SomeClass()
o2 = SomeClass()
```

**Output:**
```py
>>> print(o1.method == o2.method)
False
>>> print(o1.method == o1.method)
True
>>> print(o1.method is o1.method)
False
>>> print(o1.classm is o1.classm)
False
>>> print(o1.classm == o1.classm == o2.classm == SomeClass.classm)
True
>>> print(o1.staticm is o1.staticm is o2.staticm is SomeClass.staticm)
True
```

è®¿é—® ` classm` or `method` ä¸¤æ¬¡, ä¸º `SomeClass` çš„åŒä¸€ä¸ªå®ä¾‹åˆ›å»ºäº†ç›¸ç­‰ä½†æ˜¯*ä¸åŒ*çš„å¯¹è±¡ã€‚

#### ğŸ’¡ è¯´æ˜
* å‡½æ•°æ˜¯[æè¿°ç¬¦](https://docs.python.org/3/howto/descriptor.html)ã€‚æ¯å½“å°†å‡½æ•°ä½œä¸ºå±æ€§è®¿é—®æ—¶ï¼Œå°±ä¼šè°ƒç”¨æè¿°ç¬¦ï¼Œåˆ›å»ºä¸€ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†å‡½æ•°ä¸æ‹¥æœ‰è¯¥å±æ€§çš„å¯¹è±¡â€œç»‘å®šâ€ã€‚å¦‚æœè¢«è°ƒç”¨ï¼Œè¯¥æ–¹æ³•è°ƒç”¨å‡½æ•°ï¼Œéšå¼ä¼ é€’ç»‘å®šå¯¹è±¡ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆè¿™å°±æ˜¯æˆ‘ä»¬å¦‚ä½•å°† self ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°è·å–ï¼Œå°½ç®¡æ²¡æœ‰æ˜¾å¼ä¼ é€’å®ƒï¼‰ã€‚

```py
>>> o1.method
<bound method SomeClass.method of <__main__.SomeClass object at ...>>
```

* å¤šæ¬¡è®¿é—®è¯¥å±æ€§ï¼Œæ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–¹æ³•å¯¹è±¡ï¼ å› æ­¤ï¼Œ`o1.method is o1.method` æ°¸è¿œä¸ä¼šæ˜¯çœŸçš„ã€‚ä½†æ˜¯ï¼Œå°†å‡½æ•°ä½œä¸ºç±»å±æ€§ï¼ˆè€Œä¸æ˜¯å®ä¾‹ï¼‰è®¿é—®å¹¶ä¸ä¼šåˆ›å»ºæ–¹æ³•å¯¹è±¡ï¼Œæ‰€ä»¥ `SomeClass.method is SomeClass.method` æ˜¯çœŸçš„ã€‚

```py
>>> SomeClass.method
<function SomeClass.method at ...>
```

* `classmethod` å°†å‡½æ•°è½¬æ¢ä¸ºç±»æ–¹æ³•ã€‚ ç±»æ–¹æ³•æ˜¯æè¿°ç¬¦ï¼Œå½“è¢«è®¿é—®æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªç»‘å®š*ç±»æœ¬èº«*çš„æ–¹æ³•å¯¹è±¡ï¼Œè€Œä¸æ˜¯å¯¹è±¡æœ¬èº«ã€‚

```py
>>> o1.classm
<bound method SomeClass.classm of <class '__main__.SomeClass'>>
```

* ä¸å‡½æ•°ä¸åŒï¼Œ`classmethod` åœ¨ä½œä¸ºç±»å±æ€§è®¿é—®æ—¶ä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–¹æ³•ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä»¬ç»‘å®šç±»ï¼Œè€Œä¸æ˜¯ç±»çš„ç±»å‹ï¼‰ã€‚ æ‰€ä»¥ `SomeClass.classm is SomeClass.classm` æ˜¯å‡çš„ã€‚

```py
>>> SomeClass.classm
<bound method SomeClass.classm of <class '__main__.SomeClass'>>
```

* å½“ä¸¤ä¸ªå‡½æ•°ç›¸ç­‰å¹¶ä¸”ç»‘å®šçš„å¯¹è±¡ç›¸åŒæ—¶ï¼Œæ–¹æ³•å¯¹è±¡æ¯”è¾ƒç›¸ç­‰ã€‚ æ‰€ä»¥`o1.method == o1.method` ä¸ºçœŸï¼Œå°½ç®¡å®ƒä»¬åœ¨å†…å­˜ä¸­æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ã€‚
* `staticmethod` å°†å‡½æ•°è½¬æ¢ä¸ºâ€œæ— æ“ä½œâ€æè¿°ç¬¦ï¼Œå®ƒæŒ‰åŸæ ·è¿”å›å‡½æ•°ã€‚æ²¡æœ‰æ–¹æ³•å¯¹è±¡è¢«åˆ›å»ºï¼Œæ‰€ä»¥ `is` çš„æ¯”è¾ƒè¿ç®—ä¸ºçœŸã€‚

```py
>>> o1.staticm
<function SomeClass.staticm at ...>
>>> SomeClass.staticm
<function SomeClass.staticm at ...>
```

* æ¯æ¬¡ Python è°ƒç”¨å®ä¾‹æ–¹æ³•æ—¶éƒ½å¿…é¡»åˆ›å»ºæ–°çš„â€œæ–¹æ³•â€å¯¹è±¡ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½å¿…é¡»ä¿®æ”¹å‚æ•°ä»¥æ’å…¥ `self` ä¸¥é‡å½±å“æ€§èƒ½ã€‚CPython 3.7 [è§£å†³äº†è¿™ä¸ªé—®é¢˜](https://bugs.python.org/issue26110) ã€‚é€šè¿‡å¼•å…¥æ–°çš„æ“ä½œç æ¥å¤„ç†è°ƒç”¨æ–¹æ³•è€Œä¸åˆ›å»ºä¸´æ—¶æ–¹æ³•å¯¹è±¡ã€‚è¿™ä»…åœ¨å®é™…è°ƒç”¨è®¿é—®çš„å‡½æ•°æ—¶ä½¿ç”¨ï¼Œå› æ­¤è¿™é‡Œçš„ä»£ç ç‰‡æ®µä¸å—å½±å“ï¼Œä»ç„¶ä¼šç”Ÿæˆæ–¹æ³•:)


---

### > All-true-ation/è¿”å›Trueçš„allå‡½æ•° *

<!-- Example ID: dfe6d845-e452-48fe-a2da-0ed3869a8042 -->

```py
>>> all([True, True, True])
True
>>> all([True, True, False])
False

>>> all([])
True
>>> all([[]])
False
>>> all([[[]]])
True
```

ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§True-Falseçš„å˜åŒ–ï¼Ÿ

#### ğŸ’¡ è¯´æ˜

- `all` å‡½æ•°çš„å®ç°ç­‰ä»·äºï¼š

- ```py
  def all(iterable):
      for element in iterable:
          if not element:
              return False
      return True
  ```

- `all([])` è¿”å› `True` å› ä¸ºå¯è¿­ä»£å¯¹è±¡ä¸ºç©ºã€‚ 
- `all([[]])` è¿”å› `False` å› ä¸ºä¼ å…¥çš„æ•°ç»„æœ‰ä¸€ä¸ªå…ƒç´  `[]`ï¼Œ åœ¨Pythonä¸­ï¼Œç©ºåˆ—è¡¨ä¸ºå‡ã€‚
- `all([[[]]])` å’Œæ›´é«˜çš„é€’å½’å˜ä½“æ€»æ˜¯`True`ã€‚ è¿™æ˜¯å› ä¸ºä¼ é€’çš„æ•°ç»„çš„å•ä¸ªå…ƒç´ ï¼ˆ`[[...]]`ï¼‰ä¸å†æ˜¯ç©ºçš„ï¼Œè€Œæœ‰å€¼çš„åˆ—è¡¨ä¸ºçœŸã€‚


---

### > The surprising comma/æ„å¤–çš„é€—å·

**Output:**
```py
>>> def f(x, y,):
...     print(x, y)
...
>>> def g(x=4, y=5,):
...     print(x, y)
...
>>> def h(x, **kwargs,):
  File "<stdin>", line 1
    def h(x, **kwargs,):
                     ^
SyntaxError: invalid syntax
>>> def h(*args,):
  File "<stdin>", line 1
    def h(*args,):
                ^
SyntaxError: invalid syntax
```

#### ğŸ’¡ è¯´æ˜:

- åœ¨Pythonå‡½æ•°çš„å½¢å¼å‚æ•°åˆ—è¡¨ä¸­, å°¾éšé€—å·å¹¶ä¸ä¸€å®šæ˜¯åˆæ³•çš„.
- åœ¨Pythonä¸­, å‚æ•°åˆ—è¡¨éƒ¨åˆ†ç”¨å‰ç½®é€—å·å®šä¹‰, éƒ¨åˆ†ç”¨å°¾éšé€—å·å®šä¹‰. è¿™ç§å†²çªå¯¼è‡´é€—å·è¢«å¤¹åœ¨ä¸­é—´, æ²¡æœ‰è§„åˆ™å®šä¹‰å®ƒ.(è¯‘:è¿™ä¸€å¥çœ‹å¾—æˆ‘ä¹Ÿå¾ˆæ‡µé€¼,åªèƒ½å¼ºç¿»äº†.è¯¦ç»†è§£é‡Šçœ‹ä¸‹é¢çš„è®¨è®ºå¸–ä¼šä¸€ç›®äº†ç„¶.)
- **æ³¨æ„:** å°¾éšé€—å·çš„é—®é¢˜å·²ç»åœ¨Python 3.6ä¸­è¢«[ä¿®å¤](https://bugs.python.org/issue9232)äº†. è€Œè¿™ç¯‡[å¸–å­](https://bugs.python.org/issue9232#msg248399)ä¸­åˆ™ç®€è¦è®¨è®ºäº†Pythonä¸­å°¾éšé€—å·çš„ä¸åŒç”¨æ³•.
---

### > Strings and the backslashes/å­—ç¬¦ä¸²ä¸åæ–œæ 
<!-- Example ID: 6ae622c3-6d99-4041-9b33-507bd1a4407b --->

**Output:**
```py
>>> print("\"")
"

>>> print(r"\"")
\"

>>> print(r"\")
File "<stdin>", line 1
    print(r"\")
              ^
SyntaxError: EOL while scanning string literal

>>> r'\'' == "\\'"
True
```

#### ğŸ’¡ è¯´æ˜:

- åœ¨ä¸€èˆ¬çš„pythonå­—ç¬¦ä¸²ä¸­ï¼Œåæ–œæ ç”¨äºè½¬ä¹‰å¯èƒ½å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ï¼ˆå¦‚å•å¼•å·ã€åŒå¼•å·å’Œåæ–œæ æœ¬èº«ï¼‰ã€‚

    ```py
    >>> "wt\"f"
    'wt"f'
    ```

- åœ¨ä»¥ `r` å¼€å¤´çš„åŸå§‹å­—ç¬¦ä¸²ä¸­, åæ–œæ å¹¶æ²¡æœ‰ç‰¹æ®Šå«ä¹‰.
    ```py
    >>> r'wt\"f' == 'wt\\"f'
    True
    >>> print(repr(r'wt\"f')
    'wt\\"f'

    >>> print("\n")

    >>> print(r"\\n")
    '\\n'
    ```

- è¿™æ„å‘³ç€å½“è§£æå™¨åœ¨åŸå§‹å­—ç¬¦ä¸²ä¸­é‡åˆ°åæ–œæ æ—¶ï¼Œå®ƒæœŸæœ›åé¢æœ‰å¦ä¸€ä¸ªå­—ç¬¦ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ˆ`print(r"\")`ï¼‰ï¼Œåæ–œæ è½¬ä¹‰äº†å°¾éšå¼•å·ï¼Œä½¿è§£æå™¨æ²¡æœ‰ç»ˆæ­¢å¼•å·ï¼ˆå› æ­¤äº§ç”Ÿäº†`SyntaxError`ï¼‰ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåæ–œæ åœ¨åŸå§‹å­—ç¬¦ä¸²æœ«å°¾ä¸èµ·ä½œç”¨çš„åŸå› ã€‚


---

### > not knot!/åˆ«çº ç»“!

```py
x = True
y = False
```

**Output:**
```py
>>> not x == y
True
>>> x == not y
  File "<input>", line 1
    x == not y
           ^
SyntaxError: invalid syntax
```

#### ğŸ’¡ è¯´æ˜:

* è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ä¼šå½±å“è¡¨è¾¾å¼çš„æ±‚å€¼é¡ºåº, è€Œåœ¨ Python ä¸­ `==` è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§è¦é«˜äº `not` è¿ç®—ç¬¦.
* æ‰€ä»¥ `not x == y` ç›¸å½“äº `not (x == y)`, åŒæ—¶ç­‰ä»·äº `not (True == False)`, æœ€åçš„è¿ç®—ç»“æœå°±æ˜¯ `True`.
* ä¹‹æ‰€ä»¥ `x == not y` ä¼šæŠ›ä¸€ä¸ª `SyntaxError` å¼‚å¸¸, æ˜¯å› ä¸ºå®ƒä¼šè¢«è®¤ä¸ºç­‰ä»·äº `(x == not) y`, è€Œä¸æ˜¯ä½ ä¸€å¼€å§‹æœŸæœ›çš„ `x == (not y)`.
* è§£é‡Šå™¨æœŸæœ› `not` æ ‡è®°æ˜¯ `not in` æ“ä½œç¬¦çš„ä¸€éƒ¨åˆ† (å› ä¸º `==` å’Œ `not in` æ“ä½œç¬¦å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§), ä½†æ˜¯å®ƒåœ¨ `not` æ ‡è®°åé¢æ‰¾ä¸åˆ° `in` æ ‡è®°, æ‰€ä»¥ä¼šæŠ›å‡º `SyntaxError` å¼‚å¸¸.

---

### > Half triple-quoted strings/ä¸‰ä¸ªå¼•å·

**Output:**
```py
>>> print('wtfpython''')
wtfpython
>>> print("wtfpython""")
wtfpython
>>> # ä¸‹é¢çš„è¯­å¥ä¼šæŠ›å‡º `SyntaxError` å¼‚å¸¸
>>> # print('''wtfpython')
>>> # print("""wtfpython")
```

#### ğŸ’¡ è¯´æ˜:
+ Python æä¾›éšå¼çš„[å­—ç¬¦ä¸²è¿æ¥](https://docs.python.org/2/reference/lexical_analysis.html#string-literal-concatenation), ä¾‹å¦‚,
  ```
  >>> print("wtf" "python")
  wtfpython
  >>> print("wtf" "") # or "wtf"""
  wtf
  ```
+ `'''` å’Œ `"""` åœ¨ Pythonä¸­ä¹Ÿæ˜¯å­—ç¬¦ä¸²å®šç•Œç¬¦, Python è§£é‡Šå™¨åœ¨å…ˆé‡åˆ°ä¸‰ä¸ªå¼•å·çš„çš„æ—¶å€™ä¼šå°è¯•å†å¯»æ‰¾ä¸‰ä¸ªç»ˆæ­¢å¼•å·ä½œä¸ºå®šç•Œç¬¦, å¦‚æœä¸å­˜åœ¨åˆ™ä¼šå¯¼è‡´ `SyntaxError` å¼‚å¸¸.


---

### > What's wrong with booleans?/å¸ƒå°”ä½ å’‹äº†?

1\.
```py
# ä¸€ä¸ªç®€å•çš„ä¾‹å­, ç»Ÿè®¡ä¸‹é¢å¯è¿­ä»£å¯¹è±¡ä¸­çš„å¸ƒå°”å‹å€¼çš„ä¸ªæ•°å’Œæ•´å‹å€¼çš„ä¸ªæ•°
mixed_list = [False, 1.0, "some_string", 3, True, [], False]
integers_found_so_far = 0
booleans_found_so_far = 0

for item in mixed_list:
    if isinstance(item, int):
        integers_found_so_far += 1
    elif isinstance(item, bool):
        booleans_found_so_far += 1
```

**Output:**
```py
>>> integers_found_so_far
4
>>> booleans_found_so_far
0
```

2\.
```py
>>> some_bool = True
>>> "wtf" * some_bool
'wtf'
>>> some_bool = False
>>> "wtf" * some_bool
''
```

3\.
```py
def tell_truth():
    True = False
    if True == False:
        print("I have lost faith in truth!")
```

**Output (< 3.x):**

```py
>>> tell_truth()
I have lost faith in truth!
```


#### ğŸ’¡ è¯´æ˜:

* å¸ƒå°”å€¼æ˜¯ `int` çš„å­ç±»
    ```py
    >>> issubclass(bool, int)
    True
    >>> issubclass(int, bool)
    False
    ```

* å› æ­¤ï¼Œ`True` å’Œ `False` æ˜¯ `int` çš„å®ä¾‹
  ```py
  >>> isinstance(True, int)
  True
  >>> isinstance(False, int)
  True
  ```

*  `True` çš„æ•´æ•°å€¼æ˜¯ `1`, è€Œ `False` çš„æ•´æ•°å€¼æ˜¯ `0`

  ```py
  >>> int(True)
  1
  >>> int(False)
  0
  ```

* å…³äºå…¶èƒŒåçš„åŸç†, è¯·çœ‹è¿™ä¸ª StackOverflow çš„[å›ç­”](https://stackoverflow.com/a/8169049/4354153).

* æœ€åˆï¼ŒPython æ²¡æœ‰ `bool` ç±»å‹ï¼ˆäººä»¬ä½¿ç”¨ 0 è¡¨ç¤ºå‡ï¼Œä½¿ç”¨éé›¶å€¼ï¼Œå¦‚ 1 è¡¨ç¤ºçœŸï¼‰ã€‚`True`ã€`False` å’Œ `bool` ç±»å‹åœ¨ 2.x ç‰ˆæœ¬ä¸­è¢«æ·»åŠ ï¼Œä½†ä¸ºäº†å‘åå…¼å®¹ï¼Œ`True` å’Œ `False` ä¸èƒ½æˆä¸ºå¸¸é‡ã€‚å®ƒä»¬åªæ˜¯å†…ç½®å˜é‡ï¼Œå¯ä»¥é‡æ–°åˆ†é…å®ƒä»¬

* Python 3 å‘åä¸å…¼å®¹ï¼Œé—®é¢˜ç»ˆäºå¾—åˆ°è§£å†³ï¼Œå› æ­¤æœ€åä¸€ä¸ªä»£ç æ®µä¸é€‚ç”¨äº Python 3.xï¼


---

### > Class attributes and instance attributes/ç±»å±æ€§å’Œå®ä¾‹å±æ€§

1\.
```py
class A:
    x = 1

class B(A):
    pass

class C(A):
    pass
```

**Output:**
```py
>>> A.x, B.x, C.x
(1, 1, 1)
>>> B.x = 2
>>> A.x, B.x, C.x
(1, 2, 1)
>>> A.x = 3
>>> A.x, B.x, C.x
(3, 2, 3)
>>> a = A()
>>> a.x, A.x
(3, 3)
>>> a.x += 1
>>> a.x, A.x
(4, 3)
```

2\.
```py
class SomeClass:
    some_var = 15
    some_list = [5]
    another_list = [5]
    def __init__(self, x):
        self.some_var = x + 1
        self.some_list = self.some_list + [x]
        self.another_list += [x]
```

**Output:**

```py
>>> some_obj = SomeClass(420)
>>> some_obj.some_list
[5, 420]
>>> some_obj.another_list
[5, 420]
>>> another_obj = SomeClass(111)
>>> another_obj.some_list
[5, 111]
>>> another_obj.another_list
[5, 420, 111]
>>> another_obj.another_list is SomeClass.another_list
True
>>> another_obj.another_list is some_obj.another_list
True
```

#### ğŸ’¡ è¯´æ˜:

* ç±»å˜é‡å’Œå®ä¾‹å˜é‡åœ¨å†…éƒ¨æ˜¯é€šè¿‡ç±»å¯¹è±¡çš„å­—å…¸æ¥å¤„ç†(è¯‘: å°±æ˜¯ `__dict__` å±æ€§). å¦‚æœåœ¨å½“å‰ç±»çš„å­—å…¸ä¸­æ‰¾ä¸åˆ°çš„è¯å°±å»å®ƒçš„çˆ¶ç±»ä¸­å¯»æ‰¾.
* `+=` è¿ç®—ç¬¦ä¼šåœ¨åŸåœ°ä¿®æ”¹å¯å˜å¯¹è±¡, è€Œä¸æ˜¯åˆ›å»ºæ–°å¯¹è±¡. å› æ­¤, åœ¨è¿™ç§æƒ…å†µä¸‹, ä¿®æ”¹ä¸€ä¸ªå®ä¾‹çš„å±æ€§ä¼šå½±å“å…¶ä»–å®ä¾‹å’Œç±»å±æ€§.

---

### > yielding None/ç”Ÿæˆ None

```py
some_iterable = ('a', 'b')

def some_func(val):
    return "something"
```

**Output:**
```py
>>> [x for x in some_iterable]
['a', 'b']
>>> [(yield x) for x in some_iterable]
<generator object <listcomp> at 0x7f70b0a4ad58>
>>> list([(yield x) for x in some_iterable])
['a', 'b']
>>> list((yield x) for x in some_iterable)
['a', None, 'b', None]
>>> list(some_func((yield x)) for x in some_iterable)
['a', 'something', 'b', 'something']
```

#### ğŸ’¡ è¯´æ˜:
- æ¥æºå’Œè§£é‡Šå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°: https://stackoverflow.com/questions/32139885/yield-in-list-comprehensions-and-generator-expressions
- ç›¸å…³é”™è¯¯æŠ¥å‘Š: http://bugs.python.org/issue10544
- è¿™ä¸ªbugåœ¨3.7ä»¥åçš„ç‰ˆæœ¬ä¸­ä¸è¢«æ¨èä½¿ç”¨, å¹¶åœ¨3.8ä¸­è¢«ä¿®å¤. å› æ­¤åœ¨3.8ä¸­å°è¯•åœ¨æ¨å¯¼å¼ä¸­ä½¿ç”¨ yield, åªä¼šå¾—åˆ°ä¸€ä¸ª SyntaxError. è¯¦ç»†å†…å®¹å¯ä»¥çœ‹[3.7æ›´æ–°å†…å®¹](https://docs.python.org/dev/whatsnew/3.7.html#deprecated-python-behavior), [3.8æ›´æ–°å†…å®¹](https://docs.python.org/dev/whatsnew/3.8.html#changes-in-python-behavior).


---

### > Yielding from... return!/ç”Ÿæˆå™¨é‡Œçš„return *
<!-- Example ID: 5626d8ef-8802-49c2-adbc-7cda5c550816 --->
1\.

```py
def some_func(x):
    if x == 3:
        return ["wtf"]
    else:
        yield from range(x)
```

**Output (> 3.3):**

```py
>>> list(some_func(3))
[]
```

`"wtf"` å»å“ªå„¿äº†ï¼Ÿæ˜¯å› ä¸º`yield from`çš„ä¸€äº›ç‰¹æ®Šæ•ˆæœå—ï¼Ÿè®©æˆ‘ä»¬éªŒè¯ä¸€ä¸‹

2\.

```py
def some_func(x):
    if x == 3:
        return ["wtf"]
    else:
        for i in range(x):
          yield i
```

**Output:**

```py
>>> list(some_func(3))
[]
```

åŒæ ·çš„ç»“æœï¼Œè¿™é‡Œä¹Ÿä¸èµ·ä½œç”¨ã€‚

#### ğŸ’¡ è¯´æ˜

+ ä» Python 3.3 å¼€å§‹ï¼Œå¯ä»¥åœ¨ç”Ÿæˆå™¨ä¸­ä½¿ç”¨å¸¦æœ‰å€¼çš„ `return` è¯­å¥ï¼ˆå‚è§ [PEP380](https://www.python.org/dev/peps/pep-0380/)ï¼‰ã€‚ [å®˜æ–¹æ–‡æ¡£](https://www.python.org/dev/peps/pep-0380/#enhancements-to-stopiteration) æè¿°ï¼Œ

> "... ç”Ÿæˆå™¨ä¸­çš„ `return expr` ä¼šå¯¼è‡´åœ¨é€€å‡ºç”Ÿæˆå™¨æ—¶å¼•å‘ `StopIteration(expr)`ã€‚"

+ åœ¨ `some_func(3)` ä¾‹å­ä¸­ï¼Œ`return` è¯­å¥åœ¨å¼€å§‹å°±å¼•å‘äº†`StopIteration`ã€‚ `StopIteration` å¼‚å¸¸ä¼šåœ¨`list(...)` åŒ…è£…å™¨å’Œ`for` å¾ªç¯ä¸­è‡ªåŠ¨æ•è·ã€‚ å› æ­¤ï¼Œä»¥ä¸Šä¸¤ä¸ªç‰‡æ®µéƒ½äº§ç”Ÿçš„æ˜¯ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚

+ è¦ä»ç”Ÿæˆå™¨ `some_func` ä¸­è·å– `["wtf"]`ï¼Œæˆ‘ä»¬éœ€è¦æ•è· `StopIteration` å¼‚å¸¸ï¼Œ

    ```py
    try:
        next(some_func(3))
    except StopIteration as e:
        some_string = e.value
    ```

    ```py
    >>> some_string
    ["wtf"]
    ```


---

### > Nan-reflexivity/Nançš„è‡ªåæ€§
<!-- Example ID: 59bee91a-36e0-47a4-8c7d-aa89bf1d3976 --->

1\.
```py
a = float('inf')
b = float('nan')
c = float('-iNf')  # è¿™äº›å­—ç¬¦ä¸²ä¸åŒºåˆ†å¤§å°å†™
d = float('nan')
```

**Output:**
```py
>>> a
inf
>>> b
nan
>>> c
-inf
>>> float('some_other_string')
ValueError: could not convert string to float: some_other_string
>>> a == -c #inf==inf
True
>>> None == None # None==None
True
>>> b == d #ä½†æ˜¯ nan!=nan
False
>>> 50/a
0.0
>>> a/a
nan
>>> 23 + b
nan
```

2\.

```py
>>> x = float('nan')
>>> y = x / x
>>> y is y # åŒä¸€æ€§(identity)å…·å¤‡
True
>>> y == y # yä¸å…·å¤‡ç›¸ç­‰æ€§(equality)
False
>>> [y] == [y] # ä½†åŒ…å«yçš„åˆ—è¡¨éªŒè¯ç›¸ç­‰æ€§(equality)æˆåŠŸäº†
True
```

#### ğŸ’¡ è¯´æ˜:

`'inf'` å’Œ `'nan'` æ˜¯ç‰¹æ®Šçš„å­—ç¬¦ä¸²(ä¸åŒºåˆ†å¤§å°å†™), å½“æ˜¾ç¤ºè½¬æ¢æˆ `float` å‹æ—¶, å®ƒä»¬åˆ†åˆ«ç”¨äºè¡¨ç¤ºæ•°å­¦æ„ä¹‰ä¸Šçš„ "æ— ç©·å¤§" å’Œ "éæ•°å­—".
- ç”±äºæ ¹æ® IEEE æ ‡å‡† `NaN != NaN`ï¼Œéµå®ˆæ­¤è§„åˆ™æ‰“ç ´äº† Python ä¸­é›†åˆå…ƒç´ çš„è‡ªåæ€§å‡è®¾ï¼Œå³å¦‚æœ `x` æ˜¯ `list` ç­‰é›†åˆçš„ä¸€éƒ¨åˆ†ï¼Œåˆ™æ¯”è¾ƒç­‰è¿ç®—çš„å®ç°åŸºäºå‡è®¾`x == x`ã€‚ç”±äºè¿™ä¸ªå‡è®¾ï¼Œåœ¨æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ æ—¶é¦–å…ˆæ¯”è¾ƒèº«ä»½`identity`ï¼ˆå› ä¸ºå®ƒæ›´å¿«ï¼‰ï¼Œå¹¶ä¸”ä»…åœ¨èº«ä»½ä¸åŒ¹é…æ—¶æ‰æ¯”è¾ƒå€¼ã€‚ä»¥ä¸‹ç‰‡æ®µå°†æ›´æ¸…æ¥šåœ°è¯´æ˜ï¼Œ

  ```py
  >>> x = float('nan')
  >>> x == x, [x] == [x]
  (False, True)
  >>> y = float('nan')
  >>> y == y, [y] == [y]
  (False, True)
  >>> x == y, [x] == [y]
  (False, False)
  ```

  ç”±äº `x` å’Œ `y` çš„èº«ä»½`identity`ä¸åŒï¼Œæ‰€ä»¥è€ƒè™‘çš„å€¼ä¹Ÿä¸åŒï¼› å› æ­¤è¿™æ¬¡æ¯”è¾ƒè¿”å›â€œFalseâ€ã€‚


- æ„Ÿå…´è¶£å¯ä»¥é˜…è¯» [Reflexivity, and other pillars of civilization](https://bertrandmeyer.com/2010/02/06/reflexivity-and-other-pillars-of-civilization/)


---

### > Mutating the immutable!/å¼ºäººæ‰€éš¾

```py
some_tuple = ("A", "tuple", "with", "values")
another_tuple = ([1, 2], [3, 4], [5, 6])
```

**Output:**
```py
>>> some_tuple[2] = "change this"
TypeError: 'tuple' object does not support item assignment
>>> another_tuple[2].append(1000) # è¿™é‡Œä¸å‡ºç°é”™è¯¯
>>> another_tuple
([1, 2], [3, 4], [5, 6, 1000])
>>> another_tuple[2] += [99, 999]
TypeError: 'tuple' object does not support item assignment
>>> another_tuple
([1, 2], [3, 4], [5, 6, 1000, 99, 999])
```

æˆ‘è¿˜ä»¥ä¸ºå…ƒç»„æ˜¯ä¸å¯å˜çš„å‘¢...

#### ğŸ’¡ è¯´æ˜:

* å¼•ç”¨ https://docs.python.org/2/reference/datamodel.html

    > ä¸å¯å˜åºåˆ—
        ä¸å¯å˜åºåˆ—çš„å¯¹è±¡ä¸€æ—¦åˆ›å»ºå°±ä¸èƒ½å†æ”¹å˜. (å¦‚æœå¯¹è±¡åŒ…å«å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨ï¼Œåˆ™è¿™äº›å…¶ä»–å¯¹è±¡å¯èƒ½æ˜¯å¯å˜çš„å¹¶ä¸”å¯èƒ½ä¼šè¢«ä¿®æ”¹; ä½†æ˜¯ï¼Œç”±ä¸å¯å˜å¯¹è±¡ç›´æ¥å¼•ç”¨çš„å¯¹è±¡é›†åˆä¸èƒ½æ›´æ”¹.)

* `+=` æ“ä½œç¬¦åœ¨åŸåœ°ä¿®æ”¹äº†åˆ—è¡¨. å…ƒç´ èµ‹å€¼æ“ä½œå¹¶ä¸å·¥ä½œ, ä½†æ˜¯å½“å¼‚å¸¸æŠ›å‡ºæ—¶, å…ƒç´ å·²ç»åœ¨åŸåœ°è¢«ä¿®æ”¹äº†.

(è¯‘: å¯¹äºä¸å¯å˜å¯¹è±¡, è¿™é‡ŒæŒ‡tuple, `+=` å¹¶ä¸æ˜¯åŸå­æ“ä½œ, è€Œæ˜¯ `extend` å’Œ `=` ä¸¤ä¸ªåŠ¨ä½œ, è¿™é‡Œ `=` æ“ä½œè™½ç„¶ä¼šæŠ›å‡ºå¼‚å¸¸, ä½† `extend` æ“ä½œå·²ç»ä¿®æ”¹æˆåŠŸäº†. è¯¦ç»†è§£é‡Šå¯ä»¥çœ‹[è¿™é‡Œ](https://segmentfault.com/a/1190000010767068))

---

### > The disappearing variable from outer scope/æ¶ˆå¤±çš„å¤–éƒ¨å˜é‡

```py
e = 7
try:
    raise Exception()
except Exception as e:
    pass
```

**Output (Python 2.x):**
```py
>>> print(e)
# prints nothing
```

**Output (Python 3.x):**
```py
>>> print(e)
NameError: name 'e' is not defined
```

#### ğŸ’¡ è¯´æ˜:

* å‡ºå¤„: https://docs.python.org/3/reference/compound_stmts.html#except

  å½“ä½¿ç”¨ `as` ä¸ºç›®æ ‡åˆ†é…å¼‚å¸¸çš„æ—¶å€™, å°†åœ¨exceptå­å¥çš„æœ«å°¾æ¸…é™¤è¯¥å¼‚å¸¸.

  è¿™å°±å¥½åƒ

  ```py
  except E as N:
      foo
  ```

  ä¼šè¢«ç¿»è¯‘æˆ

  ```py
  except E as N:
      try:
          foo
      finally:
          del N
  ```

  è¿™æ„å‘³ç€å¼‚å¸¸å¿…é¡»åœ¨è¢«èµ‹å€¼ç»™å…¶ä»–å˜é‡æ‰èƒ½åœ¨ `except` å­å¥ä¹‹åå¼•ç”¨å®ƒ. è€Œå¼‚å¸¸ä¹‹æ‰€ä»¥ä¼šè¢«æ¸…é™¤, åˆ™æ˜¯ç”±äºä¸Šé¢é™„åŠ çš„å›æº¯ä¿¡æ¯(trackback)ä¼šå’Œæ ˆå¸§(stack frame)å½¢æˆå¾ªç¯å¼•ç”¨, ä½¿å¾—è¯¥æ ˆå¸§ä¸­çš„æ‰€æœ‰æœ¬åœ°å˜é‡åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶å‘ç”Ÿä¹‹å‰éƒ½å¤„äºæ´»åŠ¨çŠ¶æ€.(è¯‘: ä¹Ÿå°±æ˜¯è¯´ä¸ä¼šè¢«å›æ”¶)

* å­å¥åœ¨ Python ä¸­å¹¶æ²¡æœ‰ç‹¬ç«‹çš„ä½œç”¨åŸŸ. ç¤ºä¾‹ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½å¤„äºåŒä¸€ä½œç”¨åŸŸå†…, æ‰€ä»¥å˜é‡ `e` ä¼šç”±äºæ‰§è¡Œäº† `except` å­å¥è€Œè¢«åˆ é™¤. è€Œå¯¹äºæœ‰ç‹¬ç«‹çš„å†…éƒ¨ä½œç”¨åŸŸçš„å‡½æ•°æ¥è¯´æƒ…å†µå°±ä¸ä¸€æ ·äº†. ä¸‹é¢çš„ä¾‹å­è¯´æ˜äº†è¿™ä¸€ç‚¹:

     ```py
     def f(x):
         del(x)
         print(x)

     x = 5
     y = [5, 4, 3]
     ```

     **Output:**
     ```py
     >>>f(x)
     UnboundLocalError: local variable 'x' referenced before assignment
     >>>f(y)
     UnboundLocalError: local variable 'x' referenced before assignment
     >>> x
     5
     >>> y
     [5, 4, 3]
     ```

* åœ¨ Python 2.x ä¸­, `Exception()` å®ä¾‹è¢«èµ‹å€¼ç»™äº†å˜é‡ `e`, æ‰€ä»¥å½“ä½ å°è¯•æ‰“å°ç»“æœçš„æ—¶å€™, å®ƒçš„è¾“å‡ºä¸ºç©º.ï¼ˆè¯‘: æ­£å¸¸çš„Exceptionå®ä¾‹æ‰“å°å‡ºæ¥å°±æ˜¯ç©ºï¼‰

    **Output (Python 2.x):**
    ```py
    >>> e
    Exception()
    >>> print e
    # æ²¡æœ‰æ‰“å°ä»»ä½•å†…å®¹!
    ```


---

### > The mysterious key type conversion/ç¥ç§˜çš„é”®å‹è½¬æ¢ *

```py
class SomeClass(str):
    pass

some_dict = {'s':42}
```

**Output:**
```py
>>> type(list(some_dict.keys())[0])
str
>>> s = SomeClass('s')
>>> some_dict[s] = 40
>>> some_dict # é¢„æœŸ: ä¸¤ä¸ªä¸åŒçš„é”®å€¼å¯¹
{'s': 40}
>>> type(list(some_dict.keys())[0])
str
```

#### ğŸ’¡ è¯´æ˜:

* ç”±äº `SomeClass` ä¼šä» `str` è‡ªåŠ¨ç»§æ‰¿ `__hash__` æ–¹æ³•, æ‰€ä»¥ `s` å¯¹è±¡å’Œ `"s"` å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼æ˜¯ç›¸åŒçš„.
* è€Œ `SomeClass("s") == "s"` ä¸º `True` æ˜¯å› ä¸º `SomeClass` ä¹Ÿç»§æ‰¿äº† `str` ç±» `__eq__` æ–¹æ³•.
* ç”±äºä¸¤è€…çš„å“ˆå¸Œå€¼ç›¸åŒä¸”ç›¸ç­‰, æ‰€ä»¥å®ƒä»¬åœ¨å­—å…¸ä¸­è¡¨ç¤ºç›¸åŒçš„é”®.
* å¦‚æœæƒ³è¦å®ç°æœŸæœ›çš„åŠŸèƒ½, æˆ‘ä»¬å¯ä»¥é‡å®šä¹‰ `SomeClass` çš„ `__eq__` æ–¹æ³•.
  ```py
  class SomeClass(str):
    def __eq__(self, other):
        return (
            type(self) is SomeClass
            and type(other) is SomeClass
            and super().__eq__(other)
        )

    # å½“æˆ‘ä»¬è‡ªå®šä¹‰ __eq__ æ–¹æ³•æ—¶, Python ä¸ä¼šå†è‡ªåŠ¨ç»§æ‰¿ __hash__ æ–¹æ³•
    # æ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦å®šä¹‰å®ƒ
    __hash__ = str.__hash__

  some_dict = {'s':42}
  ```

  **Output:**
  ```py
  >>> s = SomeClass('s')
  >>> some_dict[s] = 40
  >>> some_dict
  {'s': 40, 's': 42}
  >>> keys = list(some_dict.keys())
  >>> type(keys[0]), type(keys[1])
  (__main__.SomeClass, str)
  ```

---

### > Let's see if you can guess this?/çœ‹çœ‹ä½ èƒ½å¦çŒœåˆ°è¿™ä¸€ç‚¹?

```py
a, b = a[b] = {}, 5
```

**Output:**
```py
>>> a
{5: ({...}, 5)}
```

#### ğŸ’¡ è¯´æ˜:

* æ ¹æ® [Python è¯­è¨€å‚è€ƒ](https://docs.python.org/2/reference/simple_stmts.html#assignment-statements), èµ‹å€¼è¯­å¥çš„å½¢å¼å¦‚ä¸‹
  ```
  (target_list "=")+ (expression_list | yield_expression)
  ```

  > èµ‹å€¼è¯­å¥è®¡ç®—è¡¨è¾¾å¼åˆ—è¡¨(expression list)(ç‰¢è®° è¿™å¯ä»¥æ˜¯å•ä¸ªè¡¨è¾¾å¼æˆ–ä»¥é€—å·åˆ†éš”çš„åˆ—è¡¨, åè€…è¿”å›å…ƒç»„)å¹¶å°†å•ä¸ªç»“æœå¯¹è±¡ä»å·¦åˆ°å³åˆ†é…ç»™ç›®æ ‡åˆ—è¡¨ä¸­çš„æ¯ä¸€é¡¹.

*  `(target_list "=")+` ä¸­çš„ `+` æ„å‘³ç€å¯ä»¥æœ‰**ä¸€ä¸ªæˆ–å¤šä¸ª**ç›®æ ‡åˆ—è¡¨. åœ¨è¿™ä¸ªä¾‹å­ä¸­, ç›®æ ‡åˆ—è¡¨æ˜¯ `a, b` å’Œ `a[b]` (æ³¨æ„è¡¨è¾¾å¼åˆ—è¡¨åªèƒ½æœ‰ä¸€ä¸ª, åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ `{}, 5`).

* è¡¨è¾¾å¼åˆ—è¡¨è®¡ç®—ç»“æŸå, å°†å…¶å€¼è‡ªåŠ¨è§£åŒ…å**ä»å·¦åˆ°å³**åˆ†é…ç»™ç›®æ ‡åˆ—è¡¨(target list). å› æ­¤, åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­, é¦–å…ˆå°† `{}, 5` å…ƒç»„å¹¶èµ‹å€¼ç»™ `a, b`, ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ° `a = {}` ä¸” `b = 5`.

* `a` è¢«èµ‹å€¼çš„ `{}` æ˜¯å¯å˜å¯¹è±¡.

* ç¬¬äºŒä¸ªç›®æ ‡åˆ—è¡¨æ˜¯ `a[b]` (ä½ å¯èƒ½è§‰å¾—è¿™é‡Œä¼šæŠ¥é”™, å› ä¸ºåœ¨ä¹‹å‰çš„è¯­å¥ä¸­ `a` å’Œ `b` éƒ½è¿˜æ²¡æœ‰è¢«å®šä¹‰. ä½†æ˜¯åˆ«å¿˜äº†, æˆ‘ä»¬åˆšåˆšå°† `a` èµ‹å€¼ `{}` ä¸”å°† `b` èµ‹å€¼ä¸º `5`).

* ç°åœ¨, æˆ‘ä»¬å°†é€šè¿‡å°†å­—å…¸ä¸­é”® `5` çš„å€¼è®¾ç½®ä¸ºå…ƒç»„ `({}, 5)` æ¥åˆ›å»ºå¾ªç¯å¼•ç”¨ (è¾“å‡ºä¸­çš„ `{...}` æŒ‡ä¸ `a` å¼•ç”¨äº†ç›¸åŒçš„å¯¹è±¡). ä¸‹é¢æ˜¯ä¸€ä¸ªæ›´ç®€å•çš„å¾ªç¯å¼•ç”¨çš„ä¾‹å­
  ```py
  >>> some_list = some_list[0] = [0]
  >>> some_list
  [[...]]
  >>> some_list[0]
  [[...]]
  >>> some_list is some_list[0]
  True
  >>> some_list[0][0][0][0][0][0] == some_list
  True
  ```
  æˆ‘ä»¬çš„ä¾‹å­å°±æ˜¯è¿™ç§æƒ…å†µ (`a[b][0]` ä¸ `a` æ˜¯ç›¸åŒçš„å¯¹è±¡)

* æ€»ç»“ä¸€ä¸‹, ä½ ä¹Ÿå¯ä»¥æŠŠä¾‹å­æ‹†æˆ
  ```py
  a, b = {}, 5
  a[b] = a, b
  ```
  å¹¶ä¸”å¯ä»¥é€šè¿‡ `a[b][0]` ä¸ `a` æ˜¯ç›¸åŒçš„å¯¹è±¡æ¥è¯æ˜æ˜¯å¾ªç¯å¼•ç”¨
  ```py
  >>> a[b][0] is a
  True
  ```


---

### > Exceeds the limit for integer string conversion/æ•´å‹è½¬å­—ç¬¦ä¸²è¶Šç•Œ
```py
>>> # Python 3.10.6
>>> int("2" * 5432)

>>> # Python 3.10.8
>>> int("2" * 5432)
```

**Output:**
```py
>>> # Python 3.10.6
222222222222222222222222222222222222222222222222222222222222222...

>>> # Python 3.10.8
Traceback (most recent call last):
   ...
ValueError: Exceeds the limit (4300) for integer string conversion:
   value has 5432 digits; use sys.set_int_max_str_digits()
   to increase the limit.
```

#### ğŸ’¡ è¯´æ˜:

* å¯¹`int()`çš„è°ƒç”¨åœ¨Python 3.10.6ä¸­è¿è¡Œè‰¯å¥½ï¼Œä½†åœ¨Python 3.10.8ä¸­å¼•å‘ValueErrorã€‚è¯·æ³¨æ„ï¼ŒPythonä»ç„¶å¯ä»¥å¤„ç†å¤§æ•´æ•°ã€‚åªæœ‰åœ¨æ•´å‹å’Œå­—ç¬¦ä¸²ä¹‹é—´è½¬æ¢æ—¶æ‰ä¼šå‡ºç°æ­¤é”™è¯¯ã€‚
* å¹¸è¿çš„æ˜¯ï¼Œå½“æ‚¨å¸Œæœ›æ“ä½œè¶…è¿‡å…è®¸çš„ä½æ•°é™åˆ¶æ—¶ï¼Œå¯ä»¥å¢åŠ è¯¥é™åˆ¶çš„ä¸Šé™ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€ï¼š
    - ä½¿ç”¨ -X int_max_str_digits çš„å‘½ä»¤è¡Œå‚æ•°ï¼ˆä¾‹å¦‚ï¼Œ python3 -X int_max_str_digits=640ï¼‰
    - ä½¿ç”¨æ¥è‡ªsysæ¨¡å—çš„set_int_max_str_digits()å‡½æ•°
    - è®¾å®š PYTHONINTMAXSTRDIGITS ç¯å¢ƒå˜é‡

æ›´å¤šæ›´æ”¹è®¾ç½®ä¸Šé™çš„æ“ä½œç»†èŠ‚æŸ¥çœ‹[æ–‡æ¡£](https://docs.python.org/3/library/stdtypes.html#int-max-str-digits)ã€‚

---

## Section: Slippery Slopes/æ»‘å¡è°¬è¯¯


### > Modifying a dictionary while iterating over it/è¿­ä»£å­—å…¸æ—¶çš„ä¿®æ”¹

```py
x = {0: None}

for i in x:
    del x[i]
    x[i+1] = None
    print(i)
```

**Output (Python 2.7- Python 3.5):**

```
0
1
2
3
4
5
6
7
```

æ˜¯çš„, å®ƒè¿è¡Œäº†**å…«æ¬¡**ç„¶åæ‰åœä¸‹æ¥.

#### ğŸ’¡ è¯´æ˜:

* Pythonä¸æ”¯æŒå¯¹å­—å…¸è¿›è¡Œè¿­ä»£çš„åŒæ—¶ä¿®æ”¹å®ƒ.
* å®ƒä¹‹æ‰€ä»¥è¿è¡Œ8æ¬¡, æ˜¯å› ä¸ºå­—å…¸ä¼šè‡ªåŠ¨æ‰©å®¹ä»¥å®¹çº³æ›´å¤šé”®å€¼(æˆ‘ä»¬æœ‰8æ¬¡åˆ é™¤è®°å½•, å› æ­¤éœ€è¦æ‰©å®¹). è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå®ç°ç»†èŠ‚. (è¯‘: åº”è¯¥æ˜¯å› ä¸ºå­—å…¸çš„åˆå§‹æœ€å°å€¼æ˜¯8, æ‰©å®¹ä¼šå¯¼è‡´æ•£åˆ—è¡¨åœ°å€å‘ç”Ÿå˜åŒ–è€Œä¸­æ–­å¾ªç¯.)
* åœ¨ä¸åŒçš„Pythonå®ç°ä¸­åˆ é™¤é”®çš„å¤„ç†æ–¹å¼ä»¥åŠè°ƒæ•´å¤§å°çš„æ—¶é—´å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒ.(è¯‘: å°±æ˜¯è¯´ä»€ä¹ˆæ—¶å€™æ‰©å®¹åœ¨ä¸åŒç‰ˆæœ¬ä¸­å¯èƒ½æ˜¯ä¸åŒçš„, åœ¨3.6åŠ3.7çš„ç‰ˆæœ¬ä¸­åˆ°[5](https://github.com/python/cpython/blob/v3.6.1/Objects/dictobject.c#L103-L110)å°±ä¼šè‡ªåŠ¨æ‰©å®¹äº†. ä»¥åä¹Ÿæœ‰å¯èƒ½å†æ¬¡å‘ç”Ÿå˜åŒ–. è¿™æ˜¯ä¸ºäº†é¿å…æ•£åˆ—å†²çª. é¡ºå¸¦ä¸€æ, åé¢ä¸¤æ¬¡æ‰©å®¹ä¼šæ‰©å±•ä¸º32å’Œ256. å³`8->32->256`.)
* æ›´å¤šçš„ä¿¡æ¯, ä½ å¯ä»¥å‚è€ƒè¿™ä¸ªStackOverflowçš„[å›ç­”](https://stackoverflow.com/questions/44763802/bug-in-python-dict), å®ƒè¯¦ç»†çš„è§£é‡Šä¸€ä¸ªç±»ä¼¼çš„ä¾‹å­.

---

### > Stubborn `del` operator/åšå¼ºçš„ `del` *

```py
class SomeClass:
    def __del__(self):
        print("Deleted!")
```

**Output:**
1\.
```py
>>> x = SomeClass()
>>> y = x
>>> del x # è¿™é‡Œåº”è¯¥ä¼šè¾“å‡º "Deleted!"
>>> del y
Deleted!
```

å”·, ç»ˆäºåˆ é™¤äº†. ä½ å¯èƒ½å·²ç»çŒœåˆ°äº†åœ¨æˆ‘ä»¬ç¬¬ä¸€æ¬¡å°è¯•åˆ é™¤ `x` æ—¶æ˜¯ä»€ä¹ˆè®© `__del__` å…äºè¢«è°ƒç”¨çš„. é‚£è®©æˆ‘ä»¬ç»™è¿™ä¸ªä¾‹å­å¢åŠ ç‚¹éš¾åº¦.

2\.
```py
>>> x = SomeClass()
>>> y = x
>>> del x
>>> y # æ£€æŸ¥ä¸€ä¸‹yæ˜¯å¦å­˜åœ¨
<__main__.SomeClass instance at 0x7f98a1a67fc8>
>>> del y # åƒä¹‹å‰ä¸€æ ·, è¿™é‡Œåº”è¯¥ä¼šè¾“å‡º "Deleted!"
>>> globals() # å¥½å§, å¹¶æ²¡æœ‰. è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ‰€æœ‰çš„å…¨å±€å˜é‡
Deleted!
{'__builtins__': <module '__builtin__' (built-in)>, 'SomeClass': <class __main__.SomeClass at 0x7f98a1a5f668>, '__package__': None, '__name__': '__main__', '__doc__': None}
```

å¥½äº†ï¼Œç°åœ¨å®ƒè¢«åˆ é™¤äº† :confused:

#### ğŸ’¡ è¯´æ˜:
+ `del x` å¹¶ä¸ä¼šç«‹åˆ»è°ƒç”¨ `x.__del__()`.
+ æ¯å½“é‡åˆ° `del x`, Python ä¼šå°† `x` çš„å¼•ç”¨æ•°å‡1, å½“ `x` çš„å¼•ç”¨æ•°å‡åˆ°0æ—¶å°±ä¼šè°ƒç”¨ `x.__del__()`.
+ åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­, `y.__del__()` ä¹‹æ‰€ä»¥æœªè¢«è°ƒç”¨, æ˜¯å› ä¸ºå‰ä¸€æ¡è¯­å¥ (`>>> y`) å¯¹åŒä¸€å¯¹è±¡åˆ›å»ºäº†å¦ä¸€ä¸ªå¼•ç”¨, ä»è€Œé˜²æ­¢åœ¨æ‰§è¡Œ `del y` åå¯¹è±¡çš„å¼•ç”¨æ•°å˜ä¸º0.
+ è°ƒç”¨ `globals` å¯¼è‡´å¼•ç”¨è¢«é”€æ¯, å› æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ° "Deleted!" ç»ˆäºè¢«è¾“å‡ºäº†.
+ (è¯‘: è¿™å…¶å®æ˜¯ Python äº¤äº’è§£é‡Šå™¨çš„ç‰¹æ€§, å®ƒä¼šè‡ªåŠ¨è®© `_` ä¿å­˜ä¸Šä¸€ä¸ªè¡¨è¾¾å¼è¾“å‡ºçš„å€¼, è¯¦ç»†å¯ä»¥çœ‹[è¿™é‡Œ](https://www.cnblogs.com/leisurelylicht/p/diao-pi-de-kong-zhi-tai.html).)


---

### > The out of scope variable/å¤–éƒ¨ä½œç”¨åŸŸå˜é‡
<!-- Example ID: 75c03015-7be9-4289-9e22-4f5fdda056f7 --->

1\.
```py
a = 1
def some_func():
    return a

def another_func():
    a += 1
    return a
```

2\.
```py
def some_closure_func():
    a = 1
    def some_inner_func():
        return a
    return some_inner_func()

def another_closure_func():
    a = 1
    def another_inner_func():
        a += 1
        return a
    return another_inner_func()
```

**Output:**
```py
>>> some_func()
1
>>> another_func()
UnboundLocalError: local variable 'a' referenced before assignment

>>> some_closure_func()
1
>>> another_closure_func()
UnboundLocalError: local variable 'a' referenced before assignment
```

#### ğŸ’¡ è¯´æ˜:
* å½“ä½ åœ¨ä½œç”¨åŸŸä¸­å¯¹å˜é‡è¿›è¡Œèµ‹å€¼æ—¶, å˜é‡ä¼šå˜æˆè¯¥ä½œç”¨åŸŸå†…çš„å±€éƒ¨å˜é‡. å› æ­¤ `a` ä¼šå˜æˆ `another_func` å‡½æ•°ä½œç”¨åŸŸä¸­çš„å±€éƒ¨å˜é‡, ä½†å®ƒåœ¨å‡½æ•°ä½œç”¨åŸŸä¸­å¹¶æ²¡æœ‰è¢«åˆå§‹åŒ–, æ‰€ä»¥ä¼šå¼•å‘é”™è¯¯.
* æƒ³è¦åœ¨ `another_func` ä¸­ä¿®æ”¹å¤–éƒ¨ä½œç”¨åŸŸå˜é‡ `a` çš„è¯, å¯ä»¥ä½¿ç”¨ `global` å…³é”®å­—.
  ```py
  def another_func()
      global a
      a += 1
      return a
  ```

  **Output:**
  ```py
  >>> another_func()
  2
  ```

* åœ¨ `another_closure_func` å‡½æ•°ä¸­ï¼Œ`a` ä¼šå˜æˆ `another_inner_func` å‡½æ•°ä½œç”¨åŸŸä¸­çš„å±€éƒ¨å˜é‡, ä½†å®ƒåœ¨åŒä¸€ä½œç”¨åŸŸä¸­å¹¶æ²¡æœ‰è¢«åˆå§‹åŒ–, æ‰€ä»¥ä¼šå¼•å‘é”™è¯¯ã€‚
* æƒ³è¦åœ¨ `another_inner_func` ä¸­ä¿®æ”¹å¤–éƒ¨ä½œç”¨åŸŸå˜é‡ `a` çš„è¯, å¯ä»¥ä½¿ç”¨ `nonlocal` å…³é”®å­—ã€‚nonlocal è¡¨è¾¾å¼ç”¨äºï¼ˆé™¤å…¨å±€ä½œç”¨åŸŸå¤–ï¼‰æœ€è¿‘ä¸€çº§çš„å¤–éƒ¨ä½œç”¨åŸŸã€‚

  ```py
  def another_func():
      a = 1
      def another_inner_func():
          nonlocal a
          a += 1
          return a
      return another_inner_func()
  ```

  **Output:**
  ```py
  >>> another_func()
  2
  ```

*  `global` and `nonlocal` å…³é”®å­—å‘Šè¯‰ `Python` è§£é‡Šå™¨ï¼Œä¸è¦å£°æ˜æ–°å˜é‡ï¼Œè€Œæ˜¯åœ¨ç›¸åº”çš„å¤–éƒ¨ä½œç”¨åŸŸä¸­æŸ¥æ‰¾å˜é‡ã€‚
* å¯ä»¥é˜…è¯»[è¿™ä¸ª](https://sebastianraschka.com/Articles/2014_python_scope_and_namespaces.html)ç®€çŸ­å´å¾ˆæ£’çš„æŒ‡å—, äº†è§£æ›´å¤šå…³äº Python ä¸­å‘½åç©ºé—´å’Œä½œç”¨åŸŸçš„å·¥ä½œåŸç†ã€‚


---

### > Deleting a list item while iterating/è¿­ä»£åˆ—è¡¨æ—¶åˆ é™¤å…ƒç´ 

```py
list_1 = [1, 2, 3, 4]
list_2 = [1, 2, 3, 4]
list_3 = [1, 2, 3, 4]
list_4 = [1, 2, 3, 4]

for idx, item in enumerate(list_1):
    del item

for idx, item in enumerate(list_2):
    list_2.remove(item)

for idx, item in enumerate(list_3[:]):
    list_3.remove(item)

for idx, item in enumerate(list_4):
    list_4.pop(idx)
```

**Output:**
```py
>>> list_1
[1, 2, 3, 4]
>>> list_2
[2, 4]
>>> list_3
[]
>>> list_4
[2, 4]
```

ä½ èƒ½çŒœåˆ°ä¸ºä»€ä¹ˆè¾“å‡ºæ˜¯ `[2, 4]` å—?

#### ğŸ’¡ è¯´æ˜:

* åœ¨è¿­ä»£æ—¶ä¿®æ”¹å¯¹è±¡æ˜¯ä¸€ä¸ªå¾ˆæ„šè ¢çš„ä¸»æ„. æ­£ç¡®çš„åšæ³•æ˜¯è¿­ä»£å¯¹è±¡çš„å‰¯æœ¬, `list_3[:]` å°±æ˜¯è¿™ä¹ˆåšçš„.

     ```py
     >>> some_list = [1, 2, 3, 4]
     >>> id(some_list)
     139798789457608
     >>> id(some_list[:]) # æ³¨æ„pythonä¸ºåˆ‡ç‰‡åˆ—è¡¨åˆ›å»ºäº†æ–°å¯¹è±¡.
     139798779601192
     ```

**`del`, `remove` å’Œ `pop` çš„ä¸åŒ:**
* `del var_name` åªæ˜¯ä»æœ¬åœ°æˆ–å…¨å±€å‘½åç©ºé—´ä¸­åˆ é™¤äº† `var_name` (è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ `list_1` æ²¡æœ‰å—åˆ°å½±å“).
* `remove` ä¼šåˆ é™¤ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„æŒ‡å®šå€¼, è€Œä¸æ˜¯ç‰¹å®šçš„ç´¢å¼•, å¦‚æœæ‰¾ä¸åˆ°å€¼åˆ™æŠ›å‡º `ValueError` å¼‚å¸¸.
* `pop` åˆ™ä¼šåˆ é™¤æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´ å¹¶è¿”å›å®ƒ, å¦‚æœæŒ‡å®šäº†æ— æ•ˆçš„ç´¢å¼•åˆ™æŠ›å‡º `IndexError` å¼‚å¸¸.

**ä¸ºä»€ä¹ˆè¾“å‡ºæ˜¯ `[2, 4]`?**
- åˆ—è¡¨è¿­ä»£æ˜¯æŒ‰ç´¢å¼•è¿›è¡Œçš„, æ‰€ä»¥å½“æˆ‘ä»¬ä» `list_2` æˆ– `list_4` ä¸­åˆ é™¤ `1` æ—¶, åˆ—è¡¨çš„å†…å®¹å°±å˜æˆäº† `[2, 3, 4]`. å‰©ä½™å…ƒç´ ä¼šä¾æ¬¡ä½ç§», ä¹Ÿå°±æ˜¯è¯´, `2` çš„ç´¢å¼•ä¼šå˜ä¸º 0, `3` ä¼šå˜ä¸º 1. ç”±äºä¸‹ä¸€æ¬¡è¿­ä»£å°†è·å–ç´¢å¼•ä¸º 1 çš„å…ƒç´  (å³ `3`), å› æ­¤ `2` å°†è¢«å½»åº•çš„è·³è¿‡. ç±»ä¼¼çš„æƒ…å†µä¼šäº¤æ›¿å‘ç”Ÿåœ¨åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ ä¸Š.

* å‚è€ƒè¿™ä¸ªStackOverflowçš„[å›ç­”](https://stackoverflow.com/questions/45946228/what-happens-when-you-try-to-delete-a-list-element-while-iterating-over-it)æ¥è§£é‡Šè¿™ä¸ªä¾‹å­
* å…³äºPythonä¸­å­—å…¸çš„ç±»ä¼¼ä¾‹å­, å¯ä»¥å‚è€ƒè¿™ä¸ªStackoverflowçš„[å›ç­”](https://stackoverflow.com/questions/45877614/how-to-change-all-the-dictionary-keys-in-a-for-loop-with-d-items).


---

### > Lossy zip of iterators/ä¸¢ä¸‰è½å››çš„zip *
<!-- Example ID: c28ed154-e59f-4070-8eb6-8967a4acac6d --->

```py
>>> numbers = list(range(7))
>>> numbers
[0, 1, 2, 3, 4, 5, 6]
>>> first_three, remaining = numbers[:3], numbers[3:]
>>> first_three, remaining
([0, 1, 2], [3, 4, 5, 6])
>>> numbers_iter = iter(numbers)
>>> list(zip(numbers_iter, first_three)) 
[(0, 0), (1, 1), (2, 2)]
# so far so good, let's zip the remaining
>>> list(zip(numbers_iter, remaining))
[(4, 3), (5, 4), (6, 5)]
```

`numbers` åˆ—è¡¨ä¸­çš„å…ƒç´  `3` å“ªé‡Œå»äº†ï¼Ÿ

#### ğŸ’¡ è¯´æ˜

- æ ¹æ®Python [æ–‡æ¡£](https://docs.python.org/3.3/library/functions.html#zip)ï¼Œ `zip` å‡½æ•°çš„å¤§æ¦‚å®ç°å¦‚ä¸‹ï¼š

    ```py
    def zip(*iterables):
        sentinel = object()
        iterators = [iter(it) for it in iterables]
        while iterators:
            result = []
            for it in iterators:
                elem = next(it, sentinel)
                if elem is sentinel: return
                result.append(elem)
            yield tuple(result)
    ```

- è¯¥å‡½æ•°æ¥å—ä»»æ„æ•°é‡çš„å¯è¿­ä»£å¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨ `next` å‡½æ•°å°†å®ƒä»¬çš„æ¯ä¸ªé¡¹ç›®æ·»åŠ åˆ° `result` åˆ—è¡¨ä¸­ï¼Œå¹¶åœ¨ä»»ä¸€å¯è¿­ä»£å¯¹è±¡è€—å°½æ—¶åœæ­¢ã€‚
- è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä»»ä¸€å¯è¿­ä»£å¯¹è±¡ç”¨å°½æ—¶ï¼Œ`result` åˆ—è¡¨ä¸­çš„ç°æœ‰å…ƒç´ å°†è¢«ä¸¢å¼ƒã€‚è¿™å°±æ˜¯ `numbers_iter` ä¸­çš„ `3` æ‰€å‘ç”Ÿçš„æƒ…å†µã€‚
- ä½¿ç”¨ zip æ‰§è¡Œä¸Šè¿°æ“ä½œçš„æ­£ç¡®æ–¹æ³•æ˜¯:

    ```py
    >>> numbers = list(range(7))
    >>> numbers_iter = iter(numbers)
    >>> list(zip(first_three, numbers_iter))
    [(0, 0), (1, 1), (2, 2)]
    >>> list(zip(remaining, numbers_iter))
    [(3, 3), (4, 4), (5, 5), (6, 6)]
    ```

    `zip` çš„ç¬¬ä¸€ä¸ªå‚æ•°åº”å½“æ˜¯æœ‰æœ€å°‘å…ƒç´ çš„é‚£ä¸ªã€‚


---

### > Loop variables leaking out!/å¾ªç¯å˜é‡æ³„æ¼!

1\.
```py
for x in range(7):
    if x == 6:
        print(x, ': for x inside loop')
print(x, ': x in global')
```

**Output:**
```py
6 : for x inside loop
6 : x in global
```

ä½†æ˜¯ `x` ä»æœªåœ¨å¾ªç¯å¤–è¢«å®šä¹‰...

2\.
```py
# è¿™æ¬¡æˆ‘ä»¬å…ˆåˆå§‹åŒ–x
x = -1
for x in range(7):
    if x == 6:
        print(x, ': for x inside loop')
print(x, ': x in global')
```

**Output:**
```py
6 : for x inside loop
6 : x in global
```

3\.
```
x = 1
print([x for x in range(5)])
print(x, ': x in global')
```

**Output (on Python 2.x):**
```
[0, 1, 2, 3, 4]
(4, ': x in global')
```

**Output (on Python 3.x):**
```
[0, 1, 2, 3, 4]
1 : x in global
```

#### ğŸ’¡ è¯´æ˜:

- åœ¨ Python ä¸­, for å¾ªç¯ä½¿ç”¨æ‰€åœ¨ä½œç”¨åŸŸå¹¶åœ¨ç»“æŸåä¿ç•™å®šä¹‰çš„å¾ªç¯å˜é‡. å¦‚æœæˆ‘ä»¬æ›¾åœ¨å…¨å±€å‘½åç©ºé—´ä¸­å®šä¹‰è¿‡å¾ªç¯å˜é‡. åœ¨è¿™ç§æƒ…å†µä¸‹, å®ƒä¼šé‡æ–°ç»‘å®šç°æœ‰å˜é‡.

- Python 2.x å’Œ Python 3.x è§£é‡Šå™¨åœ¨åˆ—è¡¨æ¨å¯¼å¼ç¤ºä¾‹ä¸­çš„è¾“å‡ºå·®å¼‚, åœ¨æ–‡æ¡£ [Whatâ€™s New In Python 3.0](https://docs.python.org/3/whatsnew/3.0.html) ä¸­å¯ä»¥æ‰¾åˆ°ç›¸å…³çš„è§£é‡Š:

    > "åˆ—è¡¨æ¨å¯¼ä¸å†æ”¯æŒå¥æ³•å½¢å¼ `[... for var in item1, item2, ...]`. å–è€Œä»£ä¹‹çš„æ˜¯ `[... for var in (item1, item2, ...)]`. å¦å¤–, æ³¨æ„åˆ—è¡¨æ¨å¯¼å…·æœ‰ä¸åŒçš„è¯­ä¹‰: å®ƒä»¬æ›´æ¥è¿‘äº `list()` æ„é€ å‡½æ•°ä¸­ç”Ÿæˆå™¨è¡¨è¾¾å¼çš„è¯­æ³•ç³–(è¯‘: è¿™ä¸€å¥æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ˜ç™½), ç‰¹åˆ«æ˜¯å¾ªç¯æ§åˆ¶å˜é‡ä¸å†æ³„æ¼åˆ°å‘¨å›´çš„ä½œç”¨åŸŸä¸­."

---

### > Beware of default mutable arguments!/å½“å¿ƒé»˜è®¤çš„å¯å˜å‚æ•°!

```py
def some_func(default_arg=[]):
    default_arg.append("some_string")
    return default_arg
```

**Output:**
```py
>>> some_func()
['some_string']
>>> some_func()
['some_string', 'some_string']
>>> some_func([])
['some_string']
>>> some_func()
['some_string', 'some_string', 'some_string']
```

#### ğŸ’¡ è¯´æ˜:

- Pythonä¸­å‡½æ•°çš„é»˜è®¤å¯å˜å‚æ•°å¹¶ä¸æ˜¯æ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°æ—¶éƒ½ä¼šè¢«åˆå§‹åŒ–. ç›¸å, å®ƒä»¬ä¼šä½¿ç”¨æœ€è¿‘åˆ†é…çš„å€¼ä½œä¸ºé»˜è®¤å€¼. å½“æˆ‘ä»¬æ˜ç¡®çš„å°† `[]` ä½œä¸ºå‚æ•°ä¼ é€’ç»™ `some_func` çš„æ—¶å€™, å°±ä¸ä¼šä½¿ç”¨ `default_arg` çš„é»˜è®¤å€¼, æ‰€ä»¥å‡½æ•°ä¼šè¿”å›æˆ‘ä»¬æ‰€æœŸæœ›çš„ç»“æœ.

    ```py
    def some_func(default_arg=[]):
        default_arg.append("some_string")
        return default_arg
    ```

    **Output:**
    ```py
    >>> some_func.__defaults__ # è¿™é‡Œä¼šæ˜¾ç¤ºå‡½æ•°çš„é»˜è®¤å‚æ•°çš„å€¼
    ([],)
    >>> some_func()
    >>> some_func.__defaults__
    (['some_string'],)
    >>> some_func()
    >>> some_func.__defaults__
    (['some_string', 'some_string'],)
    >>> some_func([])
    >>> some_func.__defaults__
    (['some_string', 'some_string'],)
    ```

- é¿å…å¯å˜å‚æ•°å¯¼è‡´çš„é”™è¯¯çš„å¸¸è§åšæ³•æ˜¯å°† `None` æŒ‡å®šä¸ºå‚æ•°çš„é»˜è®¤å€¼, ç„¶åæ£€æŸ¥æ˜¯å¦æœ‰å€¼ä¼ ç»™å¯¹åº”çš„å‚æ•°. ä¾‹:

    ```py
    def some_func(default_arg=None):
        if not default_arg:
            default_arg = []
        default_arg.append("some_string")
        return default_arg
    ```

---

### > Catching the Exceptions/æ•è·å¼‚å¸¸

```py
some_list = [1, 2, 3]
try:
    # è¿™é‡Œä¼šæŠ›å‡ºå¼‚å¸¸ ``IndexError``
    print(some_list[4])
except IndexError, ValueError:
    print("Caught!")

try:
    # è¿™é‡Œä¼šæŠ›å‡ºå¼‚å¸¸ ``ValueError``
    some_list.remove(4)
except IndexError, ValueError:
    print("Caught again!")
```

**Output (Python 2.x):**
```py
Caught!

ValueError: list.remove(x): x not in list
```

**Output (Python 3.x):**
```py
  File "<input>", line 3
    except IndexError, ValueError:
                     ^
SyntaxError: invalid syntax
```

#### ğŸ’¡ è¯´æ˜:

* å¦‚æœä½ æƒ³è¦åŒæ—¶æ•è·å¤šä¸ªä¸åŒç±»å‹çš„å¼‚å¸¸æ—¶, ä½ éœ€è¦å°†å®ƒä»¬ç”¨æ‹¬å·åŒ…æˆä¸€ä¸ªå…ƒç»„ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’. ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰åç§°, å¦‚æœä½ æä¾›, å®ƒå°†ä¸è¢«æ•è·çš„å¼‚å¸¸å®ä¾‹ç»‘å®š. ä¾‹,
  ```py
  some_list = [1, 2, 3]
  try:
     # è¿™é‡Œä¼šæŠ›å‡ºå¼‚å¸¸ ``ValueError``
     some_list.remove(4)
  except (IndexError, ValueError), e:
     print("Caught again!")
     print(e)
  ```
  **Output (Python 2.x):**
  ```
  Caught again!
  list.remove(x): x not in list
  ```
  **Output (Python 3.x):**
  ```py
    File "<input>", line 4
      except (IndexError, ValueError), e:
                                       ^
  IndentationError: unindent does not match any outer indentation level
  ```

* åœ¨ Python 3 ä¸­, ç”¨é€—å·åŒºåˆ†å¼‚å¸¸ä¸å¯é€‰åç§°æ˜¯æ— æ•ˆçš„; æ­£ç¡®çš„åšæ³•æ˜¯ä½¿ç”¨ `as` å…³é”®å­—. ä¾‹,
  ```py
  some_list = [1, 2, 3]
  try:
      some_list.remove(4)

  except (IndexError, ValueError) as e:
      print("Caught again!")
      print(e)
  ```
  **Output:**
  ```
  Caught again!
  list.remove(x): x not in list
  ```

---

### > Same operands, different story!/åŒäººä¸åŒå‘½!

1\.
```py
a = [1, 2, 3, 4]
b = a
a = a + [5, 6, 7, 8]
```

**Output:**
```py
>>> a
[1, 2, 3, 4, 5, 6, 7, 8]
>>> b
[1, 2, 3, 4]
```

2\.
```py
a = [1, 2, 3, 4]
b = a
a += [5, 6, 7, 8]
```

**Output:**
```py
>>> a
[1, 2, 3, 4, 5, 6, 7, 8]
>>> b
[1, 2, 3, 4, 5, 6, 7, 8]
```

#### ğŸ’¡ è¯´æ˜:

*  `a += b` å¹¶ä¸æ€»æ˜¯ä¸ `a = a + b` è¡¨ç°ç›¸åŒ. ç±»å®ç° *`op=`* è¿ç®—ç¬¦çš„æ–¹å¼ *ä¹Ÿè®¸* æ˜¯ä¸åŒçš„, åˆ—è¡¨å°±æ˜¯è¿™æ ·åšçš„.

* è¡¨è¾¾å¼ `a = a + [5,6,7,8]` ä¼šç”Ÿæˆä¸€ä¸ªæ–°åˆ—è¡¨, å¹¶è®© `a` å¼•ç”¨è¿™ä¸ªæ–°åˆ—è¡¨, åŒæ—¶ä¿æŒ `b` ä¸å˜.

* è¡¨è¾¾å¼ `a += [5,6,7,8]` å®é™…ä¸Šæ˜¯ä½¿ç”¨çš„æ˜¯ "extend" å‡½æ•°, æ‰€ä»¥ `a` å’Œ `b` ä»ç„¶æŒ‡å‘å·²è¢«ä¿®æ”¹çš„åŒä¸€åˆ—è¡¨.


---

### > Name resolution ignoring class scope/å¿½ç•¥ç±»ä½œç”¨åŸŸçš„åç§°è§£æ

1\.
```py
x = 5
class SomeClass:
    x = 17
    y = (x for i in range(10))
```

**Output:**
```py
>>> list(SomeClass.y)[0]
5
```

2\.
```py
x = 5
class SomeClass:
    x = 17
    y = [x for i in range(10)]
```

**Output (Python 2.x):**
```py
>>> SomeClass.y[0]
17
```

**Output (Python 3.x):**
```py
>>> SomeClass.y[0]
5
```

#### ğŸ’¡ è¯´æ˜:
- ç±»å®šä¹‰ä¸­åµŒå¥—çš„ä½œç”¨åŸŸä¼šå¿½ç•¥ç±»å†…çš„åç§°ç»‘å®š.
- ç”Ÿæˆå™¨è¡¨è¾¾å¼æœ‰å®ƒè‡ªå·±çš„ä½œç”¨åŸŸ.
- ä» Python 3.X å¼€å§‹, åˆ—è¡¨æ¨å¯¼å¼ä¹Ÿæœ‰è‡ªå·±çš„ä½œç”¨åŸŸ.


---

### > Rounding like a banker/åƒé“¶è¡Œå®¶ä¸€æ ·èˆå…¥ *

è®©æˆ‘ä»¬å®ç°ä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥è·å–åˆ—è¡¨çš„ä¸­é—´å…ƒç´ ï¼š

```py
def get_middle(some_list):
    mid_index = round(len(some_list) / 2)
    return some_list[mid_index - 1]
```

**Python 3.x:**
```py
>>> get_middle([1])  # looks good
1
>>> get_middle([1,2,3])  # looks good
2
>>> get_middle([1,2,3,4,5])  # huh?
2
>>> len([1,2,3,4,5]) / 2  # good
2.5
>>> round(len([1,2,3,4,5]) / 2)  # why?
2
```

ä¼¼ä¹ Python å°† 2.5 èˆå…¥åˆ° 2ã€‚

#### ğŸ’¡ è¯´æ˜

- - è¿™ä¸æ˜¯æµ®ç‚¹ç²¾åº¦é”™è¯¯ï¼Œå®é™…ä¸Šï¼Œè¿™ç§è¡Œä¸ºæ˜¯æ•…æ„çš„ã€‚ä» Python 3.0 å¼€å§‹ï¼Œ`round()` ä½¿ç”¨[é“¶è¡Œè¿›ä½æ³•](https://en.wikipedia.org/wiki/Rounding#Round_half_to_even)ï¼Œå…¶ä¸­ 0.5 å°æ•°å››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„ **å¶æ•°** ï¼š

```py
>>> round(0.5)
0
>>> round(1.5)
2
>>> round(2.5)
2
>>> import numpy  # numpyçš„ç»“æœä¹Ÿæ˜¯ä¸€æ ·
>>> numpy.round(0.5)
0.0
>>> numpy.round(1.5)
2.0
>>> numpy.round(2.5)
2.0
```

- è¿™æ˜¯ [IEEE 754](https://en.wikipedia.org/wiki/IEEE_754#Rounding_rules) ä¸­æè¿°çš„å…³äº0.5åˆ†ä½èˆå…¥çš„æ¨èæ–¹æ³•ã€‚ç„¶è€Œï¼Œå¦ä¸€ç§æ–¹æ³•ï¼ˆä»é›¶å–æ•´ï¼‰å¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯åœ¨å­¦æ ¡æ•™æˆçš„ï¼Œæ‰€ä»¥é“¶è¡Œè¿›ä½æ³•å¯èƒ½å¹¶ä¸ä¸ºäººæ‰€çŸ¥ã€‚æ­¤å¤–ï¼Œä¸€äº›æœ€æµè¡Œçš„ç¼–ç¨‹è¯­è¨€ï¼ˆä¾‹å¦‚ï¼šJavaScriptã€Javaã€C/C++ã€Rubyã€Rustï¼‰ä¹Ÿä¸ä½¿ç”¨é“¶è¡Œè¿›ä½æ³•ã€‚å› æ­¤ï¼Œè¿™å¯¹ Python æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„ï¼Œåœ¨å››èˆäº”å…¥æ—¶å¯èƒ½ä¼šå¯¼è‡´æ··æ·†ã€‚
- äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æ–‡æ¡£ [round()](https://docs.python.org/3/library/functions.html#round) æˆ– [this stackoverflow thread](https://stackoverflow.com/questions/10825926/python -3-x-rounding-behavior) 
- è¯·æ³¨æ„ï¼Œ`get_middle([1])` åªè¿”å›1ï¼Œå› ä¸ºå®ƒçš„ç´¢å¼•æ˜¯ `round(0.5) - 1 = 0 - 1 = -1`ï¼Œè¿”å›åˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚


---

### > Needles in a Haystack/å¤§æµ·æé’ˆ
<!-- Example ID: 52a199b1-989a-4b28-8910-dff562cebba9 --->

è¿„ä»Šä¸ºæ­¢ï¼Œæ¯ä¸€ä½Pythonå¼€å‘è€…éƒ½ä¼šé‡åˆ°ç±»ä¼¼ä»¥ä¸‹çš„æƒ…å†µã€‚

1\.
```py
x, y = (0, 1) if True else None, None
```

**Output:**
```
>>> x, y  # æœŸæœ›çš„ç»“æœæ˜¯ (0, 1)
((0, 1), None)
```

2\.
```py
t = ('one', 'two')
for i in t:
    print(i)

t = ('one')
for i in t:
    print(i)

t = ()
print(t)
```

**Output:**

```py
one
two
o
n
e
tuple()
```

3\.

```
ten_words_list = [
    "some",
    "very",
    "big",
    "list",
    "that"
    "consists",
    "of",
    "exactly",
    "ten",
    "words"
]
```

**Output**

```py
>>> len(ten_words_list)
9
```

4\. ä¸å¤Ÿå¥å£®çš„æ–­è¨€æœºåˆ¶

```py
a = "python"
b = "javascript"
```

**Output:**

```py
# å¸¦æœ‰å¤±è´¥è­¦å‘Šä¿¡æ¯çš„assertè¡¨è¾¾å¼
>>> assert(a == b, "Both languages are different")
# æœªå¼•å‘ AssertionError 
```

5\.

```py
some_list = [1, 2, 3]
some_dict = {
  "key_1": 1,
  "key_2": 2,
  "key_3": 3
}

some_list = some_list.append(4) 
some_dict = some_dict.update({"key_4": 4})
```

**Output:**

```py
>>> print(some_list)
None
>>> print(some_dict)
None
```

6\.

```py
def some_recursive_func(a):
    if a[0] == 0:
        return
    a[0] -= 1
    some_recursive_func(a)
    return a

def similar_recursive_func(a):
    if a == 0:
        return a
    a -= 1
    similar_recursive_func(a)
    return a
```

**Output:**

```py
>>> some_recursive_func([5, 0])
[0, 0]
>>> similar_recursive_func(5)
4
```

#### ğŸ’¡ è¯´æ˜:
* å¯¹äº 1, æ­£ç¡®çš„è¯­å¥æ˜¯ `x, y = (0, 1) if True else (None, None)`.
* å¯¹äº 2, æ­£ç¡®çš„è¯­å¥æ˜¯ `t = ('one',)` æˆ–è€… `t = 'one',` (ç¼ºå°‘é€—å·) å¦åˆ™è§£é‡Šå™¨ä¼šè®¤ä¸º `t` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸², å¹¶é€ä¸ªå­—ç¬¦å¯¹å…¶è¿›è¡Œè¿­ä»£.
* `()` æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ ‡è®°ï¼Œè¡¨ç¤ºç©ºå…ƒç»„.
* å¯¹äº 3ï¼Œæ­£å¦‚æ‚¨å¯èƒ½å·²ç»å¼„æ¸…æ¥šçš„é‚£æ ·ï¼Œåˆ—è¡¨ä¸­çš„ç¬¬5ä¸ªå…ƒç´ ï¼ˆ"that"ï¼‰åé¢ç¼ºå°‘ä¸€ä¸ªé€—å·ã€‚å› æ­¤ï¼Œé€šè¿‡éšå¼å­—ç¬¦ä¸²å­—é¢è¿æ¥ï¼Œ

  ```py
  >>> ten_words_list
  ['some', 'very', 'big', 'list', 'thatconsists', 'of', 'exactly', 'ten', 'words']
  ```

* åœ¨ç¬¬4ä¸ªä»£ç æ®µä¸­æ²¡æœ‰å¼•å‘"AssertionError"ï¼Œå› ä¸ºæˆ‘ä»¬ä¸æ˜¯æ–­è¨€å•ä¸ªè¡¨è¾¾å¼ `a == b`ï¼Œè€Œæ˜¯æ–­è¨€æ•´ä¸ªå…ƒç»„ã€‚ä»¥ä¸‹ä»£ç æ®µå°†è¯´æ˜é—®é¢˜ï¼Œ

  ```py
  >>> a = "python"
  >>> b = "javascript"
  >>> assert a == b
  Traceback (most recent call last):
      File "<stdin>", line 1, in <module>
  AssertionError
  
  >>> assert (a == b, "Values are not equal")
  <stdin>:1: SyntaxWarning: assertion is always true, perhaps remove parentheses?
  
  >>> assert a == b, "Values are not equal"
  Traceback (most recent call last):
      File "<stdin>", line 1, in <module>
  AssertionError: Values are not equal
  ```
* è‡³äºç¬¬äº”ä¸ªç‰‡æ®µï¼Œå¤§å¤šæ•°ä¿®æ”¹åºåˆ—/æ˜ å°„å¯¹è±¡é¡¹çš„æ–¹æ³•ï¼Œå¦‚`list.append`ã€`dict.update`ã€`list.sort`ç­‰ï¼Œéƒ½åœ¨åŸåœ°ä¿®æ”¹å¯¹è±¡å¹¶è¿”å›`None`ã€‚è¿™èƒŒåçš„åŸºæœ¬åŸç†æ˜¯é€šè¿‡åŸåœ°æ“ä½œï¼Œé¿å…å¤åˆ¶å¯¹è±¡æ¥æé«˜æ€§èƒ½(å‚è€ƒ[è¿™é‡Œ](https://docs.python.org/3/faq/design.html#why-doesn-t-list-sort-return-the-sorted-list))ã€‚
* æœ€åä¸€ä¸ªåº”è¯¥ç›¸å½“æ˜æ˜¾ï¼Œå¯å˜å¯¹è±¡ï¼ˆå¦‚`list`ï¼‰å¯ä»¥åœ¨å‡½æ•°ä¸­æ›´æ”¹ï¼Œä¸å¯å˜å¯¹è±¡ï¼ˆ`a -= 1`ï¼‰çš„é‡æ–°èµ‹å€¼åˆ™ä¸å±äºå€¼çš„æ”¹å˜ã€‚
* äº†è§£è¿™äº›ç»†èŠ‚å¯ä»¥åœ¨ç¨‹åºé•¿æœŸè¿è¡Œä¸­ï¼Œä¸ºæ‚¨èŠ‚çœæ•°å°æ—¶çš„è°ƒè¯•å·¥ä½œã€‚


---

### > Splitsies/åˆ†å‰²å‡½æ•° *
<!-- Example ID: ec3168ba-a81a-4482-afb0-691f1cc8d65a --->

```py
>>> 'a'.split()
['a']

# is same as
>>> 'a'.split(' ')
['a']

# but
>>> len(''.split())
0

# isn't the same as
>>> len(''.split(' '))
1
```

#### ğŸ’¡ è¯´æ˜

- èµ·åˆäººä»¬å¯èƒ½ä¼šè®¤ä¸º split çš„é»˜è®¤åˆ†éš”ç¬¦æ˜¯å•ä¸ªç©ºæ ¼ `' '`ï¼Œä½†æ ¹æ® [æ–‡æ¡£](https://docs.python.org/3/library/stdtypes.html#str.split)ï¼š
    >  å¦‚æœ sep æœªæŒ‡å®šæˆ–ä¸º `None`ï¼Œåˆ™åº”ç”¨ä¸åŒçš„æ‹†åˆ†ç®—æ³•ï¼šè¿ç»­çš„ç©ºæ ¼è¢«è§†ä¸ºå•ä¸ªåˆ†éš”ç¬¦ï¼Œå¦‚æœå­—ç¬¦ä¸²æœ‰å‰å¯¼æˆ–å°¾éšç©ºæ ¼ï¼Œåˆ™ç»“æœå°†åœ¨å¼€å¤´æˆ–ç»“å°¾ä¸åŒ…å«ç©ºå­—ç¬¦ä¸²ã€‚å› æ­¤ï¼Œä½¿ç”¨ `None` åˆ†éš”ç¬¦æ‹†åˆ†ç©ºå­—ç¬¦ä¸²æˆ–ä»…åŒ…å«ç©ºæ ¼çš„å­—ç¬¦ä¸²å°†è¿”å› `[]`ã€‚
    > å¦‚æœç»™å®š sepï¼Œè¿ç»­çš„åˆ†éš”ç¬¦ä¸ä¼šç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶è¢«è§†ä¸ºåˆ†éš”ç©ºå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ï¼Œ`'1,,2'.split(',')` è¿”å› `['1', '', '2 ']`ï¼‰ã€‚ä½¿ç”¨æŒ‡å®šçš„åˆ†éš”ç¬¦æ‹†åˆ†ç©ºå­—ç¬¦ä¸²ä¼šè¿”å› `['']`ã€‚
- Noticing how the leading and trailing whitespaces are handled in the following snippet will make things clear,
- æ³¨æ„ä»¥ä¸‹ä»£ç æ®µä¸­å¦‚ä½•å¤„ç†å‰å¯¼å’Œå°¾éšç©ºæ ¼ï¼Œä¿ƒè¿›æ›´æ·±å…¥çš„ç†è§£ï¼š

    ```py
    >>> ' a '.split(' ')
    ['', 'a', '']
    >>> ' a '.split()
    ['a']
    >>> ''.split(' ')
    ['']
    ```


---

### > Wild imports/é€šé…ç¬¦å¯¼å…¥æ–¹å¼ *
<!-- Example ID: 83deb561-bd55-4461-bb5e-77dd7f411e1c --->
<!-- read-only -->

```py
# File: module.py

def some_weird_name_func_():
    print("works!")

def _another_weird_name_func():
    print("works!")

```

**Output**

```py
>>> from module import *
>>> some_weird_name_func_()
"works!"
>>> _another_weird_name_func()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name '_another_weird_name_func' is not defined
```

#### ğŸ’¡ è¯´æ˜

- é€šå¸¸å»ºè®®ä¸è¦ä½¿ç”¨é€šé…ç¬¦å¯¼å…¥ã€‚ç¬¬ä¸€ä¸ªæ˜æ˜¾çš„åŸå› æ˜¯ï¼Œåœ¨é€šé…ç¬¦å¯¼å…¥ä¸­ï¼Œå¸¦æœ‰å‰å¯¼ä¸‹åˆ’çº¿çš„åç§°ä¸ä¼šè¢«å¯¼å…¥ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´è¿è¡Œæ—¶å‡ºé”™ã€‚
- å¦‚æœæˆ‘ä»¬ä½¿ç”¨ `from ... import a, b, c` è¯­æ³•ï¼Œä¸Šé¢çš„ `NameError` å°±ä¸ä¼šå‘ç”Ÿã€‚

    ```py
    >>> from module import some_weird_name_func_, _another_weird_name_func
    >>> _another_weird_name_func()
    works!
    ```

- å¦‚æœä½ çœŸçš„æƒ³ä½¿ç”¨é€šé…ç¬¦å¯¼å…¥ï¼Œé‚£ä¹ˆä½ å¿…é¡»åœ¨ä½ çš„æ¨¡å—ä¸­å®šä¹‰åˆ—è¡¨`__all__`ï¼Œå®ƒåŒ…å«ä¸€ç³»åˆ—å…¬å…±å¯¹è±¡ï¼Œå½“æˆ‘ä»¬è¿›è¡Œé€šé…ç¬¦å¯¼å…¥æ—¶ï¼Œåˆ—è¡¨ä¸­çš„è¿™äº›å¯¹è±¡å°†è¢«å¯¼å…¥ã€‚

    ```py
    __all__ = ['_another_weird_name_func']

    def some_weird_name_func_():
        print("works!")

    def _another_weird_name_func():
        print("works!")
    ```
    **Output**

    ```py
    >>> _another_weird_name_func()
    "works!"
    >>> some_weird_name_func_()
    Traceback (most recent call last):
      File "<stdin>", line 1, in <module>
    NameError: name 'some_weird_name_func_' is not defined
    ```


---

### > All sorted?/éƒ½æ’åºäº†å—ï¼Ÿ *

<!-- Example ID: e5ff1eaf-8823-4738-b4ce-b73f7c9d5511 -->

```py
>>> x = 7, 8, 9
>>> sorted(x) == x
False
>>> sorted(x) == sorted(x)
True

>>> y = reversed(x)
>>> sorted(y) == sorted(y)
False
```

#### ğŸ’¡ è¯´æ˜

- `sorted` æ–¹æ³•ä¸€å®šè¿”å›åˆ—è¡¨ç±»å‹, æ¯”è¾ƒåˆ—è¡¨ä¸å…ƒç»„åœ¨Pythonä¸­ä¸€å®šè¿”å› `False`. 

- ```py
  >>> [] == tuple()
  False
  >>> x = 7, 8, 9
  >>> type(x), type(sorted(x))
  (tuple, list)
  ```

- ä¸ `sorted` ä¸åŒï¼Œ`reversed` æ–¹æ³•è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæ’åºéœ€è¦å°±åœ°ä¿®æ”¹è¿­ä»£å™¨æˆ–ä½¿ç”¨é¢å¤–çš„å®¹å™¨ï¼ˆåˆ—è¡¨ï¼‰ï¼Œè€Œåå‘å¯ä»¥ç®€å•åœ°é€šè¿‡ä»æœ€åä¸€ä¸ªç´¢å¼•è¿­ä»£åˆ°ç¬¬ä¸€ä¸ªç´¢å¼•æ¥å·¥ä½œã€‚

- æ‰€ä»¥åœ¨æ¯”è¾ƒ `sorted(y) == sorted(y)` æ—¶ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ `sorted()` ä¼šæ¶ˆè€—è¿­ä»£å™¨ `y`ï¼Œä¸‹ä¸€æ¬¡è°ƒç”¨åªä¼šè¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚

  ```py
  >>> x = 7, 8, 9
  >>> y = reversed(x)
  >>> sorted(y), sorted(y)
  ([7, 8, 9], [])
  ```


---

### > Midnight time doesn't exist?/ä¸å­˜åœ¨çš„åˆå¤œ?

```py
from datetime import datetime

midnight = datetime(2018, 1, 1, 0, 0)
midnight_time = midnight.time()

noon = datetime(2018, 1, 1, 12, 0)
noon_time = noon.time()

if midnight_time:
    print("Time at midnight is", midnight_time)

if noon_time:
    print("Time at noon is", noon_time)
```

**Output:**
```sh
('Time at noon is', datetime.time(12, 0))
```

midnight_time å¹¶æ²¡æœ‰è¢«è¾“å‡º.

#### ğŸ’¡ è¯´æ˜:

åœ¨Python 3.5ä¹‹å‰, å¦‚æœ `datetime.time` å¯¹è±¡å­˜å‚¨çš„UTCçš„åˆå¤œæ—¶é—´(è¯‘: å°±æ˜¯ `00:00`), é‚£ä¹ˆå®ƒçš„å¸ƒå°”å€¼ä¼šè¢«è®¤ä¸ºæ˜¯ `False`. å½“ä½¿ç”¨ `if obj:` è¯­å¥æ¥æ£€æŸ¥ `obj` æ˜¯å¦ä¸º `null` æˆ–è€…æŸäº›â€œç©ºâ€å€¼çš„æ—¶å€™, å¾ˆå®¹æ˜“å‡ºé”™.


---

## Section: The Hidden treasures!/éšè—çš„å®è—!

æœ¬èŠ‚åŒ…å«äº†ä¸€äº›åƒæˆ‘è¿™æ ·çš„å¤§å¤šæ•°åˆå­¦è€…éƒ½ä¸çŸ¥é“çš„å…³äºPythonçš„é²œä¸ºäººçŸ¥çš„æœ‰è¶£çš„äº‹æƒ…ï¼ˆå¥½å§ï¼Œç°åœ¨ä¸æ˜¯äº†ï¼‰ã€‚

### > Okay Python, Can you make me fly?/Python, å¯å¦å¸¦æˆ‘é£? *

å¥½, å»å§.

```py
import antigravity
```

**Output:**
å˜˜.. è¿™æ˜¯ä¸ªè¶…çº§ç§˜å¯†.

#### ğŸ’¡ è¯´æ˜:
+ `antigravity` æ¨¡å—æ˜¯ Python å¼€å‘äººå‘˜å‘å¸ƒçš„å°‘æ•°å¤æ´»èŠ‚å½©è›‹ä¹‹ä¸€.
+ `import antigravity` ä¼šæ‰“å¼€ä¸€ä¸ª Python çš„[ç»å…¸ XKCD æ¼«ç”»](http://xkcd.com/353/)é¡µé¢.
+ ä¸æ­¢å¦‚æ­¤. è¿™ä¸ª**å¤æ´»èŠ‚å½©è›‹é‡Œè¿˜æœ‰ä¸€ä¸ªå¤æ´»èŠ‚å½©è›‹**. å¦‚æœä½ çœ‹ä¸€ä¸‹[ä»£ç ](https://github.com/python/cpython/blob/master/Lib/antigravity.py#L7-L17), å°±ä¼šå‘ç°è¿˜æœ‰ä¸€ä¸ªå‡½æ•°å®ç°äº† [XKCD's geohashing ç®—æ³•](https://xkcd.com/426/).

---

### > `goto`, but why?/`goto`, ä½†ä¸ºä»€ä¹ˆ? *

```py
from goto import goto, label
for i in range(9):
    for j in range(9):
        for k in range(9):
            print("I'm trapped, please rescue!")
            if k == 2:
                goto .breakout # ä»å¤šé‡å¾ªç¯ä¸­è·³å‡º
label .breakout
print("Freedom!")
```

**Output (Python 2.3):**
```py
I'm trapped, please rescue!
I'm trapped, please rescue!
Freedom!
```

#### ğŸ’¡ è¯´æ˜:
- 2004å¹´4æœˆ1æ—¥, Python [å®£å¸ƒ](https://mail.python.org/pipermail/python-announce-list/2004-April/002982.html) åŠ å…¥ä¸€ä¸ªå¯ç”¨çš„ `goto` ä½œä¸ºæ„šäººèŠ‚ç¤¼ç‰©.
- å½“å‰ç‰ˆæœ¬çš„ Python å¹¶æ²¡æœ‰è¿™ä¸ªæ¨¡å—.
- å°±ç®—å¯ä»¥ç”¨, ä¹Ÿè¯·ä¸è¦ä½¿ç”¨å®ƒ. è¿™é‡Œæ˜¯ä¸ºä»€ä¹ˆPythonä¸­æ²¡æœ‰ `goto` çš„[åŸå› ](https://docs.python.org/3/faq/design.html#why-is-there-no-goto).

---

### > Brace yourself!/åšå¥½æ€æƒ³å‡†å¤‡ *

å¦‚æœä½ ä¸å–œæ¬¢åœ¨Pythonä¸­ä½¿ç”¨ç©ºæ ¼æ¥è¡¨ç¤ºä½œç”¨åŸŸ, ä½ å¯ä»¥å¯¼å…¥ C é£æ ¼çš„ {},

```py
from __future__ import braces
```

**Output:**
```py
  File "some_file.py", line 1
    from __future__ import braces
SyntaxError: not a chance
```

æƒ³ç”¨å¤§æ‹¬å· `braces`? æ²¡é—¨! è§‰å¾—ä¸çˆ½, è¯·å»ç”¨javaã€‚é‚£ä¹ˆï¼Œå¦ä¸€ä¸ªä»¤äººæƒŠè®¶çš„äº‹æƒ…ï¼Œæ‰¾ä¸€æ‰¾åœ¨ `__future__` æ¨¡å—ä¸­ï¼Œå“ªé‡Œå¼•å‘äº† `SyntaxError` [code](https://github.com/python/cpython/blob/master/Lib/__future__.py)?

#### ğŸ’¡ è¯´æ˜:
+ é€šå¸¸ `__future__` ä¼šæä¾› Python æœªæ¥ç‰ˆæœ¬çš„åŠŸèƒ½. ç„¶è€Œï¼Œè¿™é‡Œçš„ â€œæœªæ¥â€ æ˜¯ä¸€ä¸ªè®½åˆº.
+ è¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾ç¤¾åŒºå¯¹æ­¤ç±»é—®é¢˜æ€åº¦çš„å¤æ´»èŠ‚å½©è›‹.
+ ä»£ç å®é™…ä¸Šåœ¨[`future.c` æ–‡ä»¶]ä¸­ (https://github.com/python/cpython/blob/025eb98dc0c1dc27404df6c544fc2944e0fa9f3a/Python/future.c#L49).
+ å½“ CPython ç¼–è¯‘å™¨é‡åˆ° [futureè¡¨è¾¾å¼](https://docs.python.org/3.3/reference/simple_stmts.html#future-statements) æ—¶ï¼Œå®ƒé¦–å…ˆåœ¨ `future.c` ä¸­è¿è¡Œç›¸åº”çš„ä»£ç ï¼Œç„¶åå†å¯¹å…¶è¿›è¡Œå¤„ç†ä½œä¸ºæ­£å¸¸çš„`import`è¡¨è¾¾å¼ã€‚


---

### > Let's meet Friendly Language Uncle For Life/è®©ç”Ÿæ´»æ›´å‹å¥½ *
<!-- Example ID: 6427fae6-e959-462d-85da-ce4c94ce41be --->

**Output (Python 3.x)**
```py
>>> from __future__ import barry_as_FLUFL
>>> "Ruby" != "Python" # è¿™é‡Œæ²¡ä»€ä¹ˆç–‘é—®
  File "some_file.py", line 1
    "Ruby" != "Python"
              ^
SyntaxError: invalid syntax

>>> "Ruby" <> "Python"
True
```

è¿™å°±å¯¹äº†.

#### ğŸ’¡ è¯´æ˜:
- ç›¸å…³çš„ [PEP-401](https://www.python.org/dev/peps/pep-0401/) å‘å¸ƒäº 2009å¹´4æœˆ1æ—¥ (æ‰€ä»¥ä½ ç°åœ¨çŸ¥é“è¿™æ„å‘³ç€ä»€ä¹ˆäº†å§).
- å¼•ç”¨ PEP-401
  > æ„è¯†åˆ° Python 3.0 é‡Œçš„ != è¿ç®—ç¬¦æ˜¯ä¸€ä¸ªä¼šå¼•èµ·æ‰‹æŒ‡ç–¼ç—›çš„ææ€–é”™è¯¯, FLUFL å°† <> è¿ç®—ç¬¦æ¢å¤ä¸ºå”¯ä¸€å†™æ³•.
- Uncle Barry åœ¨ PEP ä¸­è¿˜åˆ†äº«äº†å…¶ä»–ä¸œè¥¿; ä½ å¯ä»¥åœ¨[è¿™é‡Œ](https://www.python.org/dev/peps/pep-0401/)è·å¾—ä»–ä»¬.
- (è¯‘: è™½ç„¶æ–‡æ¡£ä¸­æ²¡å†™ï¼Œä½†åº”è¯¥æ˜¯åªèƒ½åœ¨äº¤äº’è§£é‡Šå™¨ä¸­ä½¿ç”¨.)
- å®ƒåœ¨äº¤äº’å¼ç¯å¢ƒä¸­æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯å½“æ‚¨é€šè¿‡ python æ–‡ä»¶è¿è¡Œæ—¶å®ƒä¼šå¼•å‘ `SyntaxError`ï¼ˆè¯·å‚é˜…æ­¤ [é—®é¢˜](https://github.com/satwikkansal/wtfpython/issues/94)ï¼‰ã€‚æ‚¨å¯ä»¥å°†è¡¨è¾¾å¼ä½œä¸º`eval` æˆ– `compile` å‚æ•°ä¸­ä½¿ç”¨ã€‚

    ```py
    from __future__ import barry_as_FLUFL
    print(eval('"Ruby" <> "Python"'))
    ```


---

### > Even Python understands that love is complicated/è¿Pythonä¹ŸçŸ¥é“çˆ±æ˜¯éš¾è¨€çš„ *

```py
import this
```

ç­‰ç­‰, **this** æ˜¯ä»€ä¹ˆ? `this` æ˜¯çˆ± :heart:

**Output:**
```
The Zen of Python, by Tim Peters

Beautiful is better than ugly.
ä¼˜ç¾èƒœäºä¸‘é™‹ï¼ˆPython ä»¥ç¼–å†™ä¼˜ç¾çš„ä»£ç ä¸ºç›®æ ‡ï¼‰
Explicit is better than implicit.
æ˜äº†èƒœäºæ™¦æ¶©ï¼ˆä¼˜ç¾çš„ä»£ç åº”å½“æ˜¯æ˜äº†çš„ï¼Œå‘½åè§„èŒƒï¼Œé£æ ¼ç›¸ä¼¼ï¼‰
Simple is better than complex.
ç®€æ´èƒœäºå¤æ‚ï¼ˆä¼˜ç¾çš„ä»£ç åº”å½“æ˜¯ç®€æ´çš„ï¼Œä¸è¦æœ‰å¤æ‚çš„å†…éƒ¨å®ç°ï¼‰
Complex is better than complicated.
å¤æ‚èƒœäºå‡Œä¹±ï¼ˆå¦‚æœå¤æ‚ä¸å¯é¿å…ï¼Œé‚£ä»£ç é—´ä¹Ÿä¸èƒ½æœ‰éš¾æ‡‚çš„å…³ç³»ï¼Œè¦ä¿æŒæ¥å£ç®€æ´ï¼‰
Flat is better than nested.
æ‰å¹³èƒœäºåµŒå¥—ï¼ˆä¼˜ç¾çš„ä»£ç åº”å½“æ˜¯æ‰å¹³çš„ï¼Œä¸èƒ½æœ‰å¤ªå¤šçš„åµŒå¥—ï¼‰
Sparse is better than dense.
é—´éš”èƒœäºç´§å‡‘ï¼ˆä¼˜ç¾çš„ä»£ç æœ‰é€‚å½“çš„é—´éš”ï¼Œä¸è¦å¥¢æœ›ä¸€è¡Œä»£ç è§£å†³é—®é¢˜ï¼‰
Readability counts.
å¯è¯»æ€§å¾ˆé‡è¦ï¼ˆä¼˜ç¾çš„ä»£ç ä¸€å®šæ˜¯å¯è¯»çš„ï¼‰
Special cases aren't special enough to break the rules.
æ²¡æœ‰ç‰¹ä¾‹ç‰¹æ®Šåˆ°éœ€è¦è¿èƒŒè¿™äº›è§„åˆ™ï¼ˆè¿™äº›è§„åˆ™è‡³é«˜æ— ä¸Šï¼‰
Although practicality beats purity.
å°½ç®¡æˆ‘ä»¬æ›´å€¾å‘äºå®ç”¨æ€§
Errors should never pass silently.
ä¸è¦å®‰é™çš„åŒ…å®¹æ‰€æœ‰é”™è¯¯
Unless explicitly silenced.
é™¤éä½ ç¡®å®šéœ€è¦è¿™æ ·åšï¼ˆç²¾å‡†åœ°æ•è·å¼‚å¸¸ï¼Œä¸å†™ except:pass é£æ ¼çš„ä»£ç ï¼‰
In the face of ambiguity, refuse the temptation to guess.
æ‹’ç»è¯±æƒ‘ä½ å»çŒœæµ‹çš„æš§æ˜§äº‹ç‰©
There should be one-- and preferably only one --obvious way to do it.
è€Œæ˜¯å°½é‡æ‰¾ä¸€ç§ï¼Œæœ€å¥½æ˜¯å”¯ä¸€ä¸€ç§æ˜æ˜¾çš„è§£å†³æ–¹æ¡ˆï¼ˆå¦‚æœä¸ç¡®å®šï¼Œå°±ç”¨ç©·ä¸¾æ³•ï¼‰
Although that way may not be obvious at first unless you're Dutch.
è™½ç„¶è¿™å¹¶ä¸å®¹æ˜“ï¼Œå› ä¸ºä½ ä¸æ˜¯ Python ä¹‹çˆ¶ï¼ˆè¿™é‡Œçš„ Dutch æ˜¯æŒ‡ Guido ï¼‰
Now is better than never.
ç°åœ¨è¡ŒåŠ¨å¥½è¿‡æ°¸è¿œä¸è¡ŒåŠ¨
Although never is often better than *right* now.
å°½ç®¡ä¸è¡ŒåŠ¨è¦å¥½è¿‡é²è½è¡ŒåŠ¨
If the implementation is hard to explain, it's a bad idea.
å¦‚æœä½ æ— æ³•å‘äººæè¿°ä½ çš„æ–¹æ¡ˆï¼Œé‚£è‚¯å®šä¸æ˜¯ä¸€ä¸ªå¥½æ–¹æ¡ˆï¼›
If the implementation is easy to explain, it may be a good idea.
å¦‚æœä½ èƒ½è½»æ¾å‘äººæè¿°ä½ çš„æ–¹æ¡ˆï¼Œé‚£ä¹Ÿè®¸ä¼šæ˜¯ä¸€ä¸ªå¥½æ–¹æ¡ˆï¼ˆæ–¹æ¡ˆæµ‹è¯„æ ‡å‡†ï¼‰
Namespaces are one honking great idea -- let's do more of those!
å‘½åç©ºé—´æ˜¯ä¸€ç§ç»å¦™çš„ç†å¿µï¼Œæˆ‘ä»¬åº”å½“å¤šåŠ åˆ©ç”¨ï¼ˆå€¡å¯¼ä¸å·å¬ï¼‰
```

è¿™æ˜¯ Python ä¹‹ç¦…!

```py
>>> love = this
>>> this is love
True
>>> love is True
False
>>> love is False
False
>>> love is not True or False
True
>>> love is not True or False; love is love  # çˆ±æ˜¯éš¾è¨€çš„
True
```

#### ğŸ’¡ è¯´æ˜:

* `this` æ¨¡å—æ˜¯å…³äº Python ä¹‹ç¦…çš„å¤æ´»èŠ‚å½©è›‹ ([PEP 20](https://www.python.org/dev/peps/pep-0020)).
* å¦‚æœä½ è®¤ä¸ºè¿™å·²ç»å¤Ÿæœ‰è¶£çš„äº†, å¯ä»¥çœ‹çœ‹ [this.py](https://hg.python.org/cpython/file/c3896275c0f6/Lib/this.py) çš„å®ç°. æœ‰è¶£çš„æ˜¯, Python ä¹‹ç¦…çš„å®ç°ä»£ç è¿åäº†ä»–è‡ªå·± (è¿™å¯èƒ½æ˜¯å”¯ä¸€ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µçš„åœ°æ–¹).
*
è‡³äº `love is not True or False; love is love`, æ„å¤–å´åˆä¸è¨€è€Œå–».

---

### > Yes, it exists!/æ˜¯çš„, å®ƒå­˜åœ¨!

**å¾ªç¯çš„ `else`.** ä¸€ä¸ªå…¸å‹çš„ä¾‹å­:

```py
  def does_exists_num(l, to_find):
      for num in l:
          if num == to_find:
              print("Exists!")
              break
      else:
          print("Does not exist")
```

**Output:**
```py
>>> some_list = [1, 2, 3, 4, 5]
>>> does_exists_num(some_list, 4)
Exists!
>>> does_exists_num(some_list, -1)
Does not exist
```

**å¼‚å¸¸çš„ `else` .** ä¾‹,

```py
try:
    pass
except:
    print("Exception occurred!!!")
else:
    print("Try block executed successfully...")
```

**Output:**
```py
Try block executed successfully...
```

#### ğŸ’¡ è¯´æ˜:
- å¾ªç¯åçš„ `else` å­å¥åªä¼šåœ¨å¾ªç¯æ²¡æœ‰è§¦å‘ `break` è¯­å¥, æ­£å¸¸ç»“æŸçš„æƒ…å†µä¸‹æ‰ä¼šæ‰§è¡Œ.
- try ä¹‹åçš„ `else` å­å¥ä¹Ÿè¢«ç§°ä¸º "å®Œæˆå­å¥", å› ä¸ºåœ¨ `try` è¯­å¥ä¸­åˆ°è¾¾ `else` å­å¥æ„å‘³ç€tryå—å®é™…ä¸Šå·²æˆåŠŸå®Œæˆ.


---

### > Ellipsis/çœç•¥ *
<!-- Example ID: 969b7100-ab3d-4a7d-ad7d-a6be16181b2b --->

```py
def some_func():
    Ellipsis
```

**Output**
```py
>>> some_func()
# æ²¡æœ‰è¾“å‡ºï¼Œä¹Ÿæ²¡æœ‰æŠ¥é”™

>>> SomeRandomString
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'SomeRandomString' is not defined

>>> Ellipsis
Ellipsis
```

#### ğŸ’¡ è¯´æ˜
- åœ¨ Python ä¸­ï¼Œ`Ellipsis` æ˜¯ä¸€ä¸ªå…¨å±€å¯ç”¨çš„å†…ç½®å¯¹è±¡ï¼Œç›¸å½“äº`...`ã€‚

    ```py
    >>> ...
    Ellipsis
    ```

- çœç•¥å·å¯ç”¨äºå¤šç§ç”¨é€”ï¼Œ
    + ä½œä¸ºå°šæœªç¼–å†™çš„ä»£ç çš„å ä½ç¬¦ï¼ˆå°±åƒ`pass`è¯­å¥ï¼‰
    + åœ¨åˆ‡ç‰‡è¯­æ³•ä¸­è¡¨ç¤ºå®Œæ•´åˆ‡ç‰‡çš„å…¶ä½™ç»´åº¦

    ```py
    >>> import numpy as np
    >>> three_dimensional_array = np.arange(8).reshape(2, 2, 2)
    array([
        [
            [0, 1],
            [2, 3]
        ],

        [
            [4, 5],
            [6, 7]
        ]
    ])
    ```

    æ‰€ä»¥æˆ‘ä»¬çš„ `three_dimensional_array` æ˜¯ä¸€ä¸ªæ•°ç»„çš„æ•°ç»„çš„æ•°ç»„ã€‚å‡è®¾æˆ‘ä»¬è¦æ‰“å°æ‰€æœ‰æœ€å†…å±‚æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆç´¢å¼• `1`ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Ellipsis ç»•è¿‡æ‰€æœ‰å‰é¢çš„ç»´åº¦

    ```py
    >>> three_dimensional_array[:,:,1]
    array([[1, 3],
       [5, 7]])
    >>> three_dimensional_array[..., 1] # ä½¿ç”¨Ellipsis.
    array([[1, 3],
       [5, 7]])
    ```

    æ³¨æ„ï¼šè¿™é€‚ç”¨äºä»»æ„æ•°é‡çš„ç»´åº¦ã€‚æ‚¨ç”šè‡³å¯ä»¥åœ¨ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªç»´åº¦ä¸­é€‰æ‹©åˆ‡ç‰‡å¹¶ä»¥è¿™ç§æ–¹å¼å¿½ç•¥ä¸­é—´çš„åˆ‡ç‰‡(`n_dimensional_array[firs_dim_slice, ..., last_dim_slice]`)

     + åœ¨ [ç±»å‹æç¤º](https://docs.python.org/3/library/typing.html)ä¸­ä»…è¡¨ç¤ºç±»å‹çš„ä¸€éƒ¨åˆ†ï¼ˆå¦‚ `(Callable[..., int]` æˆ– `Tuple[ str, ...]`))

     + æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨çœç•¥å·ä½œä¸ºé»˜è®¤å‡½æ•°å‚æ•°ï¼ˆåœ¨æ‚¨æƒ³è¦åŒºåˆ†â€œæ— å‚æ•°â€å’Œâ€œä¼ é€’Noneå€¼â€åœºæ™¯çš„æƒ…å†µä¸‹ï¼‰ã€‚


---

### > Inpinity/æ— é™ *

è‹±æ–‡æ‹¼å†™æ˜¯æœ‰æ„çš„, è¯·ä¸è¦ä¸ºæ­¤æäº¤è¡¥ä¸.
(è¯‘: è¿™é‡Œæ˜¯ä¸ºäº†çªå‡º Python ä¸­æ— é™çš„å®šä¹‰ä¸[Pi](https://en.wikipedia.org/wiki/Pi)æœ‰å…³, æ‰€ä»¥å°†ä¸¤ä¸ªå•è¯æ‹¼æ¥äº†.)

**Output (Python 3.x):**
```py
>>> infinity = float('infinity')
>>> hash(infinity)
314159
>>> hash(float('-inf'))
-314159
```

#### ğŸ’¡ è¯´æ˜:
- infinity çš„å“ˆå¸Œå€¼æ˜¯ 10âµ x Ï€.
- æœ‰æ„æ€çš„æ˜¯, `float('-inf')` çš„å“ˆå¸Œå€¼åœ¨ Python 3 ä¸­æ˜¯ "-10âµ x Ï€"  , è€Œåœ¨ Python 2 ä¸­æ˜¯ "-10âµ x e".

---

### > Let's mangle/ä¿®é¥°æ—¶é—´! *
<!-- Example ID: 37146d2d-9e67-43a9-8729-3c17934b910c --->

1\.
```py
class Yo(object):
    def __init__(self):
        self.__honey = True
        self.bro = True
```

**Output:**
```py
>>> Yo().bro
True
>>> Yo().__honey
AttributeError: 'Yo' object has no attribute '__honey'
>>> Yo()._Yo__honey
True
```

2\.
```py
class Yo(object):
    def __init__(self):
        # è¿™æ¬¡è¯•è¯•å¯¹ç§°å½¢å¼
        self.__honey__ = True
        self.bro = True
```

**Output:**
```py
>>> Yo().bro
True

>>> Yo()._Yo__honey__
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'Yo' object has no attribute '_Yo__honey__'
```

ä¸ºä»€ä¹ˆ `Yo()._Yo__honey` èƒ½è¿è¡Œ? åªæœ‰å°åº¦äººç†è§£.(è¯‘: è¿™ä¸ªæ¢—å¯èƒ½æ˜¯æŒ‡å°åº¦éŸ³ä¹äºº[Yo Yo Honey Singh](https://en.wikipedia.org/wiki/Yo_Yo_Honey_Singh))


3\.

```py
_A__variable = "Some value"

class A(object):
    def some_func(self):
        return __variable # æ²¡åœ¨ä»»ä½•åœ°æ–¹åˆå§‹åŒ–
```

**Output:**
```py
>>> A().__variable
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'A' object has no attribute '__variable'

>>> A().some_func()
'Some value'
```


#### ğŸ’¡ è¯´æ˜:

* [å‘½åä¿®é¥°](https://en.wikipedia.org/wiki/Name_mangling) ç”¨äºé¿å…ä¸åŒå‘½åç©ºé—´ä¹‹é—´åç§°å†²çª.
* åœ¨ Python ä¸­, è§£é‡Šå™¨ä¼šé€šè¿‡ç»™ç±»ä¸­ä»¥ `__` (åŒä¸‹åˆ’çº¿)å¼€å¤´ä¸”ç»“å°¾æœ€å¤šåªæœ‰ä¸€ä¸ªä¸‹åˆ’çº¿çš„ç±»æˆå‘˜åç§°åŠ ä¸Š`_NameOfTheClass` æ¥ä¿®é¥°(mangles)åç§°.
* æ‰€ä»¥, è¦è®¿é—® `__honey` å¯¹è±¡,æˆ‘ä»¬éœ€è¦åŠ ä¸Š `_Yo` ä»¥é˜²æ­¢ä¸å…¶ä»–ç±»ä¸­å®šä¹‰çš„ç›¸åŒåç§°çš„å±æ€§å‘ç”Ÿå†²çª.
* ä½†æ˜¯ä¸ºä»€ä¹ˆå®ƒåœ¨ç¬¬äºŒä¸ªç‰‡æ®µä¸­ä¸èµ·ä½œç”¨ï¼Ÿ å› ä¸ºå‘½åä¿®é¥°æ’é™¤äº†ä»¥åŒä¸‹åˆ’çº¿ç»“å°¾çš„åç§°ã€‚
* ç¬¬ä¸‰ä¸ªç‰‡æ®µä¹Ÿæ˜¯å‘½åä¿®é¥°çš„ç»“æœã€‚ `return __variable` è¯­å¥ä¸­çš„ `__variable` åç§°è¢«ä¿®æ”¹ä¸º `_A__variable`ï¼Œè¿™ä¹Ÿæ°å¥½æ˜¯æˆ‘ä»¬åœ¨å¤–éƒ¨ä½œç”¨åŸŸä¸­å£°æ˜çš„å˜é‡çš„åç§°ã€‚
* æ­¤å¤–ï¼Œå¦‚æœä¿®é¥°åçš„å˜é‡åè¶…è¿‡255ä¸ªå­—ç¬¦ï¼Œåˆ™ä¼šè¿›è¡Œæˆªæ–­ã€‚


---

## Section: Appearances are deceptive!/å¤–è¡¨æ˜¯é ä¸ä½çš„!

### > Skipping lines?/è·³è¿‡ä¸€è¡Œ?

**Output:**
```py
>>> value = 11
>>> valuĞµ = 32
>>> value
11
```

ä»€ä¹ˆé¬¼?

**æ³¨æ„:** å¦‚æœä½ æƒ³è¦é‡ç°çš„è¯æœ€ç®€å•çš„æ–¹æ³•æ˜¯ç›´æ¥å¤åˆ¶ä¸Šé¢çš„ä»£ç ç‰‡æ®µåˆ°ä½ çš„æ–‡ä»¶æˆ–å‘½ä»¤è¡Œé‡Œ.

#### ğŸ’¡ è¯´æ˜:

ä¸€äº›éè¥¿æ–¹å­—ç¬¦è™½ç„¶çœ‹èµ·æ¥å’Œè‹±è¯­å­—æ¯ç›¸åŒ, ä½†ä¼šè¢«è§£é‡Šå™¨è¯†åˆ«ä¸ºä¸åŒçš„å­—æ¯.

```py
>>> ord('Ğµ') # è¥¿é‡Œå°”è¯­çš„ 'e' (Ye)
1077
>>> ord('e') # æ‹‰ä¸è¯­çš„ 'e', ç”¨äºè‹±æ–‡å¹¶ä½¿ç”¨æ ‡å‡†é”®ç›˜è¾“å…¥
101
>>> 'Ğµ' == 'e'
False

>>> value = 42 # æ‹‰ä¸è¯­ e
>>> valuĞµ = 23 # è¥¿é‡Œå°”è¯­ 'e', Python 2.x çš„è§£é‡Šå™¨åœ¨è¿™ä¼šæŠ›å‡º `SyntaxError` å¼‚å¸¸
>>> value
42
```

å†…ç½®çš„ `ord()` å‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªå­—ç¬¦çš„ Unicode [ä»£ç ç‚¹](https://en.wikipedia.org/wiki/Code_point), è¿™é‡Œè¥¿é‡Œå°”è¯­ 'e' å’Œæ‹‰ä¸è¯­ 'e' çš„ä»£ç ç‚¹ä¸åŒè¯å®äº†ä¸Šè¿°ä¾‹å­.

---

### > Teleportation/ç©ºé—´ç§»åŠ¨ *

```py
import numpy as np

def energy_send(x):
    # åˆå§‹åŒ–ä¸€ä¸ª numpy æ•°ç»„
    np.array([float(x)])

def energy_receive():
    # è¿”å›ä¸€ä¸ªç©ºçš„ numpy æ•°ç»„
    return np.empty((), dtype=np.float).tolist()
```

**Output:**
```py
>>> energy_send(123.456)
>>> energy_receive()
123.456
```

è°æ¥ç»™æˆ‘å‘ä¸ªè¯ºè´å°”å¥–?

#### ğŸ’¡ è¯´æ˜:

* æ³¨æ„åœ¨ `energy_send` å‡½æ•°ä¸­åˆ›å»ºçš„ numpy æ•°ç»„å¹¶æ²¡æœ‰è¿”å›, å› æ­¤å†…å­˜ç©ºé—´è¢«é‡Šæ”¾å¹¶å¯ä»¥è¢«é‡æ–°åˆ†é….
* `numpy.empty()` ç›´æ¥è¿”å›ä¸‹ä¸€æ®µç©ºé—²å†…å­˜ï¼Œè€Œä¸é‡æ–°åˆå§‹åŒ–. è€Œè¿™ä¸ªå†…å­˜ç‚¹æ°å¥½å°±æ˜¯åˆšåˆšé‡Šæ”¾çš„é‚£ä¸ª(é€šå¸¸æƒ…å†µä¸‹, å¹¶ä¸ç»å¯¹).

---

### > Well, something is fishy.../å—¯ï¼Œæœ‰äº›å¯ç–‘...

```py
def square(x):
    """
    ä¸€ä¸ªé€šè¿‡åŠ æ³•è®¡ç®—å¹³æ–¹çš„ç®€å•å‡½æ•°.
    """
    sum_so_far = 0
    for counter in range(x):
        sum_so_far = sum_so_far + x
  return sum_so_far
```

**Output (Python 2.x):**

```py
>>> square(10)
10
```

éš¾é“ä¸åº”è¯¥æ˜¯100å—?

**æ³¨æ„:** å¦‚æœä½ æ— æ³•é‡ç°, å¯ä»¥å°è¯•è¿è¡Œè¿™ä¸ªæ–‡ä»¶[mixed_tabs_and_spaces.py](/mixed_tabs_and_spaces.py).

#### ğŸ’¡ è¯´æ˜:

* **ä¸è¦æ··ç”¨åˆ¶è¡¨ç¬¦(tab)å’Œç©ºæ ¼(space)!** åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­, return çš„å‰é¢æ˜¯"1ä¸ªåˆ¶è¡¨ç¬¦", è€Œå…¶ä»–éƒ¨åˆ†çš„ä»£ç å‰é¢æ˜¯ "4ä¸ªç©ºæ ¼".
* Pythonæ˜¯è¿™ä¹ˆå¤„ç†åˆ¶è¡¨ç¬¦çš„:
  > é¦–å…ˆ, åˆ¶è¡¨ç¬¦ä¼šä»å·¦åˆ°å³ä¾æ¬¡è¢«æ›¿æ¢æˆ8ä¸ªç©ºæ ¼, ç›´åˆ°è¢«æ›¿æ¢åçš„å­—ç¬¦æ€»æ•°æ˜¯å…«çš„å€æ•° <...>
* å› æ­¤, `square` å‡½æ•°æœ€åä¸€è¡Œçš„åˆ¶è¡¨ç¬¦ä¼šè¢«æ›¿æ¢æˆ8ä¸ªç©ºæ ¼, å¯¼è‡´returnè¯­å¥è¿›å…¥å¾ªç¯è¯­å¥é‡Œé¢.
* Python 3 å¾ˆå‹å¥½, åœ¨è¿™ç§æƒ…å†µä¸‹ä¼šè‡ªåŠ¨æŠ›å‡ºé”™è¯¯.

    **Output (Python 3.x):**
    ```py
    TabError: inconsistent use of tabs and spaces in indentation
    ```


---

## Section: Miscellaneous/æ‚é¡¹


### > `+=` is faster/æ›´å¿«çš„ `+=`

```py
# ç”¨ "+" è¿æ¥ä¸‰ä¸ªå­—ç¬¦ä¸²:
>>> timeit.timeit("s1 = s1 + s2 + s3", setup="s1 = ' ' * 100000; s2 = ' ' * 100000; s3 = ' ' * 100000", number=100)
0.25748300552368164
# ç”¨ "+=" è¿æ¥ä¸‰ä¸ªå­—ç¬¦ä¸²:
>>> timeit.timeit("s1 += s2 + s3", setup="s1 = ' ' * 100000; s2 = ' ' * 100000; s3 = ' ' * 100000", number=100)
0.012188911437988281
```

#### ğŸ’¡ è¯´æ˜:
+ è¿æ¥ä¸¤ä¸ªä»¥ä¸Šçš„å­—ç¬¦ä¸²æ—¶ `+=` æ¯” `+` æ›´å¿«, å› ä¸ºåœ¨è®¡ç®—è¿‡ç¨‹ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸² (ä¾‹å¦‚, `s1 += s2 + s3` ä¸­çš„ `s1`) ä¸ä¼šè¢«é”€æ¯.(è¯‘: å°±æ˜¯ `+=` æ‰§è¡Œçš„æ˜¯è¿½åŠ æ“ä½œï¼Œå°‘äº†ä¸€ä¸ªé”€æ¯æ–°å»ºçš„åŠ¨ä½œ.)

---

### > Let's make a giant string!/æ¥åšä¸ªå·¨å¤§çš„å­—ç¬¦ä¸²å§ï¼

```py
def add_string_with_plus(iters):
    s = ""
    for i in range(iters):
        s += "xyz"
    assert len(s) == 3*iters

def add_bytes_with_plus(iters):
    s = b""
    for i in range(iters):
        s += b"xyz"
    assert len(s) == 3*iters

def add_string_with_format(iters):
    fs = "{}"*iters
    s = fs.format(*(["xyz"]*iters))
    assert len(s) == 3*iters

def add_string_with_join(iters):
    l = []
    for i in range(iters):
        l.append("xyz")
    s = "".join(l)
    assert len(s) == 3*iters

def convert_list_to_string(l, iters):
    s = "".join(l)
    assert len(s) == 3*iters
```

**Output:**
```py
>>> timeit(add_string_with_plus(10000))
1000 loops, best of 3: 972 Âµs per loop
>>> timeit(add_bytes_with_plus(10000))
1000 loops, best of 3: 815 Âµs per loop
>>> timeit(add_string_with_format(10000))
1000 loops, best of 3: 508 Âµs per loop
>>> timeit(add_string_with_join(10000))
1000 loops, best of 3: 878 Âµs per loop
>>> l = ["xyz"]*10000
>>> timeit(convert_list_to_string(l, 10000))
10000 loops, best of 3: 80 Âµs per loop
```

è®©æˆ‘ä»¬å°†è¿­ä»£æ¬¡æ•°å¢åŠ 10å€.

```py
>>> timeit(add_string_with_plus(100000)) # æ‰§è¡Œæ—¶é—´çº¿æ€§å¢åŠ 
100 loops, best of 3: 9.75 ms per loop
>>> timeit(add_bytes_with_plus(100000)) # äºŒæ¬¡å¢åŠ 
1000 loops, best of 3: 974 ms per loop
>>> timeit(add_string_with_format(100000)) # çº¿æ€§å¢åŠ 
100 loops, best of 3: 5.25 ms per loop
>>> timeit(add_string_with_join(100000)) # çº¿æ€§å¢åŠ 
100 loops, best of 3: 9.85 ms per loop
>>> l = ["xyz"]*100000
>>> timeit(convert_list_to_string(l, 100000)) # çº¿æ€§å¢åŠ 
1000 loops, best of 3: 723 Âµs per loop
```

#### ğŸ’¡ è¯´æ˜:
- ä½ å¯ä»¥åœ¨è¿™è·å¾—æ›´å¤š [timeit](https://docs.python.org/3/library/timeit.html) çš„ç›¸å…³ä¿¡æ¯. å®ƒé€šå¸¸ç”¨äºè¡¡é‡ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´.
- ä¸è¦ç”¨ `+` å»ç”Ÿæˆè¿‡é•¿çš„å­—ç¬¦ä¸², åœ¨ Python ä¸­, `str` æ˜¯ä¸å¯å˜çš„, æ‰€ä»¥åœ¨æ¯æ¬¡è¿æ¥ä¸­ä½ éƒ½è¦æŠŠå·¦å³ä¸¤ä¸ªå­—ç¬¦ä¸²å¤åˆ¶åˆ°æ–°çš„å­—ç¬¦ä¸²ä¸­. å¦‚æœä½ è¿æ¥å››ä¸ªé•¿åº¦ä¸º10çš„å­—ç¬¦ä¸², ä½ éœ€è¦æ‹·è´ (10+10) + ((10+10)+10) + (((10+10)+10)+10) = 90 ä¸ªå­—ç¬¦è€Œä¸æ˜¯ 40 ä¸ªå­—ç¬¦. éšç€å­—ç¬¦ä¸²çš„æ•°é‡å’Œå¤§å°çš„å¢åŠ , æƒ…å†µä¼šå˜å¾—è¶Šå‘çš„ç³Ÿç³• (å°±åƒ`add_bytes_with_plus` å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ä¸€æ ·)
- å› æ­¤, æ›´å»ºè®®ä½¿ç”¨ `.format.` æˆ– `%` è¯­æ³• (ä½†æ˜¯, å¯¹äºçŸ­å­—ç¬¦ä¸², å®ƒä»¬æ¯” `+` ç¨æ…¢ä¸€ç‚¹).
- åˆæˆ–è€…, å¦‚æœä½ æ‰€éœ€çš„å†…å®¹å·²ç»ä»¥å¯è¿­ä»£å¯¹è±¡çš„å½¢å¼æä¾›äº†, ä½¿ç”¨ `''.join(å¯è¿­ä»£å¯¹è±¡)` è¦å¿«å¤šäº†.
- `add_string_with_plus` çš„æ‰§è¡Œæ—¶é—´æ²¡æœ‰åƒ `add_bytes_with_plus` ä¸€æ ·å‡ºç°äºŒæ¬¡å¢åŠ æ˜¯å› ä¸ºè§£é‡Šå™¨ä¼šå¦‚åŒä¸Šä¸€ä¸ªä¾‹å­æ‰€è®¨è®ºçš„ä¸€æ ·ä¼˜åŒ– `+=`. ç”¨ `s = s + "x" + "y" + "z"` æ›¿ä»£ `s += "xyz"` çš„è¯, æ‰§è¡Œæ—¶é—´å°±ä¼šäºŒæ¬¡å¢åŠ äº†.
  ```py
  def add_string_with_plus(iters):
      s = ""
      for i in range(iters):
          s = s + "x" + "y" + "z"
      assert len(s) == 3*iters

  >>> timeit(add_string_with_plus(10000))
  100 loops, best of 3: 9.87 ms per loop
  >>> timeit(add_string_with_plus(100000)) # æ‰§è¡Œæ—¶é—´äºŒæ¬¡å¢åŠ 
  1 loops, best of 3: 1.09 s per loop
  ```


---

### > Slowing down `dict` lookups/è®©å­—å…¸çš„æŸ¥æ‰¾æ…¢ä¸‹æ¥ *
<!-- Example ID: c9c26ce6-df0c-47f7-af0b-966b9386d4c3 --->

```py
some_dict = {str(i): 1 for i in range(1_000_000)}
another_dict = {str(i): 1 for i in range(1_000_000)}
```

**Output:**
```py
>>> %timeit some_dict['5']
28.6 ns Â± 0.115 ns per loop (mean Â± std. dev. of 7 runs, 10000000 loops each)
>>> some_dict[1] = 1
>>> %timeit some_dict['5']
37.2 ns Â± 0.265 ns per loop (mean Â± std. dev. of 7 runs, 10000000 loops each)

>>> %timeit another_dict['5']
28.5 ns Â± 0.142 ns per loop (mean Â± std. dev. of 7 runs, 10000000 loops each)
>>> another_dict[1]  # Trying to access a key that doesn't exist
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 1
>>> %timeit another_dict['5']
38.5 ns Â± 0.0913 ns per loop (mean Â± std. dev. of 7 runs, 10000000 loops each)
```

ä¸ºä»€ä¹ˆç›¸åŒçš„æŸ¥æ‰¾ä¼šå˜å¾—è¶Šæ¥è¶Šæ…¢ï¼Ÿ

#### ğŸ’¡ è¯´æ˜
+ CPython æœ‰ä¸€ä¸ªé€šç”¨çš„å­—å…¸æŸ¥æ‰¾å‡½æ•°ï¼Œå¯ä»¥å¤„ç†æ‰€æœ‰ç±»å‹çš„é”®ï¼ˆ`str`ã€`int`ã€ä»»ä½•å¯¹è±¡...ï¼‰ï¼Œä»¥åŠä¸€ä¸ªä¸“é—¨ç”¨äºå¤„ç†ä»…ç”± `str` é”®ç»„æˆçš„å­—å…¸çš„å¸¸è§æƒ…å†µã€‚
+ ä¸“ç”¨å‡½æ•°ï¼ˆåœ¨ CPython çš„ [æº](https://github.com/python/cpython/blob/522691c46e2ae51faaad5bbbce7d959dd61770df/Objects/dictobject.c#L841) ä¸­åä¸º `lookdict_unicode`ï¼‰çŸ¥é“æ‰€æœ‰ç°æœ‰çš„é”®ï¼ˆåŒ…æ‹¬æŸ¥æ‰¾çš„ key) æ˜¯å­—ç¬¦ä¸²ï¼Œå¹¶ä½¿ç”¨æ›´å¿«å’Œæ›´ç®€å•çš„å­—ç¬¦ä¸²æ¯”è¾ƒæ¥æ¯”è¾ƒé”®ï¼Œè€Œä¸æ˜¯è°ƒç”¨ `__eq__` æ–¹æ³•ã€‚
+ ç¬¬ä¸€æ¬¡ä½¿ç”¨é `str` é”®è®¿é—® `dict` å®ä¾‹æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œä»¥ä¾¿å°†æ¥çš„æŸ¥æ‰¾ä½¿ç”¨é€šç”¨å‡½æ•°ã€‚
+ è¿™ä¸ªè¿‡ç¨‹å¯¹äºç‰¹å®šçš„ `dict` å®ä¾‹æ˜¯ä¸å¯é€†çš„ï¼Œå¹¶ä¸”é”®ç”šè‡³ä¸å¿…å­˜åœ¨äºå­—å…¸ä¸­ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¯¹ä¸å­˜åœ¨çš„é”®è¿›è¡ŒæŸ¥æ‰¾å…·æœ‰ç›¸åŒå‰¯ä½œç”¨çš„åŸå› ã€‚


---

### > Bloating instance `dict`s/å˜è‡ƒè‚¿çš„`dict`å®ä¾‹ä»¬ *
<!-- Example ID: fe706ab4-1615-c0ba-a078-76c98cbe3f48 --->

```py
import sys

class SomeClass:
    def __init__(self):
        self.some_attr1 = 1
        self.some_attr2 = 2
        self.some_attr3 = 3
        self.some_attr4 = 4


def dict_size(o):
    return sys.getsizeof(o.__dict__)

```

**Output:** (Python 3.8, å…¶ä»– Python 3 çš„ç‰ˆæœ¬ä¹Ÿè®¸ç¨æœ‰ä¸åŒ)
```py
>>> o1 = SomeClass()
>>> o2 = SomeClass()
>>> dict_size(o1)
104
>>> dict_size(o2)
104
>>> del o1.some_attr1
>>> o3 = SomeClass()
>>> dict_size(o3)
232
>>> dict_size(o1)
232
```

è®©æˆ‘ä»¬åœ¨ä¸€ä¸ªæ–°çš„è§£é‡Šå™¨ä¸­å†è¯•ä¸€æ¬¡ï¼š

```py
>>> o1 = SomeClass()
>>> o2 = SomeClass()
>>> dict_size(o1)
104  # æ„æ–™ä¹‹ä¸­
>>> o1.some_attr5 = 5
>>> o1.some_attr6 = 6
>>> dict_size(o1)
360
>>> dict_size(o2)
272
>>> o3 = SomeClass()
>>> dict_size(o3)
232
```

æ˜¯ä»€ä¹ˆè®©é‚£äº›å­—å…¸å˜å¾—è‡ƒè‚¿ï¼Ÿ ä¸ºä»€ä¹ˆæ–°åˆ›å»ºçš„å¯¹è±¡ä¹Ÿä¼šå˜è‡ƒè‚¿ï¼Ÿ

#### ğŸ’¡ è¯´æ˜
+ CPython èƒ½å¤Ÿåœ¨å¤šä¸ªå­—å…¸ä¸­é‡ç”¨ç›¸åŒçš„â€œé”®â€å¯¹è±¡ã€‚ è¿™æ·»åŠ åœ¨ [PEP 412](https://www.python.org/dev/peps/pep-0412/) ä¸­ï¼Œç›®çš„æ˜¯å‡å°‘å†…å­˜ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å®ä¾‹å­—å…¸ä¸­ â€”â€” é”®ï¼ˆå®ä¾‹å±æ€§ï¼‰å‡ ä¹åœ¨æ‰€æœ‰å®ä¾‹éƒ½é€šç”¨ã€‚
+ è¿™ç§ä¼˜åŒ–å¯¹äºå®ä¾‹å­—å…¸æ¥è¯´æ˜¯ååˆ†è‡ªç„¶çš„ï¼Œä½†å¦‚æœæŸäº›å‡è®¾è¢«æ‰“ç ´ï¼Œå®ƒå°±ä¼šè¢«ç¦ç”¨ã€‚
+ å¯†é’¥å…±äº«å­—å…¸ä¸æ”¯æŒåˆ é™¤ï¼›å¦‚æœåˆ é™¤äº†å®ä¾‹å±æ€§ï¼Œåˆ™å­—å…¸æ˜¯â€œæœªå…±äº«çš„â€ï¼Œå¹¶ä¸”åŒä¸€ç±»çš„æ‰€æœ‰æœªæ¥å®ä¾‹éƒ½ç¦ç”¨å¯†é’¥å…±äº«ã€‚
+ å¦å¤–ï¼Œå¦‚æœå­—å…¸é”®å·²è¢«è°ƒæ•´å¤§å°ï¼ˆå› ä¸ºæ’å…¥äº†æ–°é”®ï¼‰ï¼Œå®ƒä»¬ä¿æŒå…±äº«*ä»…å½“*å®ƒä»¬è¢«ä¸€ä¸ªå®Œå…¨å•ä¸€çš„å­—å…¸ä½¿ç”¨æ—¶ï¼ˆè¿™å…è®¸åœ¨ç¬¬ä¸€ä¸ªåˆ›å»ºçš„å®ä¾‹çš„ `__init__` ä¸­æ·»åŠ è®¸å¤šå±æ€§ï¼Œè€Œä¸ä¼šå¯¼è‡´â€œå–æ¶ˆå…±äº«â€ï¼‰ã€‚å¦‚æœå‘ç”Ÿè°ƒæ•´å¤§å°æ—¶å­˜åœ¨å¤šä¸ªå®ä¾‹ï¼Œåˆ™ä¸ºåŒä¸€ç±»çš„æ‰€æœ‰æœªæ¥å®ä¾‹ç¦ç”¨å¯†é’¥å…±äº«ï¼šCPython æ— æ³•åˆ¤æ–­æ‚¨çš„å®ä¾‹æ˜¯å¦æ­£åœ¨ä½¿ç”¨ç›¸åŒçš„å±æ€§é›†ï¼Œå¹¶å†³å®šæ”¾å¼ƒå°è¯•å…±äº«å®ƒä»¬çš„é”®å€¼ã€‚
+ ä¸€ä¸ªå°æç¤ºï¼Œå¦‚æœä½ çš„ç›®æ ‡æ˜¯é™ä½ç¨‹åºçš„å†…å­˜å ç”¨ï¼šä¸è¦åˆ é™¤å®ä¾‹å±æ€§ï¼Œå¹¶ç¡®ä¿åœ¨ `__init__` ä¸­åˆå§‹åŒ–æ‰€æœ‰çš„å±æ€§ï¼


---

### > Minor Ones/å°çŸ¥è¯†ç‚¹

* `join()` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ“ä½œè€Œä¸æ˜¯åˆ—è¡¨æ“ä½œ. (ç¬¬ä¸€æ¬¡æ¥è§¦ä¼šè§‰å¾—æœ‰ç‚¹è¿åç›´è§‰)

  **ğŸ’¡ è¯´æ˜:**
  å¦‚æœ `join()` æ˜¯å­—ç¬¦ä¸²æ–¹æ³• é‚£ä¹ˆå®ƒå°±å¯ä»¥å¤„ç†ä»»ä½•å¯è¿­ä»£çš„å¯¹è±¡(åˆ—è¡¨ï¼Œå…ƒç»„ï¼Œè¿­ä»£å™¨). å¦‚æœå®ƒæ˜¯åˆ—è¡¨æ–¹æ³•, åˆ™å¿…é¡»åœ¨æ¯ç§ç±»å‹ä¸­å•ç‹¬å®ç°. å¦å¤–, åœ¨ `list` å¯¹è±¡çš„é€šç”¨APIä¸­å®ç°ä¸€ä¸ªä¸“ç”¨äºå­—ç¬¦ä¸²çš„æ–¹æ³•æ²¡æœ‰å¤ªå¤§çš„æ„ä¹‰.

* çœ‹ç€å¥‡æ€ªä½†èƒ½æ­£ç¡®è¿è¡Œçš„è¯­å¥:
  + `[] = ()` è¯­å¥åœ¨è¯­ä¹‰ä¸Šæ˜¯æ­£ç¡®çš„ (è§£åŒ…ä¸€ä¸ªç©ºçš„ `tuple` å¹¶èµ‹å€¼ç»™ `list`)
  + `'a'[0][0][0][0][0]` åœ¨è¯­ä¹‰ä¸Šä¹Ÿæ˜¯æ­£ç¡®çš„, å› ä¸º Python ä¸åƒCè¯­è¨€åŠå…¶æ´¾ç”Ÿè¯­è¨€é‚£æ ·ï¼Œå…·æœ‰å­—ç¬¦æ•°æ®ç±»å‹ã€‚å› æ­¤ï¼Œä»å­—ç¬¦ä¸²ä¸­é€‰æ‹©å•ä¸ªå­—ç¬¦å°†è¿”å›å•ä¸ªå­—ç¬¦ä¸²ã€‚
  + `3 --0-- 5 == 8` å’Œ `--5 == 5` åœ¨è¯­ä¹‰ä¸Šéƒ½æ˜¯æ­£ç¡®çš„, ä¸”ç»“æœç­‰äº `True`.(è¯‘: 3å‡è´Ÿ0ç­‰äº3ï¼Œå†å‡è´Ÿ5ç›¸å½“äºåŠ 5ç­‰äº8ï¼›è´Ÿçš„è´Ÿ5ç­‰äº5.)

* é‰´äº `a` æ˜¯ä¸€ä¸ªæ•°å­—, `++a` å’Œ `--a` éƒ½æ˜¯æœ‰æ•ˆçš„ Python è¯­å¥, ä½†å…¶æ•ˆæœä¸ C, C++ æˆ– Java ç­‰ä¸ä¸€æ ·.
  ```py
  >>> a = 5
  >>> a
  5
  >>> ++a
  5
  >>> --a
  5
  ```

  **ğŸ’¡ è¯´æ˜:**
  + python é‡Œæ²¡æœ‰ `++` æ“ä½œç¬¦. è¿™å…¶å®æ˜¯ä¸¤ä¸ª `+` æ“ä½œç¬¦.
  + `++a` è¢«è§£æä¸º `+(+a)` æœ€åç­‰äº `a`. `--a` åŒç†.
  + è¿™ä¸ª StackOverflow [å›ç­”](https://stackoverflow.com/questions/3654830/why-are-there-no-and-operators-in-python) è®¨è®ºäº†ä¸ºä»€ä¹ˆ Python ä¸­ç¼ºå°‘å¢é‡å’Œå‡é‡è¿ç®—ç¬¦.

* Python ä½¿ç”¨ 2ä¸ªå­—èŠ‚å­˜å‚¨å‡½æ•°ä¸­çš„æœ¬åœ°å˜é‡. ç†è®ºä¸Š, è¿™æ„å‘³ç€å‡½æ•°ä¸­åªèƒ½å®šä¹‰65536ä¸ªå˜é‡. ä½†æ˜¯ï¼ŒPython å†…ç½®äº†ä¸€ä¸ªæ–¹ä¾¿çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ç”¨äºå­˜å‚¨è¶…è¿‡2^16ä¸ªå˜é‡å. ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å½“å®šä¹‰äº†è¶…è¿‡65536ä¸ªå±€éƒ¨å˜é‡æ—¶å †æ ˆä¸­å‘ç”Ÿçš„æƒ…å†µ (è­¦å‘Š: è¿™æ®µä»£ç ä¼šæ‰“å°å¤§çº¦2^18è¡Œæ–‡æœ¬, è¯·åšå¥½å‡†å¤‡!):
     ```py
     import dis
     exec("""
     def f():
         """ + """
         """.join(["X"+str(x)+"=" + str(x) for x in range(65539)]))

     f()

     print(dis.dis(f))
     ```

* ä½ çš„ *Python ä»£ç * å¹¶ä¸ä¼šå¤šçº¿ç¨‹åŒæ—¶è¿è¡Œ (æ˜¯çš„, ä½ æ²¡å¬é”™!). è™½ç„¶ä½ è§‰å¾—ä¼šäº§ç”Ÿå¤šä¸ªçº¿ç¨‹å¹¶è®©å®ƒä»¬åŒæ—¶æ‰§è¡Œä½ çš„ä»£ç , ä½†æ˜¯, ç”±äº [å…¨å±€è§£é‡Šé”](https://wiki.python.org/moin/GlobalInterpreterLock)çš„å­˜åœ¨, ä½ æ‰€åšçš„åªæ˜¯è®©ä½ çš„çº¿ç¨‹ä¾æ¬¡åœ¨åŒä¸€ä¸ªæ ¸å¿ƒä¸Šæ‰§è¡Œ. Python å¤šçº¿ç¨‹é€‚ç”¨äºIOå¯†é›†å‹çš„ä»»åŠ¡, ä½†å¦‚æœæƒ³è¦å¹¶è¡Œå¤„ç†CPUå¯†é›†å‹çš„ä»»åŠ¡, ä½ åº”è¯¥ä¼šæƒ³ä½¿ç”¨ [multiprocessing](https://docs.python.org/2/library/multiprocessing.html) æ¨¡å—.

* åˆ—è¡¨åˆ‡ç‰‡è¶…å‡ºç´¢å¼•è¾¹ç•Œè€Œä¸å¼•å‘ä»»ä½•é”™è¯¯
  ```py
  >>> some_list = [1, 2, 3, 4, 5]
  >>> some_list[111:]
  []
  ```

* `int('Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©')` åœ¨ Python 3 ä¸­ä¼šè¿”å› `123456789`. åœ¨ Python ä¸­, åè¿›åˆ¶å­—ç¬¦åŒ…æ‹¬æ•°å­—å­—ç¬¦, ä»¥åŠå¯ç”¨äºå½¢æˆåè¿›åˆ¶æ•°å­—çš„æ‰€æœ‰å­—ç¬¦, ä¾‹å¦‚: U+0660, ARABIC-INDIC DIGIT ZERO. è¿™æœ‰ä¸€ä¸ªå…³äºæ­¤çš„ [æœ‰è¶£æ•…äº‹](http://chris.improbable.org/2014/8/25/adventures-in-unicode-digits/).

* `'abc'.count('') == 4`. è¿™æœ‰ä¸€ä¸ª `count` æ–¹æ³•çš„ç›¸è¿‘å®ç°, èƒ½æ›´å¥½çš„è¯´æ˜é—®é¢˜
  ```py
  def count(s, sub):
      result = 0
      for i in range(len(s) + 1 - len(sub)):
          result += (s[i:i + len(sub)] == sub)
      return result
  ```
  è¿™ä¸ªè¡Œä¸ºæ˜¯ç”±äºç©ºå­ä¸²(`''`)ä¸åŸå§‹å­—ç¬¦ä¸²ä¸­é•¿åº¦ä¸º0çš„åˆ‡ç‰‡ç›¸åŒ¹é…å¯¼è‡´çš„.

---

# Contributing/è´¡çŒ®

æ¬¢è¿å„ç§è¡¥ä¸! è¯¦æƒ…è¯·çœ‹[CONTRIBUTING.md](https://github.com/satwikkansal/wtfpython/blob/master/CONTRIBUTING.md).(è¯‘: è¿™æ˜¯ç»™åŸåº“æè´¡çŒ®çš„è¦æ±‚æ¨¡ç‰ˆ)

ä½ å¯ä»¥é€šè¿‡æ–°å»º [issue](https://github.com/satwikkansal/wtfpython/issues/new) æˆ–è€…åœ¨ä¸Š [Gitter](https://gitter.im/wtfpython/Lobby) ä¸æˆ‘ä»¬è¿›è¡Œè®¨è®º.

(è¯‘: å¦‚æœä½ æƒ³å¯¹è¿™ä¸ªç¿»è¯‘é¡¹ç›®æä¾›å¸®åŠ©, è¯·çœ‹[è¿™é‡Œ](https://github.com/leisurelicht/wtfpython-cn/blob/master/CONTRIBUTING.md))

# Acknowledgements/è‡´è°¢

è¿™ä¸ªç³»åˆ—æœ€åˆçš„æƒ³æ³•å’Œè®¾è®¡çµæ„Ÿæ¥è‡ªäº Denys Dovhan çš„é¡¹ç›® [wtfjs](https://github.com/denysdovhan/wtfjs). ç¤¾åŒºçš„å¼ºå¤§æ”¯æŒè®©å®ƒæˆé•¿ä¸ºç°åœ¨çš„æ¨¡æ ·.

#### Some nice Links!/ä¸€äº›ä¸é”™çš„èµ„æº
* https://www.youtube.com/watch?v=sH4XF6pKKmk
* https://www.reddit.com/r/Python/comments/3cu6ej/what_are_some_wtf_things_about_python
* https://sopython.com/wiki/Common_Gotchas_In_Python
* https://stackoverflow.com/questions/530530/python-2-x-gotchas-and-landmines
* https://stackoverflow.com/questions/1011431/common-pitfalls-in-python
* https://www.python.org/doc/humor/
* https://www.codementor.io/satwikkansal/python-practices-for-efficient-code-performance-memory-and-usability-aze6oiq65

# ğŸ“ License/è®¸å¯

[![CC 4.0][license-image]][license-url]

&copy; [Satwik Kansal](https://satwikkansal.xyz)

[license-url]: http://www.wtfpl.net
[license-image]: https://img.shields.io/badge/License-WTFPL%202.0-lightgrey.svg?style=flat-square

## Help/å¸®åŠ©

å¦‚æœæ‚¨æœ‰ä»»ä½•æƒ³æ³•æˆ–å»ºè®®ï¼Œæ¬¢è¿åˆ†äº«.

## Surprise your geeky pythonist friends?/æƒ³ç»™ä½ çš„æå®¢æœ‹å‹ä¸€ä¸ªæƒŠå–œ?

æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›å¿«é“¾å‘ Twitter å’Œ Linkedin ä¸Šçš„æœ‹å‹æ¨è wtfpython,

[Twitter](https://twitter.com/intent/tweet?url=https://github.com/satwikkansal/wtfpython&hastags=python,wtfpython)
 | [Linkedin](https://www.linkedin.com/shareArticle?url=https://github.com/satwikkansal&title=What%20the%20f*ck%20Python!&summary=An%20interesting%20collection%20of%20subtle%20and%20tricky%20Python%20snippets.)

## Need a pdf version?/éœ€è¦æ¥ä¸€ä»½pdfç‰ˆçš„?

ä½ å¯ä»¥å¿«é€Ÿåœ¨[è¿™](https://form.jotform.com/221593245656057)è·å¾—è‹±æ–‡ä½œè€…åˆ¶ä½œçš„ç‰ˆæœ¬.

## Follow Commit/è¿½è¸ªCommit

è¿™æ˜¯ä¸­æ–‡ç‰ˆ fork æ—¶æ‰€å¤„çš„åŸåº“ Commit, å½“åŸåº“æ›´æ–°æ—¶æˆ‘ä¼šè·Ÿéšæ›´æ–°.

[![Commit id][commit-image]][commit-url]

[commit-url]: https://github.com/satwikkansal/wtfpython/commit/19d4b075152d93e5bc75c5d08279338a895cfa27
[commit-image]: https://img.shields.io/badge/Commit-19d4b0-yellow.svg

